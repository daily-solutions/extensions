import e,{EventEmitter as t}from"events";var r=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i};var n=function(e,t){if(null==e)return{};var n,i,a=r(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a};function i(e,t,r,n,i,a,o){try{var s=e[a](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,i)}var a=function(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,c,"next",e)}function c(e){i(o,n,a,s,c,"throw",e)}s(void 0)})}};var o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};var s=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e},l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function d(e,t){return e(t={exports:{}},t.exports),t.exports}var p=d(function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(r,n)}e.exports=t});var h=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)},f=d(function(e){function t(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=t=function(e){return typeof e}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(r)}e.exports=t});var v=function(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?s(e):t},m=d(function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t(r)}e.exports=t});var g=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e};var y=function(e){if(Array.isArray(e))return e};var b=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}};var w=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n};var _=function(e,t){if(e){if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}};var k=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var M=function(e,t){return y(e)||b(e,t)||_(e,t)||k()},S="function"==typeof Map,C="function"==typeof Set,T="function"==typeof WeakSet,j=Object.keys,O=function(e,t){return e&&"object"==typeof e&&t.add(e)},P=function(e,t,r,n){for(var i,a=0;a<e.length;a++)if(r((i=e[a])[0],t[0],n)&&r(i[1],t[1],n))return!0;return!1},A=function(e,t,r,n){for(var i=0;i<e.length;i++)if(r(e[i],t,n))return!0;return!1},E=function(e,t){return e===t||e!=e&&t!=t},F=function(e){return e.constructor===Object},I=function(e){return"function"==typeof e.then},L=function(e){return!(!e.$$typeof||!e._store)},B=function(e){return function(t){var r=e||t;return function(e,t,n){void 0===n&&(n=T?new WeakSet:Object.create({_values:[],add:function(e){this._values.push(e)},has:function(e){return!!~this._values.indexOf(e)}}));var i=n.has(e),a=n.has(t);return i||a?i&&a:(O(e,n),O(t,n),r(e,t,n))}}},D=function(e){var t=[];return e.forEach(function(e,r){return t.push([r,e])}),t},x=function(e){var t=[];return e.forEach(function(e){return t.push(e)}),t},N=function(e,t,r,n){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!r(e[i],t[i],n))return!1;return!0},R=function(e,t,r,n){if(e.size!==t.size)return!1;for(var i=D(e),a=D(t),o=0;o<i.length;o++)if(!P(a,i[o],r,n)||!P(i,a[o],r,n))return!1;return!0},V=function(e,t,r,n){var i,a=j(e),o=j(t);if(a.length!==o.length)return!1;for(var s=0;s<a.length;s++){if(i=a[s],!A(o,i,E))return!1;if(("_owner"!==i||!L(e)||!L(t))&&!r(e[i],t[i],n))return!1}return!0},U=function(e,t){return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.unicode===t.unicode&&e.sticky===t.sticky&&e.lastIndex===t.lastIndex},J=function(e,t,r,n){if(e.size!==t.size)return!1;for(var i=x(e),a=x(t),o=0;o<i.length;o++)if(!A(a,i[o],r,n)||!A(i,a[o],r,n))return!1;return!0},z=Array.isArray,q=function(e){var t="function"==typeof e?e(r):r;function r(e,r,n){if(E(e,r))return!0;var i=typeof e;if(i!==typeof r||"object"!==i||!e||!r)return!1;if(F(e)&&F(r))return V(e,r,t,n);var a=z(e),o=z(r);if(a||o)return a===o&&N(e,r,t,n);var s=e instanceof Date,c=r instanceof Date;if(s||c)return s===c&&E(e.getTime(),r.getTime());var u=e instanceof RegExp,l=r instanceof RegExp;if(u||l)return u===l&&U(e,r);if(I(e)||I(r))return e===r;if(S){var d=e instanceof Map,p=r instanceof Map;if(d||p)return d===p&&R(e,r,t,n)}if(C){var h=e instanceof Set,f=r instanceof Set;if(h||f)return h===f&&J(e,r,t,n)}return V(e,r,t,n)}return r},W=(q(B()),q(B(E)),q());q(function(){return E});const G={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},H={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},K={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Q={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},$={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class Y{static getFirstMatch(e,t){const r=t.match(e);return r&&r.length>0&&r[1]||""}static getSecondMatch(e,t){const r=t.match(e);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(e,t,r){if(e.test(t))return r}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const t=e.split(".").splice(0,2).map(e=>parseInt(e,10)||0);if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const t=e.split(".").splice(0,2).map(e=>parseInt(e,10)||0);if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,t,r=!1){const n=Y.getVersionPrecision(e),i=Y.getVersionPrecision(t);let a=Math.max(n,i),o=0;const s=Y.map([e,t],e=>{const t=a-Y.getVersionPrecision(e),r=e+new Array(t+1).join(".0");return Y.map(r.split("."),e=>new Array(20-e.length).join("0")+e).reverse()});for(r&&(o=a-Math.min(n,i)),a-=1;a>=o;){if(s[0][a]>s[1][a])return 1;if(s[0][a]===s[1][a]){if(a===o)return 0;a-=1}else if(s[0][a]<s[1][a])return-1}}static map(e,t){const r=[];let n;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r}static find(e,t){let r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){const n=e[r];if(t(n,r))return n}}static assign(e,...t){const r=e;let n,i;if(Object.assign)return Object.assign(e,...t);for(n=0,i=t.length;n<i;n+=1){const e=t[n];if("object"==typeof e&&null!==e){Object.keys(e).forEach(t=>{r[t]=e[t]})}}return e}static getBrowserAlias(e){return G[e]}static getBrowserTypeByAlias(e){return H[e]||""}}const Z=/version\/(\d+(\.?_?\d+)+)/i,X=[{test:[/googlebot/i],describe(e){const t={name:"Googlebot"},r=Y.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/opera/i],describe(e){const t={name:"Opera"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe(e){const t={name:"Opera"},r=Y.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe(e){const t={name:"Samsung Internet for Android"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe(e){const t={name:"NAVER Whale Browser"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe(e){const t={name:"MZ Browser"},r=Y.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/focus/i],describe(e){const t={name:"Focus"},r=Y.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/swing/i],describe(e){const t={name:"Swing"},r=Y.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/coast/i],describe(e){const t={name:"Opera Coast"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe(e){const t={name:"Yandex Browser"},r=Y.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe(e){const t={name:"UC Browser"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe(e){const t={name:"Maxthon"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe(e){const t={name:"Epiphany"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe(e){const t={name:"Puffin"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe(e){const t={name:"Sleipnir"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe(e){const t={name:"K-Meleon"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe(e){const t={name:"WeChat"},r=Y.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe(e){const t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=Y.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe(e){const t={name:"Internet Explorer"},r=Y.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe(e){const t={name:"Microsoft Edge"},r=Y.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe(e){const t={name:"Microsoft Edge"},r=Y.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe(e){const t={name:"Vivaldi"},r=Y.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe(e){const t={name:"SeaMonkey"},r=Y.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe(e){const t={name:"Sailfish"},r=Y.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe(e){const t={name:"Amazon Silk"},r=Y.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe(e){const t={name:"PhantomJS"},r=Y.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe(e){const t={name:"SlimerJS"},r=Y.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t={name:"BlackBerry"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe(e){const t={name:"WebOS Browser"},r=Y.getFirstMatch(Z,e)||Y.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe(e){const t={name:"Bada"},r=Y.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe(e){const t={name:"Tizen"},r=Y.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe(e){const t={name:"QupZilla"},r=Y.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe(e){const t={name:"Firefox"},r=Y.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe(e){const t={name:"Electron"},r=Y.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe(e){const t={name:"Chromium"},r=Y.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe(e){const t={name:"Chrome"},r=Y.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe(e){const t={name:"Google Search"},r=Y.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test(e){const t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe(e){const t={name:"Android Browser"},r=Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe(e){const t={name:"PlayStation 4"},r=Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe(e){const t={name:"Safari"},r=Y.getFirstMatch(Z,e);return r&&(t.version=r),t}},{test:[/.*/i],describe(e){const t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:Y.getFirstMatch(t,e),version:Y.getSecondMatch(t,e)}}}];var ee=[{test:[/Roku\/DVP/],describe(e){const t=Y.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:Q.Roku,version:t}}},{test:[/windows phone/i],describe(e){const t=Y.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:Q.WindowsPhone,version:t}}},{test:[/windows /i],describe(e){const t=Y.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=Y.getWindowsVersionName(t);return{name:Q.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe(e){const t=Y.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return{name:Q.iOS,version:t}}},{test:[/macintosh/i],describe(e){const t=Y.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=Y.getMacOSVersionName(t),n={name:Q.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe(e){const t=Y.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:Q.iOS,version:t}}},{test(e){const t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe(e){const t=Y.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=Y.getAndroidVersionName(t),n={name:Q.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe(e){const t=Y.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:Q.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t=Y.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||Y.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||Y.getFirstMatch(/\bbb(\d+)/i,e);return{name:Q.BlackBerry,version:t}}},{test:[/bada/i],describe(e){const t=Y.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:Q.Bada,version:t}}},{test:[/tizen/i],describe(e){const t=Y.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:Q.Tizen,version:t}}},{test:[/linux/i],describe:()=>({name:Q.Linux})},{test:[/CrOS/],describe:()=>({name:Q.ChromeOS})},{test:[/PlayStation 4/],describe(e){const t=Y.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:Q.PlayStation4,version:t}}}],te=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(e){const t=Y.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:K.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:K.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:K.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:()=>({type:K.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:K.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:K.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:K.tablet})},{test(e){const t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe(e){const t=Y.getFirstMatch(/(ipod|iphone)/i,e);return{type:K.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:K.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:K.mobile})},{test:e=>"blackberry"===e.getBrowserName(!0),describe:()=>({type:K.mobile,vendor:"BlackBerry"})},{test:e=>"bada"===e.getBrowserName(!0),describe:()=>({type:K.mobile})},{test:e=>"windows phone"===e.getBrowserName(),describe:()=>({type:K.mobile,vendor:"Microsoft"})},{test(e){const t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:()=>({type:K.tablet})},{test:e=>"android"===e.getOSName(!0),describe:()=>({type:K.mobile})},{test:e=>"macos"===e.getOSName(!0),describe:()=>({type:K.desktop,vendor:"Apple"})},{test:e=>"windows"===e.getOSName(!0),describe:()=>({type:K.desktop})},{test:e=>"linux"===e.getOSName(!0),describe:()=>({type:K.desktop})},{test:e=>"playstation 4"===e.getOSName(!0),describe:()=>({type:K.tv})},{test:e=>"roku"===e.getOSName(!0),describe:()=>({type:K.tv})}],re=[{test:e=>"microsoft edge"===e.getBrowserName(!0),describe(e){if(/\sedg\//i.test(e))return{name:$.Blink};const t=Y.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:$.EdgeHTML,version:t}}},{test:[/trident/i],describe(e){const t={name:$.Trident},r=Y.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:e=>e.test(/presto/i),describe(e){const t={name:$.Presto},r=Y.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test(e){const t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe(e){const t={name:$.Gecko},r=Y.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:$.Blink})},{test:[/(apple)?webkit/i],describe(e){const t={name:$.WebKit},r=Y.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];class ne{constructor(e,t=!1){if(null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=Y.find(X,e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some(e=>this.test(e));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=Y.find(ee,e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some(e=>this.test(e));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:t}=this.getOS();return e?String(t).toLowerCase()||"":t||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:t}=this.getPlatform();return e?String(t).toLowerCase()||"":t||""}parsePlatform(){this.parsedResult.platform={};const e=Y.find(te,e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some(e=>this.test(e));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=Y.find(re,e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some(e=>this.test(e));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return Y.assign({},this.parsedResult)}satisfies(e){const t={};let r=0;const n={};let i=0;if(Object.keys(e).forEach(a=>{const o=e[a];"string"==typeof o?(n[a]=o,i+=1):"object"==typeof o&&(t[a]=o,r+=1)}),r>0){const e=Object.keys(t),r=Y.find(e,e=>this.isOS(e));if(r){const e=this.satisfies(t[r]);if(void 0!==e)return e}const n=Y.find(e,e=>this.isPlatform(e));if(n){const e=this.satisfies(t[n]);if(void 0!==e)return e}}if(i>0){const e=Object.keys(n),t=Y.find(e,e=>this.isBrowser(e,!0));if(void 0!==t)return this.compareVersion(n[t])}}isBrowser(e,t=!1){const r=this.getBrowserName().toLowerCase();let n=e.toLowerCase();const i=Y.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r}compareVersion(e){let t=[0],r=e,n=!1;const i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(Y.compareVersions(i,r,n))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e){return this.isBrowser(e)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(e=>this.is(e))}}var ie="new",ae="loading",oe="joining-meeting",se="joined-meeting",ce="left-meeting",ue="error",le="blocked",de="off",pe="sendable",he="loading",fe="interrupted",ve="playable",me="unknown",ge="full",ye="lobby",be="none",we="base",_e="*",ke="ejected",Me="nbf-room",Se="nbf-token",Ce="exp-room",Te="exp-token",je="cam-in-use",Oe="mic-in-use",Pe="cam-mic-in-use",Ae="iframe-ready-for-launch-config",Ee="iframe-launch-config",Fe="theme-updated",Ie="loading",Le="load-attempt-failed",Be="loaded",De="started-camera",xe="camera-error",Ne="joining-meeting",Re="joined-meeting",Ve="left-meeting",Ue="available-devices-updated",Je="participant-joined",ze="participant-updated",qe="participant-left",We="participant-counts-updated",Ge="access-state-updated",He="meeting-session-updated",Ke="waiting-participant-added",Qe="waiting-participant-updated",$e="waiting-participant-removed",Ye="track-started",Ze="track-stopped",Xe="transcription-started",et="transcription-stopped",tt="transcription-error",rt="recording-started",nt="recording-stopped",it="recording-stats",at="recording-error",ot="recording-upload-completed",st="recording-data",ct="app-message",ut="input-event",lt="remote-media-player-started",dt="remote-media-player-updated",pt="remote-media-player-stopped",ht="local-screen-share-started",ft="local-screen-share-stopped",vt="active-speaker-change",mt="active-speaker-mode-change",gt="network-quality-change",yt="network-connection",bt="fullscreen",wt="exited-fullscreen",_t="live-streaming-started",kt="live-streaming-stopped",Mt="live-streaming-error",St="lang-updated",Ct="receive-settings-updated",Tt="input-settings-updated",jt="nonfatal-error",Ot="error",Pt=4096,At="daily-custom-track",Et={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image"},Ft={PLAY:"play",PAUSE:"pause"},It="playing",Lt="paused",Bt=10,Dt=["jpg","png","jpeg"],xt="add-endpoints",Nt="remove-endpoints";function Rt(){return!Vt()&&"undefined"!=typeof window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function Vt(){return"undefined"!=typeof navigator&&navigator.product&&"ReactNative"===navigator.product}function Ut(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function Jt(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&function(e,t){if(!e||!t)return!0;switch(e){case"Chrome":return t.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&!(13===t.major&&0===t.minor&&0===t.point);case"Firefox":return t.major>=67}return!0}(Ht(),function(){switch(Ht()){case"Chrome":return Kt();case"Safari":return $t();case"Firefox":return Yt();case"Edge":return function(){var e=0,t=0;if("undefined"!=typeof window){var r=Rt(),n=r.match(/Edge\/(\d+).(\d+)/);if(n)try{e=parseInt(n[1]),t=parseInt(n[2])}catch(e){}}return{major:e,minor:t}}()}}())}function zt(){if(Vt())return!1;if(!document)return!1;var e=document.createElement("iframe");return!!e.requestFullscreen||!!e.webkitRequestFullscreen}var qt=["Chrome","Firefox"];function Wt(){return!Vt()&&(!function(){var e=Rt();if(e.match(/Mobi/)||e.match(/Android/))return!0;if(Rt().match(/DailyAnd\//))return!0}()&&qt.includes(Ht()))}function Gt(){return Ut()&&!function(){var e,t=Ht();if(!Rt())return!0;switch(t){case"Chrome":return(e=Kt()).major&&e.major>0&&e.major<61;case"Firefox":return(e=Yt()).major<78;case"Safari":return(e=$t()).major<12;default:return!0}}()}function Ht(){if("undefined"!=typeof window){var e=Rt();return Qt()?"Safari":e.indexOf("Edge")>-1?"Edge":e.match(/Chrome\//)?"Chrome":e.indexOf("Safari")>-1?"Safari":e.indexOf("Firefox")>-1?"Firefox":e.indexOf("MSIE")>-1||e.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function Kt(){var e=0,t=0,r=0,n=0,i=!1;if("undefined"!=typeof window){var a=Rt(),o=a.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(o)try{e=parseInt(o[1]),t=parseInt(o[2]),r=parseInt(o[3]),n=parseInt(o[4]),i=a.indexOf("OPR/")>-1}catch(e){}}return{major:e,minor:t,build:r,patch:n,opera:i}}function Qt(){return!!Rt().match(/iPad|iPhone|iPod/i)&&Ut()}function $t(){var e=0,t=0,r=0;if("undefined"!=typeof window){var n=Rt().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(n)try{e=parseInt(n[1]),t=parseInt(n[2]),r=parseInt(n[4])}catch(e){}else Qt()&&(e=14,t=0,r=3)}return{major:e,minor:t,point:r}}function Yt(){var e=0,t=0;if("undefined"!=typeof window){var r=Rt().match(/Firefox\/(\d+).(\d+)/);if(r)try{e=parseInt(r[1]),t=parseInt(r[2])}catch(e){}}return{major:e,minor:t}}function Zt(){return Date.now()+Math.random().toString()}function Xt(){throw new Error("Method must be implemented in subclass")}function er(e){if(window._dailyConfig&&window._dailyConfig.callObjectBundleUrlOverride)return window._dailyConfig.callObjectBundleUrlOverride;var t=e?new URL(e).origin:null;function r(e){return"".concat(e,"/static/call-machine-object-bundle.js")}function n(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isStaging;return r("https://c".concat(void 0!==e&&e?".staging":"",".daily.co"))}return t?t.match(/https:\/\/[^.]+\.daily\.co/)?n():t.match(/https:\/\/preview-[^.]+\.staging\.daily\.co/)?r(t):t.match(/https:\/\/[^.]+\.staging\.daily\.co/)?n({isStaging:!0}):r(t):n()}function tr(e){try{new URL(e)}catch(e){return!1}return!0}var rr=function(){function e(){o(this,e)}return u(e,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,r){Xt()}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,r){Xt()}},{key:"sendMessageToCallMachine",value:function(e,t,r,n){Xt()}},{key:"sendMessageToDailyJs",value:function(e,t,r){Xt()}},{key:"removeListener",value:function(e){Xt()}}]),e}();function nr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ir(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(r),!0).forEach(function(t){g(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ar(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var i=m(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return v(this,r)}}var or=function(e){h(r,rr);var t=ar(r);function r(){var e;return o(this,r),(e=t.call(this))._wrappedListeners={},e._messageCallbacks={},e}return u(r,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,r){var n=this,i=function(i){if(i.data&&"iframe-call-message"===i.data.what&&(!i.data.callFrameId||i.data.callFrameId===t)&&(!i.data.from||"module"!==i.data.from)){var a=ir({},i.data);if(delete a.from,a.callbackStamp&&n._messageCallbacks[a.callbackStamp]){var o=a.callbackStamp;n._messageCallbacks[o].call(r,a),delete n._messageCallbacks[o]}delete a.what,delete a.callbackStamp,e.call(r,a)}};this._wrappedListeners[e]=i,window.addEventListener("message",i)}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,r){var n=function(n){if(!(!n.data||"iframe-call-message"!==n.data.what||!n.data.action||n.data.from&&"module"!==n.data.from||n.data.callFrameId&&t&&n.data.callFrameId!==t)){var i=n.data;e.call(r,i)}};this._wrappedListeners[e]=n,window.addEventListener("message",n)}},{key:"sendMessageToCallMachine",value:function(e,t,r,n){var i=ir({},e);if(i.what="iframe-call-message",i.from="module",i.callFrameId=n,t){var a=Zt();this._messageCallbacks[a]=t,i.callbackStamp=a}(r?r.contentWindow:window).postMessage(i,"*")}},{key:"sendMessageToDailyJs",value:function(e,t,r){e.what="iframe-call-message",e.callFrameId=r,e.from="embedded",(t?window:window.parent).postMessage(e,"*")}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"forwardPackagedMessageToCallMachine",value:function(e,t,r){var n=ir({},e);n.callFrameId=r,(t?t.contentWindow:window).postMessage(n,"*")}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e,t){var r=function(r){if(r.data&&"iframe-call-message"===r.data.what&&(!r.data.callFrameId||r.data.callFrameId===t)&&(!r.data.from||"module"!==r.data.from)){var n=r.data;e(n)}};return this._wrappedListeners[e]=r,window.addEventListener("message",r),e}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}}]),r}();function sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var i=m(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return v(this,r)}}var cr=function(e){h(n,rr);var r=sr(n);function n(){var e;return o(this,n),e=r.call(this),global.callMachineToDailyJsEmitter=global.callMachineToDailyJsEmitter||new t,global.dailyJsToCallMachineEmitter=global.dailyJsToCallMachineEmitter||new t,e._wrappedListeners={},e._messageCallbacks={},e}return u(n,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,r){this._addListener(e,global.callMachineToDailyJsEmitter,r,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,r){this._addListener(e,global.dailyJsToCallMachineEmitter,r,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(e,t){this._sendMessage(e,global.dailyJsToCallMachineEmitter,"sending message to call machine",t)}},{key:"sendMessageToDailyJs",value:function(e){this._sendMessage(e,global.callMachineToDailyJsEmitter,"sending message to daily-js")}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(global.callMachineToDailyJsEmitter.removeListener("message",t),global.dailyJsToCallMachineEmitter.removeListener("message",t),delete this._wrappedListeners[e])}},{key:"_addListener",value:function(e,t,r,n){var i=this,a=function(t){if(t.callbackStamp&&i._messageCallbacks[t.callbackStamp]){var n=t.callbackStamp;i._messageCallbacks[n].call(r,t),delete i._messageCallbacks[n]}e.call(r,t)};this._wrappedListeners[e]=a,t.addListener("message",a)}},{key:"_sendMessage",value:function(e,t,r,n){if(n){var i=Zt();this._messageCallbacks[i]=n,e.callbackStamp=i}t.emit("message",e)}}]),n}();var ur=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")};var lr=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}},dr=d(function(e){function t(r,n,i){return lr()?e.exports=t=Reflect.construct:e.exports=t=function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&p(i,r.prototype),i},t.apply(null,arguments)}e.exports=t}),pr=d(function(e){function t(r){var n="function"==typeof Map?new Map:void 0;return e.exports=t=function(e){if(null===e||!ur(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return dr(e,arguments,m(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),p(t,e)},t(r)}e.exports=t});function hr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var i=m(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return v(this,r)}}var fr=function(){function e(){o(this,e),this._currentLoad=null}return u(e,[{key:"load",value:function(e,t,r,n,i){if(this.loaded)return window._dailyCallObjectSetup(t),void n(!0);!function(e,t){window._dailyConfig||(window._dailyConfig={}),window._dailyConfig.callFrameId=e,window._dailyConfig.avoidEval=t}(t,r),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new mr(e,function(){n(!1)},i),this._currentLoad.start()}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel()}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}]),e}(),vr=3,mr=function(){function e(t,r,n){o(this,e),this._attemptsRemaining=vr,this._currentAttempt=null,this._meetingOrBaseUrl=t,this._successCallback=r,this._failureCallback=n}return u(e,[{key:"start",value:function(){var e=this;if(!this._currentAttempt){this._currentAttempt=new yr(this._meetingOrBaseUrl,this._successCallback,function t(r){e._currentAttempt.cancelled||(e._attemptsRemaining--,e._failureCallback(r,e._attemptsRemaining>0),e._attemptsRemaining<=0||setTimeout(function(){e._currentAttempt.cancelled||(e._currentAttempt=new yr(e._meetingOrBaseUrl,e._successCallback,t),e._currentAttempt.start())},3e3))}),this._currentAttempt.start()}}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}]),e}(),gr=function(e){h(r,e);var t=hr(r);function r(){return o(this,r),t.apply(this,arguments)}return r}(pr(Error)),yr=function(){function e(t,r,n){o(this,e),this._loadAttemptImpl=Vt()||!_dailyConfig.avoidEval?new br(t,r,n):new wr(t,r,n)}return u(e,[{key:"start",value:function(){var e=a(function*(){return this._loadAttemptImpl.start()});return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]),e}(),br=function(){function e(t,r,n){o(this,e),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache="undefined"!=typeof iOSCallObjectBundleCache&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._meetingOrBaseUrl=t,this._successCallback=r,this._failureCallback=n}return u(e,[{key:"start",value:function(){var e=a(function*(){var e;try{e=er(this._meetingOrBaseUrl)}catch(e){return void this._failureCallback("Failed to get call object bundle for URL ".concat(this._meetingOrBaseUrl,": ").concat(e))}!(yield this._tryLoadFromIOSCache(e))&&this._loadFromNetwork(e)});return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:function(){var e=a(function*(e){if(!this._iosCache)return!1;try{var t=yield this._iosCache.get(e);return!!this.cancelled||!!t&&(t.code?(Function('"use strict";'+t.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=t.refetchHeaders,!1))}catch(e){return!1}});return function(t){return e.apply(this,arguments)}}()},{key:"_loadFromNetwork",value:function(){var e=a(function*(e){var t=this;this._networkTimeout=setTimeout(function(){t._networkTimedOut=!0,t._failureCallback("Timed out (>".concat(2e4," ms) when loading call object bundle ").concat(e))},2e4);try{var r=this._refetchHeaders?{headers:this._refetchHeaders}:{},n=yield fetch(e,r);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new gr;var i=yield this._getBundleCodeFromResponse(e,n);if(this.cancelled)throw new gr;Function('"use strict";'+i)(),this._iosCache&&this._iosCache.set(e,i,n.headers),this.succeeded=!0,this._successCallback()}catch(t){if(clearTimeout(this._networkTimeout),t instanceof gr||this.cancelled||this._networkTimedOut)return;this._failureCallback("Failed to load call object bundle ".concat(e,": ").concat(t))}});return function(t){return e.apply(this,arguments)}}()},{key:"_getBundleCodeFromResponse",value:function(){var e=a(function*(e,t){if(t.ok)return yield t.text();if(this._iosCache&&304===t.status)return(yield this._iosCache.renew(e,t.headers)).code;throw new Error("Received ".concat(t.status," response"))});return function(t,r){return e.apply(this,arguments)}}()}]),e}(),wr=function(){function e(t,r,n){o(this,e),this.cancelled=!1,this.succeeded=!1,this._meetingOrBaseUrl=t,this._successCallback=r,this._failureCallback=n,this._attemptId=Zt(),this._networkTimeout=null,this._scriptElement=null}return u(e,[{key:"start",value:function(){var e=a(function*(){var e;window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);try{e=er(this._meetingOrBaseUrl)}catch(e){return void this._failureCallback("Failed to get call object bundle for URL ".concat(this._meetingOrBaseUrl,": ").concat(e))}"object"===("undefined"==typeof document?"undefined":f(document))?this._startLoading(e):this._failureCallback("Call object bundle must be loaded in a DOM/web context")});return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(e){var t=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout(function(){t._stopLoading(),t._failureCallback("Timed out (>".concat(2e4," ms) when loading call object bundle ").concat(e))},2e4);var r=document.getElementsByTagName("head")[0],n=document.createElement("script");this._scriptElement=n,n.onload=a(function*(){t._stopLoading(),t.succeeded=!0,t._successCallback()}),n.onerror=function(){var e=a(function*(e){t._stopLoading(),t._failureCallback("Failed to load call object bundle ".concat(e.target.src))});return function(t){return e.apply(this,arguments)}}(),n.src=e,r.appendChild(n)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}]),e}();var _r=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,a=[];++r<n;){var o=e[r];t(o,r,e)&&(a[i++]=o)}return a};var kr=function(e){return function(t,r,n){for(var i=-1,a=Object(t),o=n(t),s=o.length;s--;){var c=o[e?s:++i];if(!1===r(a[c],c,a))break}return t}}();var Mr=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},Sr="object"==typeof l&&l&&l.Object===Object&&l,Cr="object"==typeof self&&self&&self.Object===Object&&self,Tr=Sr||Cr||Function("return this")(),jr=Tr.Symbol,Or=Object.prototype,Pr=Or.hasOwnProperty,Ar=Or.toString,Er=jr?jr.toStringTag:void 0;var Fr=function(e){var t=Pr.call(e,Er),r=e[Er];try{e[Er]=void 0;var n=!0}catch(e){}var i=Ar.call(e);return n&&(t?e[Er]=r:delete e[Er]),i},Ir=Object.prototype.toString;var Lr=function(e){return Ir.call(e)},Br="[object Null]",Dr="[object Undefined]",xr=jr?jr.toStringTag:void 0;var Nr=function(e){return null==e?void 0===e?Dr:Br:xr&&xr in Object(e)?Fr(e):Lr(e)};var Rr=function(e){return null!=e&&"object"==typeof e},Vr="[object Arguments]";var Ur=function(e){return Rr(e)&&Nr(e)==Vr},Jr=Object.prototype,zr=Jr.hasOwnProperty,qr=Jr.propertyIsEnumerable,Wr=Ur(function(){return arguments}())?Ur:function(e){return Rr(e)&&zr.call(e,"callee")&&!qr.call(e,"callee")},Gr=Array.isArray;var Hr=function(){return!1},Kr=d(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r?Tr.Buffer:void 0,a=(i?i.isBuffer:void 0)||Hr;e.exports=a}),Qr=9007199254740991,$r=/^(?:0|[1-9]\d*)$/;var Yr=function(e,t){var r=typeof e;return!!(t=null==t?Qr:t)&&("number"==r||"symbol"!=r&&$r.test(e))&&e>-1&&e%1==0&&e<t},Zr=9007199254740991;var Xr=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Zr},en={};en["[object Float32Array]"]=en["[object Float64Array]"]=en["[object Int8Array]"]=en["[object Int16Array]"]=en["[object Int32Array]"]=en["[object Uint8Array]"]=en["[object Uint8ClampedArray]"]=en["[object Uint16Array]"]=en["[object Uint32Array]"]=!0,en["[object Arguments]"]=en["[object Array]"]=en["[object ArrayBuffer]"]=en["[object Boolean]"]=en["[object DataView]"]=en["[object Date]"]=en["[object Error]"]=en["[object Function]"]=en["[object Map]"]=en["[object Number]"]=en["[object Object]"]=en["[object RegExp]"]=en["[object Set]"]=en["[object String]"]=en["[object WeakMap]"]=!1;var tn=function(e){return Rr(e)&&Xr(e.length)&&!!en[Nr(e)]};var rn=function(e){return function(t){return e(t)}},nn=d(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r&&Sr.process,a=function(){try{var e=n&&n.require&&n.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=a}),an=nn&&nn.isTypedArray,on=an?rn(an):tn,sn=Object.prototype.hasOwnProperty;var cn=function(e,t){var r=Gr(e),n=!r&&Wr(e),i=!r&&!n&&Kr(e),a=!r&&!n&&!i&&on(e),o=r||n||i||a,s=o?Mr(e.length,String):[],c=s.length;for(var u in e)!t&&!sn.call(e,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Yr(u,c))||s.push(u);return s},un=Object.prototype;var ln=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||un)};var dn=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),pn=Object.prototype.hasOwnProperty;var hn=function(e){if(!ln(e))return dn(e);var t=[];for(var r in Object(e))pn.call(e,r)&&"constructor"!=r&&t.push(r);return t};var fn=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},vn="[object AsyncFunction]",mn="[object Function]",gn="[object GeneratorFunction]",yn="[object Proxy]";var bn=function(e){if(!fn(e))return!1;var t=Nr(e);return t==mn||t==gn||t==vn||t==yn};var wn=function(e){return null!=e&&Xr(e.length)&&!bn(e)};var _n=function(e){return wn(e)?cn(e):hn(e)};var kn=function(e,t){return function(r,n){if(null==r)return r;if(!wn(r))return e(r,n);for(var i=r.length,a=t?i:-1,o=Object(r);(t?a--:++a<i)&&!1!==n(o[a],a,o););return r}}(function(e,t){return e&&kr(e,t,_n)});var Mn=function(e,t){var r=[];return kn(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r};var Sn=function(){this.__data__=[],this.size=0};var Cn=function(e,t){return e===t||e!=e&&t!=t};var Tn=function(e,t){for(var r=e.length;r--;)if(Cn(e[r][0],t))return r;return-1},jn=Array.prototype.splice;var On=function(e){var t=this.__data__,r=Tn(t,e);return!(r<0||(r==t.length-1?t.pop():jn.call(t,r,1),--this.size,0))};var Pn=function(e){var t=this.__data__,r=Tn(t,e);return r<0?void 0:t[r][1]};var An=function(e){return Tn(this.__data__,e)>-1};var En=function(e,t){var r=this.__data__,n=Tn(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function Fn(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Fn.prototype.clear=Sn,Fn.prototype.delete=On,Fn.prototype.get=Pn,Fn.prototype.has=An,Fn.prototype.set=En;var In=Fn;var Ln=function(){this.__data__=new In,this.size=0};var Bn=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var Dn=function(e){return this.__data__.get(e)};var xn,Nn=function(e){return this.__data__.has(e)},Rn=Tr["__core-js_shared__"],Vn=(xn=/[^.]+$/.exec(Rn&&Rn.keys&&Rn.keys.IE_PROTO||""))?"Symbol(src)_1."+xn:"";var Un=function(e){return!!Vn&&Vn in e},Jn=Function.prototype.toString;var zn=function(e){if(null!=e){try{return Jn.call(e)}catch(e){}try{return e+""}catch(e){}}return""},qn=/^\[object .+?Constructor\]$/,Wn=Function.prototype,Gn=Object.prototype,Hn=Wn.toString,Kn=Gn.hasOwnProperty,Qn=RegExp("^"+Hn.call(Kn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var $n=function(e){return!(!fn(e)||Un(e))&&(bn(e)?Qn:qn).test(zn(e))};var Yn=function(e,t){return null==e?void 0:e[t]};var Zn=function(e,t){var r=Yn(e,t);return $n(r)?r:void 0},Xn=Zn(Tr,"Map"),ei=Zn(Object,"create");var ti=function(){this.__data__=ei?ei(null):{},this.size=0};var ri=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ni="__lodash_hash_undefined__",ii=Object.prototype.hasOwnProperty;var ai=function(e){var t=this.__data__;if(ei){var r=t[e];return r===ni?void 0:r}return ii.call(t,e)?t[e]:void 0},oi=Object.prototype.hasOwnProperty;var si=function(e){var t=this.__data__;return ei?void 0!==t[e]:oi.call(t,e)},ci="__lodash_hash_undefined__";var ui=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ei&&void 0===t?ci:t,this};function li(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}li.prototype.clear=ti,li.prototype.delete=ri,li.prototype.get=ai,li.prototype.has=si,li.prototype.set=ui;var di=li;var pi=function(){this.size=0,this.__data__={hash:new di,map:new(Xn||In),string:new di}};var hi=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var fi=function(e,t){var r=e.__data__;return hi(t)?r["string"==typeof t?"string":"hash"]:r.map};var vi=function(e){var t=fi(this,e).delete(e);return this.size-=t?1:0,t};var mi=function(e){return fi(this,e).get(e)};var gi=function(e){return fi(this,e).has(e)};var yi=function(e,t){var r=fi(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function bi(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}bi.prototype.clear=pi,bi.prototype.delete=vi,bi.prototype.get=mi,bi.prototype.has=gi,bi.prototype.set=yi;var wi=bi,_i=200;var ki=function(e,t){var r=this.__data__;if(r instanceof In){var n=r.__data__;if(!Xn||n.length<_i-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new wi(n)}return r.set(e,t),this.size=r.size,this};function Mi(e){var t=this.__data__=new In(e);this.size=t.size}Mi.prototype.clear=Ln,Mi.prototype.delete=Bn,Mi.prototype.get=Dn,Mi.prototype.has=Nn,Mi.prototype.set=ki;var Si=Mi,Ci="__lodash_hash_undefined__";var Ti=function(e){return this.__data__.set(e,Ci),this};var ji=function(e){return this.__data__.has(e)};function Oi(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new wi;++t<r;)this.add(e[t])}Oi.prototype.add=Oi.prototype.push=Ti,Oi.prototype.has=ji;var Pi=Oi;var Ai=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var Ei=function(e,t){return e.has(t)},Fi=1,Ii=2;var Li=function(e,t,r,n,i,a){var o=r&Fi,s=e.length,c=t.length;if(s!=c&&!(o&&c>s))return!1;var u=a.get(e);if(u&&a.get(t))return u==t;var l=-1,d=!0,p=r&Ii?new Pi:void 0;for(a.set(e,t),a.set(t,e);++l<s;){var h=e[l],f=t[l];if(n)var v=o?n(f,h,l,t,e,a):n(h,f,l,e,t,a);if(void 0!==v){if(v)continue;d=!1;break}if(p){if(!Ai(t,function(e,t){if(!Ei(p,t)&&(h===e||i(h,e,r,n,a)))return p.push(t)})){d=!1;break}}else if(h!==f&&!i(h,f,r,n,a)){d=!1;break}}return a.delete(e),a.delete(t),d},Bi=Tr.Uint8Array;var Di=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r};var xi=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r},Ni=1,Ri=2,Vi="[object Boolean]",Ui="[object Date]",Ji="[object Error]",zi="[object Map]",qi="[object Number]",Wi="[object RegExp]",Gi="[object Set]",Hi="[object String]",Ki="[object Symbol]",Qi="[object ArrayBuffer]",$i="[object DataView]",Yi=jr?jr.prototype:void 0,Zi=Yi?Yi.valueOf:void 0;var Xi=function(e,t,r,n,i,a,o){switch(r){case $i:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Qi:return!(e.byteLength!=t.byteLength||!a(new Bi(e),new Bi(t)));case Vi:case Ui:case qi:return Cn(+e,+t);case Ji:return e.name==t.name&&e.message==t.message;case Wi:case Hi:return e==t+"";case zi:var s=Di;case Gi:var c=n&Ni;if(s||(s=xi),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;n|=Ri,o.set(e,t);var l=Li(s(e),s(t),n,i,a,o);return o.delete(e),l;case Ki:if(Zi)return Zi.call(e)==Zi.call(t)}return!1};var ea=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e};var ta=function(e,t,r){var n=t(e);return Gr(e)?n:ea(n,r(e))};var ra=function(){return[]},na=Object.prototype.propertyIsEnumerable,ia=Object.getOwnPropertySymbols,aa=ia?function(e){return null==e?[]:(e=Object(e),_r(ia(e),function(t){return na.call(e,t)}))}:ra;var oa=function(e){return ta(e,_n,aa)},sa=1,ca=Object.prototype.hasOwnProperty;var ua=function(e,t,r,n,i,a){var o=r&sa,s=oa(e),c=s.length;if(c!=oa(t).length&&!o)return!1;for(var u=c;u--;){var l=s[u];if(!(o?l in t:ca.call(t,l)))return!1}var d=a.get(e);if(d&&a.get(t))return d==t;var p=!0;a.set(e,t),a.set(t,e);for(var h=o;++u<c;){var f=e[l=s[u]],v=t[l];if(n)var m=o?n(v,f,l,t,e,a):n(f,v,l,e,t,a);if(!(void 0===m?f===v||i(f,v,r,n,a):m)){p=!1;break}h||(h="constructor"==l)}if(p&&!h){var g=e.constructor,y=t.constructor;g!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y)&&(p=!1)}return a.delete(e),a.delete(t),p},la=Zn(Tr,"DataView"),da=Zn(Tr,"Promise"),pa=Zn(Tr,"Set"),ha=Zn(Tr,"WeakMap"),fa=zn(la),va=zn(Xn),ma=zn(da),ga=zn(pa),ya=zn(ha),ba=Nr;(la&&"[object DataView]"!=ba(new la(new ArrayBuffer(1)))||Xn&&"[object Map]"!=ba(new Xn)||da&&"[object Promise]"!=ba(da.resolve())||pa&&"[object Set]"!=ba(new pa)||ha&&"[object WeakMap]"!=ba(new ha))&&(ba=function(e){var t=Nr(e),r="[object Object]"==t?e.constructor:void 0,n=r?zn(r):"";if(n)switch(n){case fa:return"[object DataView]";case va:return"[object Map]";case ma:return"[object Promise]";case ga:return"[object Set]";case ya:return"[object WeakMap]"}return t});var wa=ba,_a=1,ka="[object Arguments]",Ma="[object Array]",Sa="[object Object]",Ca=Object.prototype.hasOwnProperty;var Ta=function(e,t,r,n,i,a){var o=Gr(e),s=Gr(t),c=o?Ma:wa(e),u=s?Ma:wa(t),l=(c=c==ka?Sa:c)==Sa,d=(u=u==ka?Sa:u)==Sa,p=c==u;if(p&&Kr(e)){if(!Kr(t))return!1;o=!0,l=!1}if(p&&!l)return a||(a=new Si),o||on(e)?Li(e,t,r,n,i,a):Xi(e,t,c,r,n,i,a);if(!(r&_a)){var h=l&&Ca.call(e,"__wrapped__"),f=d&&Ca.call(t,"__wrapped__");if(h||f){var v=h?e.value():e,m=f?t.value():t;return a||(a=new Si),i(v,m,r,n,a)}}return!!p&&(a||(a=new Si),ua(e,t,r,n,i,a))};var ja=function e(t,r,n,i,a){return t===r||(null==t||null==r||!Rr(t)&&!Rr(r)?t!=t&&r!=r:Ta(t,r,n,i,e,a))},Oa=1,Pa=2;var Aa=function(e,t,r,n){var i=r.length,a=i,o=!n;if(null==e)return!a;for(e=Object(e);i--;){var s=r[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){var c=(s=r[i])[0],u=e[c],l=s[1];if(o&&s[2]){if(void 0===u&&!(c in e))return!1}else{var d=new Si;if(n)var p=n(u,l,c,e,t,d);if(!(void 0===p?ja(l,u,Oa|Pa,n,d):p))return!1}}return!0};var Ea=function(e){return e==e&&!fn(e)};var Fa=function(e){for(var t=_n(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,Ea(i)]}return t};var Ia=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}};var La=function(e){var t=Fa(e);return 1==t.length&&t[0][2]?Ia(t[0][0],t[0][1]):function(r){return r===e||Aa(r,e,t)}},Ba="[object Symbol]";var Da=function(e){return"symbol"==typeof e||Rr(e)&&Nr(e)==Ba},xa=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Na=/^\w*$/;var Ra=function(e,t){if(Gr(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Da(e))||Na.test(e)||!xa.test(e)||null!=t&&e in Object(t)},Va="Expected a function";function Ua(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Va);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var o=e.apply(this,n);return r.cache=a.set(i,o)||a,o};return r.cache=new(Ua.Cache||wi),r}Ua.Cache=wi;var Ja=Ua,za=500;var qa=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Wa=/\\(\\)?/g,Ga=function(e){var t=Ja(e,function(e){return r.size===za&&r.clear(),e}),r=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(qa,function(e,r,n,i){t.push(n?i.replace(Wa,"$1"):r||e)}),t});var Ha=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},Ka=1/0,Qa=jr?jr.prototype:void 0,$a=Qa?Qa.toString:void 0;var Ya=function e(t){if("string"==typeof t)return t;if(Gr(t))return Ha(t,e)+"";if(Da(t))return $a?$a.call(t):"";var r=t+"";return"0"==r&&1/t==-Ka?"-0":r};var Za=function(e){return null==e?"":Ya(e)};var Xa=function(e,t){return Gr(e)?e:Ra(e,t)?[e]:Ga(Za(e))},eo=1/0;var to=function(e){if("string"==typeof e||Da(e))return e;var t=e+"";return"0"==t&&1/e==-eo?"-0":t};var ro=function(e,t){for(var r=0,n=(t=Xa(t,e)).length;null!=e&&r<n;)e=e[to(t[r++])];return r&&r==n?e:void 0};var no=function(e,t,r){var n=null==e?void 0:ro(e,t);return void 0===n?r:n};var io=function(e,t){return null!=e&&t in Object(e)};var ao=function(e,t,r){for(var n=-1,i=(t=Xa(t,e)).length,a=!1;++n<i;){var o=to(t[n]);if(!(a=null!=e&&r(e,o)))break;e=e[o]}return a||++n!=i?a:!!(i=null==e?0:e.length)&&Xr(i)&&Yr(o,i)&&(Gr(e)||Wr(e))};var oo=function(e,t){return null!=e&&ao(e,t,io)},so=1,co=2;var uo=function(e,t){return Ra(e)&&Ea(t)?Ia(to(e),t):function(r){var n=no(r,e);return void 0===n&&n===t?oo(r,e):ja(t,n,so|co)}};var lo=function(e){return e};var po=function(e){return function(t){return null==t?void 0:t[e]}};var ho=function(e){return function(t){return ro(t,e)}};var fo=function(e){return Ra(e)?po(to(e)):ho(e)};var vo=function(e){return"function"==typeof e?e:null==e?lo:"object"==typeof e?Gr(e)?uo(e[0],e[1]):La(e):fo(e)};var mo=function(e,t){return(Gr(e)?_r:Mn)(e,vo(t))};var go=function(e,t){var r=-1,n=wn(e)?Array(e.length):[];return kn(e,function(e,i,a){n[++r]=t(e,i,a)}),n};var yo=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e};var bo=function(e,t){if(e!==t){var r=void 0!==e,n=null===e,i=e==e,a=Da(e),o=void 0!==t,s=null===t,c=t==t,u=Da(t);if(!s&&!u&&!a&&e>t||a&&o&&c&&!s&&!u||n&&o&&c||!r&&c||!i)return 1;if(!n&&!a&&!u&&e<t||u&&r&&i&&!n&&!a||s&&r&&i||!o&&i||!c)return-1}return 0};var wo=function(e,t,r){for(var n=-1,i=e.criteria,a=t.criteria,o=i.length,s=r.length;++n<o;){var c=bo(i[n],a[n]);if(c)return n>=s?c:c*("desc"==r[n]?-1:1)}return e.index-t.index};var _o=function(e,t,r){var n=-1;t=Ha(t.length?t:[lo],rn(vo));var i=go(e,function(e,r,i){return{criteria:Ha(t,function(t){return t(e)}),index:++n,value:e}});return yo(i,function(e,t){return wo(e,t,r)})};var ko=function(e,t,r,n){return null==e?[]:(Gr(t)||(t=null==t?[]:[t]),Gr(r=n?void 0:r)||(r=null==r?[]:[r]),_o(e,t,r))},Mo=function(e,t,r){return!0===To(e.local,t,r)},So=function(e,t,r){return e.local.streams&&e.local.streams[t]&&e.local.streams[t].stream&&e.local.streams[t].stream["get".concat("video"===r?"Video":"Audio","Tracks")]()[0]},Co=function(e,t,r,n){var i=jo(e,t,r,n);return i&&i.pendingTrack},To=function(e,t,r){if(!e)return!1;var n=function(e){switch(e){case"avatar":return!0;case"staged":return e;default:return!!e}},i=e.public.subscribedTracks;return i&&i[t]?-1===["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(r)&&i[t].custom?[!0,"staged"].includes(i[t].custom)?n(i[t].custom):n(i[t].custom[r]):n(i[t][r]):!i||n(i.ALL)},jo=function(e,t,r,n){var i=ko(mo(e.streams,function(e){return e.participantId===t&&e.type===r&&e.pendingTrack&&e.pendingTrack.kind===n}),"starttime","desc");return i&&i[0]},Oo=function(e,t){var r=e.local.public.customTracks;if(r&&r[t])return r[t].track},Po=function(e,t,r,n){var i="soup-"+r,a=ko(mo(e.streams,function(e){return e.participantId===t&&e.streamId===i&&e.pendingTrack&&e.pendingTrack.kind===n}),"starttime","desc");return a&&a[0]&&a[0].pendingTrack};function Ao(e){for(var t=store.getState(),r=0,n=["cam","screen"];r<n.length;r++)for(var i=n[r],a=0,o=["video","audio"];a<o.length;a++){var s=o[a],c="cam"===i?s:"screen".concat(s.charAt(0).toUpperCase()+s.slice(1)),u=e.tracks[c];if(u){var l=e.local?So(t,i,s):Co(t,e.session_id,i,s);"playable"===u.state&&(u.track=l),u.persistentTrack=l}}}function Eo(e){try{var t=store.getState();for(var r in e.tracks)if(!Fo(r)){var n=e.tracks[r].kind;if(n){var i=e.tracks[r];if(i){var a=e.local?Oo(t,r,n):Po(t,e.session_id,r,n);"playable"===i.state&&(e.tracks[r].track=a),i.persistentTrack=a}}else console.error("unknown type for custom track")}}catch(e){console.error(e)}}function Fo(e){return["video","audio","screenVideo","screenAudio"].includes(e)}function Io(e,t){var r=store.getState();if(e.local){if(e.audio)try{e.audioTrack=r.local.streams.cam.stream.getAudioTracks()[0],e.audioTrack||(e.audio=!1)}catch(e){}if(e.video)try{e.videoTrack=r.local.streams.cam.stream.getVideoTracks()[0],e.videoTrack||(e.video=!1)}catch(e){}if(e.screen)try{e.screenVideoTrack=r.local.streams.screen.stream.getVideoTracks()[0],e.screenAudioTrack=r.local.streams.screen.stream.getAudioTracks()[0],e.screenVideoTrack||e.screenAudioTrack||(e.screen=!1)}catch(e){}}else{var n=!0;try{var i=r.participants[e.session_id];i&&i.public&&i.public.rtcType&&"peer-to-peer"===i.public.rtcType.impl&&i.private&&!["connected","completed"].includes(i.private.peeringState)&&(n=!1)}catch(e){console.error(e)}if(!n)return e.audio=!1,e.audioTrack=!1,e.video=!1,e.videoTrack=!1,e.screen=!1,void(e.screenTrack=!1);try{r.streams;if(e.audio&&Mo(r,e.session_id,"cam-audio")){var a=Co(r,e.session_id,"cam","audio");a&&(t&&t.audioTrack&&t.audioTrack.id===a.id?e.audioTrack=a:a.muted||(e.audioTrack=a)),e.audioTrack||(e.audio=!1)}if(e.video&&Mo(r,e.session_id,"cam-video")){var o=Co(r,e.session_id,"cam","video");o&&(t&&t.videoTrack&&t.videoTrack.id===o.id?e.videoTrack=o:o.muted||(e.videoTrack=o)),e.videoTrack||(e.video=!1)}if(e.screen&&Mo(r,e.session_id,"screen-audio")){var s=Co(r,e.session_id,"screen","audio");s&&(t&&t.screenAudioTrack&&t.screenAudioTrack.id===s.id?e.screenAudioTrack=s:s.muted||(e.screenAudioTrack=s))}if(e.screen&&Mo(r,e.session_id,"screen-video")){var c=Co(r,e.session_id,"screen","video");c&&(t&&t.screenVideoTrack&&t.screenVideoTrack.id===c.id?e.screenVideoTrack=c:c.muted||(e.screenVideoTrack=c))}e.screenVideoTrack||e.screenAudioTrack||(e.screen=!1)}catch(e){console.error("unexpected error matching up tracks",e)}}}function Lo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Bo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lo(Object(r),!0).forEach(function(t){g(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lo(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Do(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var i=m(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return v(this,r)}}function xo(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return No(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return No(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function No(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ro="video",Vo="voice",Uo=3,Jo={present:0,hidden:0},zo={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},qo=["state","simulcastEncodings"],Wo={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},Go={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string"}},Ho={customEmbeds:!0,customTrayButtons:{validate:ns,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(Go))},url:{validate:function(e){return"string"==typeof e},help:"url should be a string"},baseUrl:{validate:function(e){return"string"==typeof e},help:"baseUrl should be a string"},token:{validate:function(e){return"string"==typeof e},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(e){return window._dailyConfig||(window._dailyConfig={}),window._dailyConfig.experimentalGetUserMediaConstraintsModify=e.experimentalGetUserMediaConstraintsModify,window._dailyConfig.userMediaVideoConstraints=e.userMediaVideoConstraints,window._dailyConfig.userMediaAudioConstraints=e.userMediaAudioConstraints,window._dailyConfig.callObjectBundleUrlOverride=e.callObjectBundleUrlOverride,!0}},reactNativeConfig:{validate:function(e){return function e(t,r){if(void 0===r)return!1;switch(f(r)){case"string":return f(t)===r;case"object":if("object"!==f(t))return!1;for(var n in t)if(!e(t[n],r[n]))return!1;return!0;default:return!1}}(e,Wo)},help:"reactNativeConfig should look like ".concat(JSON.stringify(Wo),", all fields optional")},lang:{validate:function(e){return["de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","ru","sv","tr","user"].includes(e)},help:"language not supported. Options are: de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, ru, sv, tr, user"},userName:!0,userData:{validate:function(e){try{return Zo(e),!0}catch(e){return console.error(e),!1}},help:"invalid userData type provided"},activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(e,t){return t._preloadCache.videoDeviceId=e,!0}},audioSource:{validate:function(e,t){return t._preloadCache.audioDeviceId=e,!0}},subscribeToTracksAutomatically:{validate:function(e,t){return t._preloadCache.subscribeToTracksAutomatically=e,!0}},theme:{validate:function(e){var t=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],r=function(e){for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];if(!t.includes(i))return console.error('unsupported color "'.concat(i,'". Valid colors: ').concat(t.join(", "))),!1;if(!e[i].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(i,' theme color should be provided in valid hex color format. Received: "').concat(e[i],'"')),!1}return!0};return"object"===f(e)&&("light"in e&&"dark"in e||"colors"in e)?"light"in e&&"dark"in e?"colors"in e.light?"colors"in e.dark?r(e.light.colors)&&r(e.dark.colors):(console.error('Dark theme is missing "colors" property.',e),!1):(console.error('Light theme is missing "colors" property.',e),!1):r(e.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',e),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(e){if("grid"in e){var t=e.grid;if("maxTilesPerPage"in t){if(!Number.isInteger(t.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(t.maxTilesPerPage,".")),!1;if(t.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in t){if(!Number.isInteger(t.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(t.minTilesPerPage,".")),!1;if(t.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in t&&t.minTilesPerPage>t.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(e){return Xo(e,{allowAllParticipantsKey:!1})},help:rs({allowAllParticipantsKey:!1})},inputSettings:{validate:function(e){return es(e)},help:ts()},layout:{validate:function(e){return"custom-v1"===e||"browser"===e||"none"===e},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"}},Ko={styles:{validate:function(e){for(var t in e)if("cam"!==t&&"screen"!==t)return!1;if(e.cam)for(var t in e.cam)if("div"!==t&&"video"!==t)return!1;if(e.screen)for(var t in e.screen)if("div"!==t&&"video"!==t)return!1;return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(e,t,r){if(t._preloadCache.subscribeToTracksAutomatically)return!1;var n=[!0,!1,"staged"];if(n.includes(e)||!Vt()&&"avatar"===e)return!0;var i=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"];return function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var a in t)if("custom"===a){if(!n.includes(t[a])&&!e(t[a],!0))return!1}else{var o=!r&&!i.includes(a),s=!n.includes(t[a]);if(o||s)return!1}return!0}(e)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(Vt()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,eject:!0,updatePermissions:{validate:function(e){for(var t=0,r=Object.entries(e);t<r.length;t++){var n=M(r[t],2),i=n[0],a=n[1];switch(i){case"hasPresence":if("boolean"!=typeof a)return!1;break;case"canSend":if(a instanceof Set){var o,s=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],c=xo(a);try{for(c.s();!(o=c.n()).done;){var u=o.value;if(!s.includes(u))return!1}}catch(e){c.e(e)}finally{c.f()}}else if("boolean"!=typeof a)return!1;break;default:return!1}}return!0},help:"updatePermissions can take hasPresence and canSend permissions. hasPresence must be a boolean. canSend can be a boolean or an array of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio)."}};function Qo(e){var t={};for(var r in e)e[r]instanceof MediaStreamTrack?t[r]=At:"dailyConfig"===r?(e[r].modifyLocalSdpHook&&(window._dailyConfig&&(window._dailyConfig.modifyLocalSdpHook=e[r].modifyLocalSdpHook),delete e[r].modifyLocalSdpHook),e[r].modifyRemoteSdpHook&&(window._dailyConfig&&(window._dailyConfig.modifyRemoteSdpHook=e[r].modifyRemoteSdpHook),delete e[r].modifyRemoteSdpHook),t[r]=e[r]):t[r]=e[r];return t}function $o(){if(Vt())throw new Error("This daily-js method is not currently supported in React Native")}function Yo(){if(!Vt())throw new Error("This daily-js method is only supported in React Native")}function Zo(e){var t;try{t=JSON.stringify(e)}catch(e){throw Error("userData must be serializable to JSON: ".concat(e))}if(W(JSON.parse(t),e)||console.warning("The userData provided will be modified when serialized."),t.length>Pt)throw Error("userData is too large (".concat(t.length," characters). Maximum size suppported is ").concat(Pt,"."));return!0}function Xo(e,t){for(var r=t.allowAllParticipantsKey,n=function(e){var t=["local"];return r||t.push("*"),e&&!t.includes(e)},i=function(e){return!!(void 0===e.layer||Number.isInteger(e.layer)&&e.layer>=0||"inherit"===e.layer)},a=function(e){return!!e&&(!(e.video&&!i(e.video))&&!(e.screenVideo&&!i(e.screenVideo)))},o=0,s=Object.entries(e);o<s.length;o++){var c=M(s[o],2),u=c[0],l=c[1];if(!n(u)||!a(l))return!1}return!0}function es(e){return"object"===f(e)&&(!(!e.video||"object"!==f(e.video))&&!!function(e){var t=["type","config","publish"];if(!e)return!1;if("object"!==f(e))return!1;if(0===Object.keys(e).length)return!1;if(e.type&&!function(e){if("string"!=typeof e)return!1;if(!Object.values(Et).includes(e))return console.error("inputSettings video processor type invalid"),!1;return!0}(e.type))return!1;if(void 0!==e.publish&&"boolean"!=typeof e.publish)return!1;"boolean"==typeof e.publish&&console.warn("inputSettings.video.processor: publish key has been deprecated; it will be ignored");if(e.config){if("object"!==f(e.config))return!1;if(!function(e,t){var r=Object.keys(t);if(0===r.length)return!0;var n="invalid object in inputSettings -> video -> processor -> config";switch(e){case Et.BGBLUR:return r.length>1||"strength"!==r[0]?(console.error(n),!1):!("number"!=typeof t.strength||t.strength<=0||t.strength>1||isNaN(t.strength))||(console.error("".concat(n,"; expected: {0 < strength <= 1}, got: ").concat(t.strength)),!1);case Et.BGIMAGE:return!(void 0!==t.source&&!function(e){if("default"===e.source)return e.type="default",!0;if(tr(e.source))return e.type="url",!!function(e){var t=new URL(e),r=t.pathname;if("data:"===t.protocol)try{var n=r.substring(r.indexOf(":")+1,r.indexOf(";")),i=n.split("/")[1];return Dt.includes(i)}catch(e){return console.error("failed to deduce blob content type",e),!1}var a=r.split(".").at(-1).toLowerCase().trim();return Dt.includes(a)}(e.source)||(console.error("invalid image type; supported types: [".concat(Dt.join(", "),"]")),!1);return t=e.source,r=Number(t),isNaN(r)||!Number.isInteger(r)||r<=0||r>Bt?(console.error("invalid image selection; must be an int, > 0, <= ".concat(Bt)),!1):(e.type="daily-preselect",!0);var t,r}(t));default:return!0}}(e.type,e.config))return!1}return Object.keys(e).filter(function(e){return!t.includes(e)}).forEach(function(t){console.warn("invalid key inputSettings -> video -> processor : ".concat(t)),delete e[t]}),!0}(e.video.processor))}function ts(){var e=Object.values(Et).join(" | ");return"inputSettings must be of the form: { video: { processor: [ ".concat(e," ] }, config?: {} }")}function rs(e){var t=e.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat(we).concat(t?' | "'.concat(_e,'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function ns(e){if(e&&"object"!==f(e)||Array.isArray(e))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(Go),".")),!1;if(e)for(var t=0,r=Object.entries(e);t<r.length;t++)for(var n=M(r[t],1)[0],i=0,a=Object.entries(e[n]);i<a.length;i++){var o=M(a[i],2),s=o[0],c=o[1];if("iconPath"===s&&!tr(c))return console.error("customTrayButton ".concat(s," should be a url.")),!1;if("iconPathDarkMode"===s&&!tr(c))return console.error("customTrayButton ".concat(s," should be a url.")),!1;var u=Go.id[s];if(!u)return console.error("customTrayButton does not support key ".concat(s)),!1;if(f(c)!==u)return console.error("customTrayButton ".concat(s," should be a ").concat(u,".")),!1}return!0}function is(e){if("object"!==f(e))throw new Error('RemoteMediaPlayerSettings: must be "object" type');if(!e.state||!Object.values(Ft).includes(e.state))throw new Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(Ft))}function as(e,t,r){return!("number"!=typeof e||e<t||e>r)}export default(function(t){h(i,e);var r=Do(i);function i(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o(this,i),t=r.call(this),g(s(t),"startListeningForDeviceChanges",function(){void 0!==navigator.mediaDevices.ondevicechange||Vt()?navigator.mediaDevices.addEventListener("devicechange",t.deviceChangeListener):t.startPollingForDeviceChanges()}),g(s(t),"stopListeningForDeviceChanges",function(){void 0!==navigator.mediaDevices.ondevicechange||Vt()?navigator.mediaDevices.removeEventListener("devicechange",t.deviceChangeListener):t.stopPollingForDeviceChanges()}),g(s(t),"deviceChangeListener",a(function*(){var e=yield t.enumerateDevices();t.handleDeviceChange(e.devices)})),g(s(t),"handleDeviceChange",function(e){t.emit(Ue,{action:Ue,availableDevices:e})}),g(s(t),"startPollingForDeviceChanges",function(){t._deviceChangeInterval||(t._deviceChangeInterval=setInterval(a(function*(){var e=yield t.enumerateDevices(),r=JSON.stringify(e);t._lastDevicesJSON&&r!==t._lastDevicesJSON&&t.handleDeviceChange(e.devices),t._lastDevicesJSON=r}),3e3))}),g(s(t),"stopPollingForDeviceChanges",function(){t._deviceChangeInterval&&(clearInterval(t._deviceChangeInterval),t._deviceChangeInterval=null,t._lastDevicesJSON=null)}),g(s(t),"handleNativeAppActiveStateChange",function(e){t.disableReactNativeAutoDeviceManagement("video")||(e?t.camUnmutedBeforeLosingNativeActiveState&&t.setLocalVideo(!0):(t.camUnmutedBeforeLosingNativeActiveState=t.localVideo(),t.camUnmutedBeforeLosingNativeActiveState&&t.setLocalVideo(!1)))}),g(s(t),"handleNativeAudioFocusChange",function(e){t.disableReactNativeAutoDeviceManagement("audio")||(t._hasNativeAudioFocus=e,t.toggleParticipantAudioBasedOnNativeAudioFocus(),t._hasNativeAudioFocus?t.micUnmutedBeforeLosingNativeAudioFocus&&t.setLocalAudio(!0):(t.micUnmutedBeforeLosingNativeAudioFocus=t.localAudio(),t.setLocalAudio(!1)))}),n.dailyJsVersion=i.version(),t._iframe=e,t._callObjectMode="none"===n.layout&&!t._iframe,t._preloadCache={subscribeToTracksAutomatically:!0,audioDeviceId:null,videoDeviceId:null,outputDeviceId:null},t._callObjectMode&&(window._dailyPreloadCache=t._preloadCache),void 0!==n.showLocalVideo?t._callObjectMode?console.error("showLocalVideo is not available in call object mode"):t._showLocalVideo=!!n.showLocalVideo:t._showLocalVideo=!0,void 0!==n.showParticipantsBar?t._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):t._showParticipantsBar=!!n.showParticipantsBar:t._showParticipantsBar=!0,void 0!==n.customEmbeds?t._callObjectMode?console.error("customEmbeds is not available in call object mode"):t._customEmbeds=n.customEmbeds:t._customEmbeds={},void 0!==n.customTrayButtons?t._callObjectMode?console.error("customTrayButtons is not available in call object mode"):t._customTrayButtons=n.customTrayButtons:t._customTrayButtons={},void 0!==n.activeSpeakerMode?t._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):t._activeSpeakerMode=!!n.activeSpeakerMode:t._activeSpeakerMode=!1,n.receiveSettings?t._callObjectMode?t._receiveSettings=n.receiveSettings:console.error("receiveSettings is only available in call object mode"):t._receiveSettings={},t._inputSettings={},n.inputSettings&&(t._inputSettings=n.inputSettings),t.validateProperties(n),t.properties=Bo({},n),t._callObjectLoader=t._callObjectMode?new fr:null,t._meetingState=ie,t._isPreparingToJoin=!1,t._accessState={access:me},t._nativeInCallAudioMode=Ro,t._participants={},t._participantCounts=Jo,t._rmpPlayerState={},t._waitingParticipants={},t._inputEventsOn={},t._network={threshold:"good",quality:100},t._activeSpeaker={},t._callFrameId=Zt(),t._messageChannel=Vt()?new cr:new or,t._iframe&&(t._iframe.requestFullscreen?t._iframe.addEventListener("fullscreenchange",function(e){document.fullscreenElement===t._iframe?(t.emit(bt,{action:bt}),t.sendMessageToCallMachine({action:bt})):(t.emit(wt,{action:wt}),t.sendMessageToCallMachine({action:wt}))}):t._iframe.webkitRequestFullscreen&&t._iframe.addEventListener("webkitfullscreenchange",function(e){document.webkitFullscreenElement===t._iframe?(t.emit(bt,{action:bt}),t.sendMessageToCallMachine({action:bt})):(t.emit(wt,{action:wt}),t.sendMessageToCallMachine({action:wt}))})),Vt()){var c=t.nativeUtils();c.addAudioFocusChangeListener&&c.removeAudioFocusChangeListener&&c.addAppActiveStateChangeListener&&c.removeAppActiveStateChangeListener||console.warn("expected (add|remove)(AudioFocus|AppActiveState)ChangeListener to be available in React Native"),t._hasNativeAudioFocus=!0,c.addAudioFocusChangeListener(t.handleNativeAudioFocusChange),c.addAppActiveStateChangeListener(t.handleNativeAppActiveStateChange)}return t._callObjectMode&&t.startListeningForDeviceChanges(),t._messageChannel.addListenerForMessagesFromCallMachine(t.handleMessageFromCallMachine,t._callFrameId,s(t)),t}return u(i,null,[{key:"supportedBrowser",value:function(){if(Vt())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!1,supportsSfu:!0,supportsVideoProcessing:!1};var e=class{static getParser(e,t=!1){if("string"!=typeof e)throw new Error("UserAgent should be a string");return new ne(e,t)}static parse(e){return new ne(e).getResult()}static get BROWSER_MAP(){return H}static get ENGINE_MAP(){return $}static get OS_MAP(){return Q}static get PLATFORMS_MAP(){return K}}.getParser(Rt());return{supported:!!Gt(),mobile:"mobile"===e.getPlatformType(),name:e.getBrowserName(),version:e.getBrowserVersion(),supportsFullscreen:!!zt(),supportsScreenShare:!!Jt(),supportsSfu:!!Gt(),supportsVideoProcessing:Wt()}}},{key:"version",value:function(){return"0.30.0"}},{key:"createCallObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.layout="none",new i(null,e)}},{key:"wrap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if($o(),!e||!e.contentWindow||"string"!=typeof e.src)throw new Error("DailyIframe::Wrap needs an iframe-like first argument");return t.layout||(t.customLayout?t.layout="custom-v1":t.layout="browser"),new i(e,t)}},{key:"createFrame",value:function(e,t){var r,n;$o(),e&&t?(r=e,n=t):e&&e.append?(r=e,n={}):(r=document.body,n=e||{});var a=n.iframeStyle;a||(a=r===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var o=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?o.allow="microphone, camera":o.allow="microphone; camera; autoplay; display-capture",o.style.visibility="hidden",r.appendChild(o),o.style.visibility=null,Object.keys(a).forEach(function(e){return o.style[e]=a[e]}),n.layout||(n.customLayout?n.layout="custom-v1":n.layout="browser");try{return new i(o,n)}catch(e){throw r.removeChild(o),e}}},{key:"createTransparentFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$o();var t=document.createElement("iframe");return t.allow="microphone; camera; autoplay",t.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border: 0;\n      pointer-events: none;\n    ",document.body.appendChild(t),e.layout||(e.layout="custom-v1"),i.wrap(t,e)}}]),u(i,[{key:"destroy",value:function(){var e=a(function*(){try{[se,ae].includes(this._meetingState)&&(yield this.leave())}catch(e){}var e=this._iframe;if(e){var t=e.parentElement;t&&t.removeChild(e)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),Vt()){var r=this.nativeUtils();r.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),r.removeAppActiveStateChangeListener(this.handleNativeAppActiveStateChange)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars()});return function(){return e.apply(this,arguments)}}()},{key:"loadCss",value:function(e){var t=e.bodyClass,r=e.cssFile,n=e.cssText;return $o(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(r),bodyClass:t,cssText:n}),this}},{key:"iframe",value:function(){return $o(),this._iframe}},{key:"meetingState",value:function(){return this._meetingState}},{key:"accessState",value:function(){if(!this._callObjectMode)throw new Error("accessState() currently only supported in call object mode");return this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){if(!this._callObjectMode)throw new Error("waitingParticipants() currently only supported in call object mode");return this._waitingParticipants}},{key:"validateParticipantProperties",value:function(e,t){for(var r in t){if(!Ko[r])throw new Error("unrecognized updateParticipant property ".concat(r));if(Ko[r].validate&&!Ko[r].validate(t[r],this,this._participants[e]))throw new Error(Ko[r].help)}}},{key:"updateParticipant",value:function(e,t){return this._participants.local&&this._participants.local.session_id===e&&(e="local"),e&&t&&(this.validateParticipantProperties(e,t),this.sendMessageToCallMachine({action:"update-participant",id:e,properties:t})),this}},{key:"updateParticipants",value:function(e){var t=this._participants.local&&this._participants.local.session_id;for(var r in e)r===t&&(r="local"),r&&e[r]&&this.validateParticipantProperties(r,e[r]);return this.sendMessageToCallMachine({action:"update-participants",participants:e}),this}},{key:"updateWaitingParticipant",value:function(){var e=a(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._callObjectMode)throw new Error("updateWaitingParticipant() currently only supported in call object mode");if(this._meetingState!==se)throw new Error("updateWaitingParticipant() only supported for joined meetings");if("string"!=typeof t||"object"!==f(r))throw new Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise(function(n,i){e.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:t,updates:r},function(e){e.error&&i(e.error),e.id||i(new Error("unknown error in updateWaitingParticipant()")),n({id:e.id})})})});return function(){return e.apply(this,arguments)}}()},{key:"updateWaitingParticipants",value:function(){var e=a(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this._callObjectMode)throw new Error("updateWaitingParticipants() currently only supported in call object mode");if(this._meetingState!==se)throw new Error("updateWaitingParticipants() only supported for joined meetings");if("object"!==f(t))throw new Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise(function(r,n){e.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:t},function(e){e.error&&n(e.error),e.ids||n(new Error("unknown error in updateWaitingParticipants()")),r({ids:e.ids})})})});return function(){return e.apply(this,arguments)}}()},{key:"requestAccess",value:function(){var e=a(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.access,n=void 0===r?{level:"full"}:r,i=t.name,a=void 0===i?"":i;if(!this._callObjectMode)throw new Error("requestAccess() currently only supported in call object mode");if(this._meetingState!==se)throw new Error("requestAccess() only supported for joined meetings");return new Promise(function(t,r){e.sendMessageToCallMachine({action:"daily-method-request-access",access:n,name:a},function(e){e.error&&r(e.error),e.access||r(new Error("unknown error in requestAccess()")),t({access:e.access,granted:e.granted})})})});return function(){return e.apply(this,arguments)}}()},{key:"localAudio",value:function(){return this._participants.local?this._participants.local.audio:null}},{key:"localVideo",value:function(){return this._participants.local?this._participants.local.video:null}},{key:"setLocalAudio",value:function(e){return this.sendMessageToCallMachine({action:"local-audio",state:e}),this}},{key:"setLocalVideo",value:function(e){return this.sendMessageToCallMachine({action:"local-video",state:e}),this}},{key:"getReceiveSettings",value:function(){var e=a(function*(e){var t=this,r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).showInheritedValues,n=void 0!==r&&r;if(!this._callObjectMode)throw new Error("getReceiveSettings() only supported in call object mode");switch(f(e)){case"string":return new Promise(function(r){t.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:e,showInheritedValues:n},function(e){r(e.receiveSettings)})});case"undefined":return this._receiveSettings;default:throw new Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}});return function(t){return e.apply(this,arguments)}}()},{key:"updateReceiveSettings",value:function(){var e=a(function*(e){var t=this;if(!this._callObjectMode)throw new Error("updateReceiveSettings() only supported in call object mode");if(!Xo(e,{allowAllParticipantsKey:!0}))throw new Error(rs({allowAllParticipantsKey:!0}));if(this._meetingState!==se)throw new Error("updateReceiveSettings() is only allowed when joined. To specify receive settings earlier, use the receiveSettings config property.");return new Promise(function(r){t.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:e},function(e){r({receiveSettings:e.receiveSettings})})})});return function(t){return e.apply(this,arguments)}}()},{key:"getInputSettings",value:function(){var e=this;return new Promise(function(t){t(e._inputSettings)})}},{key:"updateInputSettings",value:function(){var e=a(function*(e){var t=this;return new Promise(function(r,n){if(!es(e))return console.error(ts()),void n(ts());t.sendMessageToCallMachine({action:"update-input-settings",inputSettings:e},function(e){e.error?n(e.error):r({inputSettings:e.inputSettings})})})});return function(t){return e.apply(this,arguments)}}()},{key:"setBandwidth",value:function(e){var t=e.kbs,r=e.trackConstraints;return $o(),this.sendMessageToCallMachine({action:"set-bandwidth",kbs:t,trackConstraints:r}),this}},{key:"getDailyLang",value:function(){var e=this;return $o(),new Promise(function(){var t=a(function*(t){e.sendMessageToCallMachine({action:"get-daily-lang"},function(e){delete e.action,delete e.callbackStamp,t(e)})});return function(e){return t.apply(this,arguments)}}())}},{key:"setDailyLang",value:function(e){return $o(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:e}),this}},{key:"getMeetingSession",value:function(){var e=a(function*(){var e=this;if(this._meetingState!==se)throw new Error("getMeetingSession() is only allowed when joined");return new Promise(function(){var t=a(function*(t){e.sendMessageToCallMachine({action:"get-meeting-session"},function(e){delete e.action,delete e.callbackStamp,delete e.callFrameId,t(e)})});return function(e){return t.apply(this,arguments)}}())});return function(){return e.apply(this,arguments)}}()},{key:"setUserName",value:function(e,t){var r=this;return this.properties.userName=e,new Promise(function(){var n=a(function*(n){r.sendMessageToCallMachine({action:"set-user-name",name:null!=e?e:"",thisMeetingOnly:Vt()||!!t&&!!t.thisMeetingOnly},function(e){delete e.action,delete e.callbackStamp,n(e)})});return function(e){return n.apply(this,arguments)}}())}},{key:"setUserData",value:function(){var e=a(function*(e){var t=this;try{Zo(e)}catch(e){throw console.error(e),e}return this.properties.userData=e,new Promise(function(r){t.sendMessageToCallMachine({action:"set-user-data",userData:e},function(e){delete e.action,delete e.callbackStamp,delete e.callFrameId,r(e)})})});return function(t){return e.apply(this,arguments)}}()},{key:"startCamera",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this._callObjectMode)throw new Error("startCamera() currently only supported in call object mode");if([oe,se].includes(this._meetingState))throw new Error("startCamera() not supported after joining a meeting: did you mean to use setLocalAudio() and/or setLocalVideo() instead?");return new Promise(function(){var r=a(function*(r,n){if(e.needsLoad())try{yield e.load(t)}catch(e){n(e)}else e.validateProperties(t);e.sendMessageToCallMachine({action:"start-camera",properties:Qo(e.properties),preloadCache:Qo(e._preloadCache)},function(e){delete e.action,delete e.callbackStamp,r(e)})});return function(e,t){return r.apply(this,arguments)}}())}},{key:"setCamera",value:function(e){var t=this;if(Yo(),this.needsLoad())throw new Error("Before you can invoke setCamera, first you need to invoke one of these methods: join, startCamera, or preAuth");return new Promise(function(r,n){t.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:e},function(e){r({device:e.device})})})}},{key:"setAudioDevice",value:function(){var e=a(function*(e){return Yo(),this.nativeUtils().setAudioDevice(e),{deviceId:yield this.nativeUtils().getAudioDevice()}});return function(t){return e.apply(this,arguments)}}()},{key:"cycleCamera",value:function(){var e=this;return new Promise(function(t,r){e.sendMessageToCallMachine({action:"cycle-camera"},function(e){t({device:e.device})})})}},{key:"cycleMic",value:function(){var e=this;return $o(),new Promise(function(t,r){e.sendMessageToCallMachine({action:"cycle-mic"},function(e){t({device:e.device})})})}},{key:"getCameraFacingMode",value:function(){var e=this;return Yo(),new Promise(function(t,r){e.sendMessageToCallMachine({action:"get-camera-facing-mode"},function(e){t(e.facingMode)})})}},{key:"setInputDevices",value:function(e){var t=e.audioDeviceId,r=e.videoDeviceId,n=e.audioSource,i=e.videoSource;return console.warn("setInputDevices() is deprecated: instead use setInputDevicesAsync(), which returns a Promise"),this.setInputDevicesAsync({audioDeviceId:t,videoDeviceId:r,audioSource:n,videoSource:i}),this}},{key:"setInputDevicesAsync",value:function(){var e=a(function*(e){var t=this,r=e.audioDeviceId,n=e.videoDeviceId,i=e.audioSource,a=e.videoSource;return $o(),void 0!==i&&(r=i),void 0!==a&&(n=a),r&&(this._preloadCache.audioDeviceId=r),n&&(this._preloadCache.videoDeviceId=n),this._callObjectMode&&this.needsLoad()?{camera:{deviceId:this._preloadCache.videoDeviceId},mic:{deviceId:this._preloadCache.audioDeviceId},speaker:{deviceId:this._preloadCache.outputDeviceId}}:(r instanceof MediaStreamTrack&&(r=At),n instanceof MediaStreamTrack&&(n=At),new Promise(function(e){t.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:r,videoDeviceId:n},function(r){delete r.action,delete r.callbackStamp,r.returnPreloadCache?e({camera:{deviceId:t._preloadCache.videoDeviceId},mic:{deviceId:t._preloadCache.audioDeviceId},speaker:{deviceId:t._preloadCache.outputDeviceId}}):e(r)})}))});return function(t){return e.apply(this,arguments)}}()},{key:"setOutputDevice",value:function(e){var t=e.outputDeviceId;return console.warn("setOutputDevice() is deprecated: instead use setOutputDeviceAsync(), which returns a Promise"),this.setOutputDeviceAsync({outputDeviceId:t}),this}},{key:"setOutputDeviceAsync",value:function(){var e=a(function*(e){var t=this,r=e.outputDeviceId;return $o(),r&&(this._preloadCache.outputDeviceId=r),this._callObjectMode&&this.needsLoad()?{camera:{deviceId:this._preloadCache.videoDeviceId},mic:{deviceId:this._preloadCache.audioDeviceId},speaker:{deviceId:this._preloadCache.outputDeviceId}}:new Promise(function(e){t.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:r},function(r){delete r.action,delete r.callbackStamp,r.returnPreloadCache?e({camera:{deviceId:t._preloadCache.videoDeviceId},mic:{deviceId:t._preloadCache.audioDeviceId},speaker:{deviceId:t._preloadCache.outputDeviceId}}):e(r)})})});return function(t){return e.apply(this,arguments)}}()},{key:"getInputDevices",value:function(){var e=a(function*(){var e=this;return this._callObjectMode&&this.needsLoad()?{camera:{deviceId:this._preloadCache.videoDeviceId},mic:{deviceId:this._preloadCache.audioDeviceId},speaker:{deviceId:this._preloadCache.outputDeviceId}}:new Promise(function(t,r){e.sendMessageToCallMachine({action:"get-input-devices"},function(r){delete r.action,delete r.callbackStamp,r.returnPreloadCache?t({camera:{deviceId:e._preloadCache.videoDeviceId},mic:{deviceId:e._preloadCache.audioDeviceId},speaker:{deviceId:e._preloadCache.outputDeviceId}}):t(r)})})});return function(){return e.apply(this,arguments)}}()},{key:"nativeInCallAudioMode",value:function(){return Yo(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(e){if(Yo(),[Ro,Vo].includes(e)){if(e!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=e,!this.disableReactNativeAutoDeviceManagement("audio")&&this.isMeetingPendingOrOngoing(this._meetingState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",e)}},{key:"preAuth",value:function(){var e=a(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this._callObjectMode)throw new Error("preAuth() currently only supported in call object mode");if([oe,se].includes(this._meetingState))throw new Error("preAuth() not supported after joining a meeting");if(this.needsLoad()&&(yield this.load(t)),!t.url)throw new Error("preAuth() requires at least a url to be provided");var r=er(t.url),n=er(this.properties.url||this.properties.baseUrl);if(r!==n)throw new Error("url in preAuth() has a different bundle url than the one loaded (".concat(n," -> ").concat(r,")"));return this.validateProperties(t),this.properties=Bo(Bo({},this.properties),t),new Promise(function(t,r){e.sendMessageToCallMachine({action:"daily-method-preauth",properties:Qo(e.properties)},function(n){return n.error?r(n.error):n.access?(e._didPreAuth=!0,void t({access:n.access})):r(new Error("unknown error in preAuth()"))})})});return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=a(function*(e){var t=this;if(this.needsLoad()){if(e&&(this.validateProperties(e),this.properties=Bo(Bo({},this.properties),e)),!this._callObjectMode&&!this.properties.url)throw new Error("can't load iframe meeting because url property isn't set");this.updateMeetingState(ae);try{this.emit("loading",{action:"loading"})}catch(e){console.log("could not emit 'loading'",e)}return this._callObjectMode?new Promise(function(e,r){t._callObjectLoader.cancel(),t._callObjectLoader.load(t.properties.url||t.properties.baseUrl,t._callFrameId,t.properties.dailyConfig&&t.properties.dailyConfig.avoidEval,function(r){t.updateMeetingState("loaded"),r&&t.emit("loaded",{action:"loaded"}),e()},function(e,n){t.emit("load-attempt-failed",{action:"load-attempt-failed",errorMsg:e}),n||(t.updateMeetingState(ue),t.resetMeetingDependentVars(),t.emit("error",{action:"error",errorMsg:e}),r(e))})}):(this._iframe.src=this.assembleMeetingUrl(),new Promise(function(e,r){t._loadedCallback=function(n){if(t._meetingState!==ue){for(var i in t.updateMeetingState("loaded"),(t.properties.cssFile||t.properties.cssText)&&t.loadCss(t.properties),t._inputEventsOn)t.sendMessageToCallMachine({action:"register-input-handler",on:i});e()}else r(n)}}))}});return function(t){return e.apply(this,arguments)}}()},{key:"join",value:function(){var e=a(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(t)}catch(e){return this.updateIsPreparingToJoin(!1),Promise.reject(e)}}else{if(r=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(t.url&&t.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(t.token&&t.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(t.url)if(this._callObjectMode){var n=er(t.url),i=er(this.properties.url||this.properties.baseUrl);if(n!==i)return console.error("url in join() has a different bundle url than the one loaded (".concat(i," -> ").concat(n,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.properties.url=t.url}else if(t.url&&t.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(t.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(t),this.properties=Bo(Bo({},this.properties),t)}if(void 0!==t.showLocalVideo&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!t.showLocalVideo),void 0!==t.showParticipantsBar&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!t.showParticipantsBar),this._meetingState===se||this._meetingState===oe)return console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1);this.updateMeetingState(oe,!1);try{this.emit("joining-meeting",{action:"joining-meeting"})}catch(e){console.log("could not emit 'joining-meeting'",e)}return this.sendMessageToCallMachine({action:"join-meeting",properties:Qo(this.properties),preloadCache:Qo(this._preloadCache)}),new Promise(function(t,n){e._joinedCallback=function(i,a){if(e._meetingState!==ue){if(e.updateMeetingState(se),i)for(var o in i)e._callObjectMode&&(Ao(i[o]),Eo(i[o]),Io(i[o],e._participants[o])),e._participants[o]=Bo({},i[o]),e.toggleParticipantAudioBasedOnNativeAudioFocus();r&&e.loadCss(e.properties),t(i)}else n(a)}})});return function(){return e.apply(this,arguments)}}()},{key:"leave",value:function(){var e=a(function*(){var e=this;return new Promise(function(t,r){if(e._callObjectLoader&&!e._callObjectLoader.loaded){e._callObjectLoader.cancel(),e.updateMeetingState(ce),e.resetMeetingDependentVars();try{e.emit(ce,{action:ce})}catch(e){console.log("could not emit 'left-meeting'",e)}t()}else e._meetingState===ce||e._meetingState===ue?t():(e._leftCallback=function(){e._meetingState!==ue&&e.updateMeetingState(ce),e.resetMeetingDependentVars(),t()},e.sendMessageToCallMachine({action:"leave-meeting"}))})});return function(){return e.apply(this,arguments)}}()},{key:"startScreenShare",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$o(),e.mediaStream&&(this._preloadCache.screenMediaStream=e.mediaStream,e.mediaStream=At),this.sendMessageToCallMachine({action:"local-screen-start",captureOptions:e})}},{key:"stopScreenShare",value:function(){$o(),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendMessageToCallMachine(Bo({action:"local-recording-start"},e))}},{key:"updateRecording",value:function(e){var t=e.layout,r=void 0===t?{preset:"default"}:t,n=e.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:r,instanceId:n})}},{key:"stopRecording",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendMessageToCallMachine(Bo({action:"local-recording-stop"},e))}},{key:"startLiveStreaming",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendMessageToCallMachine(Bo({action:"daily-method-start-live-streaming"},e))}},{key:"updateLiveStreaming",value:function(e){var t=e.layout,r=void 0===t?{preset:"default"}:t,n=e.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:r,instanceId:n})}},{key:"addLiveStreamingEndpoints",value:function(e){var t=e.endpoints,r=e.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming-endpoints",endpointsOp:xt,endpoints:t,instanceId:r})}},{key:"removeLiveStreamingEndpoints",value:function(e){var t=e.endpoints,r=e.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming-endpoints",endpointsOp:Nt,endpoints:t,instanceId:r})}},{key:"stopLiveStreaming",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendMessageToCallMachine(Bo({action:"daily-method-stop-live-streaming"},e))}},{key:"startRemoteMediaPlayer",value:function(){var e=a(function*(e){var t=this,r=e.url,n=e.settings,i=void 0===n?{state:Ft.PLAY}:n;try{!function(e){if("string"!=typeof e)throw new Error('url parameter must be "string" type')}(r),is(i),function(e){for(var t in e)if(!qo.includes(t))throw new Error("Invalid key ".concat(t,", valid keys are: ").concat(qo));if(e.simulcastEncodings){if(!(e.simulcastEncodings instanceof Array))throw new Error('simulcastEncodings must be "Array"');if(!as(e.simulcastEncodings.length,0,Uo))throw new Error('"simulcastEncodings" not in range. valid range 1 to 3 layers');e.simulcastEncodings.every(function(e){for(var t in e){if(!zo.hasOwnProperty(t))throw new Error("Invalid key ".concat(t,", valid keys are:")+Object.keys(zo));if("number"!=typeof e[t])throw new Error("simulcastEncodings[].".concat(t,' must be "number"'));var r=zo[t],n=r.min,i=r.max;if(!as(e[t],n,i))throw new Error("simulcastEncodings[].".concat(t," value not in range. valid range:        ").concat(n," to ").concat(i))}if(!e.hasOwnProperty("maxBitrate"))throw new Error("simulcastEncodings[].maxBitrate is not specified")})}}(i)}catch(e){throw console.error("invalid argument Error: ".concat(e)),console.error('startRemoteMediaPlayer arguments must be of the form: \n  { url: "playback url", \n  settings?: \n  {state: "play"|"pause", simulcastEncodings?: [{}] } }'),e}return new Promise(function(){var e=a(function*(e,n){t.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:r,settings:i},function(t){t.error?n({error:t.error,errorMsg:t.errorMsg}):e({session_id:t.session_id,remoteMediaPlayerState:{state:t.state,settings:t.settings}})})});return function(t,r){return e.apply(this,arguments)}}())});return function(t){return e.apply(this,arguments)}}()},{key:"stopRemoteMediaPlayer",value:function(){var e=a(function*(e){var t=this;if("string"!=typeof e)throw new Error(" remotePlayerID must be of type string");return new Promise(function(){var r=a(function*(r,n){t.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:e},function(e){e.error?n({error:e.error,errorMsg:e.errorMsg}):r()})});return function(e,t){return r.apply(this,arguments)}}())});return function(t){return e.apply(this,arguments)}}()},{key:"updateRemoteMediaPlayer",value:function(){var e=a(function*(e){var t=this,r=e.session_id,n=e.settings;try{is(n)}catch(e){throw console.error("invalid argument Error: ".concat(e)),console.error('updateRemoteMediaPlayer arguments must be of the form: \n  session_id: "participant session", \n  { settings?: {state: "play"|"pause"} }'),e}return new Promise(function(){var e=a(function*(e,i){t.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:r,settings:n},function(t){t.error?i({error:t.error,errorMsg:t.errorMsg}):e({session_id:t.session_id,remoteMediaPlayerState:{state:t.state,settings:t.settings}})})});return function(t,r){return e.apply(this,arguments)}}())});return function(t){return e.apply(this,arguments)}}()},{key:"startTranscription",value:function(e){this.sendMessageToCallMachine(Bo({action:"daily-method-start-transcription"},e))}},{key:"stopTranscription",value:function(){this.sendMessageToCallMachine({action:"daily-method-stop-transcription"})}},{key:"getNetworkStats",value:function(){var e=this;if(this._meetingState!==se){return{stats:{latest:{}}}}return new Promise(function(t,r){e.sendMessageToCallMachine({action:"get-calc-stats"},function(r){t(Bo({stats:r.stats},e._network))})})}},{key:"getActiveSpeaker",value:function(){return $o(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(e){return $o(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:e}),this}},{key:"activeSpeakerMode",value:function(){return $o(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(e){if(this._meetingState!==se)throw new Error("setSubscribeToTracksAutomatically() is only allowed when joined");return this._preloadCache.subscribeToTracksAutomatically=e,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:e}),this}},{key:"enumerateDevices",value:function(){var e=a(function*(){var e=this;return this._callObjectMode?{devices:(yield navigator.mediaDevices.enumerateDevices()).map(function(e){return JSON.parse(JSON.stringify(e))})}:new Promise(function(t,r){e.sendMessageToCallMachine({action:"enumerate-devices"},function(e){t({devices:e.devices})})})});return function(){return e.apply(this,arguments)}}()},{key:"sendAppMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*";if(JSON.stringify(e).length>4096)throw new Error("Message data too large. Max size is 4096");return this.sendMessageToCallMachine({action:"app-msg",data:e,to:t}),this}},{key:"addFakeParticipant",value:function(e){return $o(),this.sendMessageToCallMachine(Bo({action:"add-fake-participant"},e)),this}},{key:"setShowNamesMode",value:function(e){return $o(),e&&"always"!==e&&"never"!==e?(console.error('setShowNamesMode argument should be "always", "never", or false'),this):(this.sendMessageToCallMachine({action:"set-show-names",mode:e}),this)}},{key:"setShowLocalVideo",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return $o(),"boolean"!=typeof e?(console.error("setShowLocalVideo only accepts a boolean value"),this):this._callObjectMode?(console.error("setShowLocalVideo is not available in callObject mode"),this):this._meetingState!==se?(console.error("the meeting must be joined before calling setShowLocalVideo"),this):(this.sendMessageToCallMachine({action:"set-show-local-video",show:e}),this._showLocalVideo=e,this)}},{key:"showLocalVideo",value:function(){return $o(),this._callObjectMode?(console.error("showLocalVideo is not available in callObject mode"),this):this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return $o(),"boolean"!=typeof e?(console.error("setShowParticipantsBar only accepts a boolean value"),this):this._callObjectMode?(console.error("setShowParticipantsBar is not available in callObject mode"),this):this._meetingState!==se?(console.error("the meeting must be joined before calling setShowParticipantsBar"),this):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:e}),this._showParticipantsBar=e,this)}},{key:"showParticipantsBar",value:function(){return $o(),this._callObjectMode?(console.error("showParticipantsBar is not available in callObject mode"),this):this._showParticipantsBar}},{key:"customEmbeds",value:function(){return $o(),this._callObjectMode?(console.error("customEmbeds is not available in callObject mode"),this):this._customEmbeds}},{key:"updateCustomEmbeds",value:function(e){return $o(),this._callObjectMode?(console.error("updateCustomEmbeds is not available in callObject mode"),this):this._meetingState!==se?(console.error("the meeting must be joined before calling updateCustomEmbeds"),this):(this.sendMessageToCallMachine({action:"update-custom-embeds",embeds:e}),this._customEmbeds=e,this)}},{key:"customTrayButtons",value:function(){return $o(),this._callObjectMode?(console.error("customTrayButtons is not available in callObject mode"),this):this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(e){return $o(),this._callObjectMode?(console.error("updateCustomTrayButtons is not available in callObject mode"),this):this._meetingState!==se?(console.error("the meeting must be joined before calling updateCustomTrayButtons"),this):ns(e)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:e}),this._customTrayButtons=e,this):(console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(Go))),this)}},{key:"theme",value:function(){return this._callObjectMode?(console.error("theme is not available in callObject mode"),this):this.properties.theme}},{key:"setTheme",value:function(e){var t=this;return new Promise(function(r,n){if(t._callObjectMode)n("setTheme is not available in callObject mode");else try{t.validateProperties({theme:e}),t.properties.theme=Bo({},e),t.sendMessageToCallMachine({action:"set-theme",theme:t.properties.theme});try{t.emit("theme-updated",{action:"theme-updated",theme:t.properties.theme})}catch(e){console.log("could not emit 'theme-updated'",e)}r(t.properties.theme)}catch(e){n(e)}})}},{key:"detectAllFaces",value:function(){var e=this;return $o(),new Promise(function(t,r){e.sendMessageToCallMachine({action:"detect-all-faces"},function(e){delete e.action,delete e.callbackStamp,t(e)})})}},{key:"requestFullscreen",value:function(){var e=a(function*(){if($o(),this._iframe&&!document.fullscreenElement&&zt())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(e){console.log("could not make video call fullscreen",e)}});return function(){return e.apply(this,arguments)}}()},{key:"exitFullscreen",value:function(){$o(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"room",value:function(){var e=a(function*(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeRoomConfigDefaults,r=void 0===t||t;return this._accessState.access===me||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise(function(t,n){e.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:r},function(e){delete e.action,delete e.callbackStamp,t(e)})})});return function(){return e.apply(this,arguments)}}()},{key:"geo",value:function(){var e=a(function*(){return new Promise(function(){var e=a(function*(e,t){try{var r=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");e({current:(yield r.json()).geo})}catch(t){console.error("geo lookup failed",t),e({current:""})}});return function(t,r){return e.apply(this,arguments)}}())});return function(){return e.apply(this,arguments)}}()},{key:"setNetworkTopology",value:function(){var e=a(function*(e){var t=this;return $o(),new Promise(function(){var r=a(function*(r,n){t.sendMessageToCallMachine({action:"set-network-topology",opts:e},function(e){e.error?n({error:e.error}):r({workerId:e.workerId})})});return function(e,t){return r.apply(this,arguments)}}())});return function(t){return e.apply(this,arguments)}}()},{key:"getNetworkTopology",value:function(){var e=a(function*(){var e=this;return new Promise(function(){var t=a(function*(t,r){e.sendMessageToCallMachine({action:"get-network-topology"},function(e){e.error?r({error:e.error}):t({topology:e.topology})})});return function(e,r){return t.apply(this,arguments)}}())});return function(){return e.apply(this,arguments)}}()},{key:"setPlayNewParticipantSound",value:function(e){if($o(),"number"!=typeof e&&!0!==e&&!1!==e)throw new Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(e));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:e})}},{key:"on",value:function(t,r){return this._inputEventsOn[t]={},this.sendMessageToCallMachine({action:"register-input-handler",on:t}),e.prototype.on.call(this,t,r)}},{key:"once",value:function(t,r){return this._inputEventsOn[t]={},this.sendMessageToCallMachine({action:"register-input-handler",on:t}),e.prototype.once.call(this,t,r)}},{key:"off",value:function(t,r){return delete this._inputEventsOn[t],this.sendMessageToCallMachine({action:"register-input-handler",off:t}),e.prototype.off.call(this,t,r)}},{key:"validateProperties",value:function(e){for(var t in e){if(!Ho[t])throw new Error("unrecognized property '".concat(t,"'"));if(Ho[t].validate&&!Ho[t].validate(e[t],this))throw new Error("property '".concat(t,"': ").concat(Ho[t].help))}}},{key:"assembleMeetingUrl",value:function(){var e=Bo(Bo({},this.properties),{},{emb:this._callFrameId,embHref:encodeURIComponent(window.location.href)}),t=e.url.match(/\?/)?"&":"?";return e.url+t+Object.keys(Ho).filter(function(t){return Ho[t].queryString&&void 0!==e[t]}).map(function(t){return"".concat(Ho[t].queryString,"=").concat(e[t])}).join("&")}},{key:"needsLoad",value:function(){return[ie,ae,ce,ue].includes(this._meetingState)}},{key:"sendMessageToCallMachine",value:function(e,t){this._messageChannel.sendMessageToCallMachine(e,t,this._iframe,this._callFrameId)}},{key:"forwardPackagedMessageToCallMachine",value:function(e){this._messageChannel.forwardPackagedMessageToCallMachine(e,this._iframe,this._callFrameId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(e,this._callFrameId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(e)}},{key:"handleMessageFromCallMachine",value:function(e){switch(e.action){case"iframe-ready-for-launch-config":this.sendMessageToCallMachine(Bo({action:"iframe-launch-config"},this.properties));break;case"loaded":this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null);try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}break;case"joined-meeting":this._joinedCallback&&(this._joinedCallback(e.participants),this._joinedCallback=null);try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}break;case"participant-joined":case"participant-updated":if(this._meetingState===ce)return;if(e.participant&&e.participant.session_id){var t=e.participant.local?"local":e.participant.session_id;this._callObjectMode&&(Ao(e.participant),Eo(e.participant),Io(e.participant,this._participants[t]));try{this.maybeEventTrackStopped(this._participants[t],e.participant,"audioTrack"),this.maybeEventTrackStopped(this._participants[t],e.participant,"videoTrack"),this.maybeEventTrackStopped(this._participants[t],e.participant,"screenVideoTrack"),this.maybeEventTrackStopped(this._participants[t],e.participant,"screenAudioTrack"),this.maybeEventTrackStarted(this._participants[t],e.participant,"audioTrack"),this.maybeEventTrackStarted(this._participants[t],e.participant,"videoTrack"),this.maybeEventTrackStarted(this._participants[t],e.participant,"screenVideoTrack"),this.maybeEventTrackStarted(this._participants[t],e.participant,"screenAudioTrack"),this.maybeEventTrackStoppedForCustomTracks(this._participants[t],e.participant),this.maybeEventTrackStartedForCustomTracks(this._participants[t],e.participant),this.maybeEventRecordingStopped(this._participants[t],e.participant),this.maybeEventRecordingStarted(this._participants[t],e.participant)}catch(e){console.error("track events error",e)}if(!this.compareEqualForParticipantUpdateEvent(e.participant,this._participants[t])){this._participants[t]=Bo({},e.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus();try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}}}break;case"participant-left":if(e.participant&&e.participant.session_id){var r=this._participants[e.participant.session_id];r&&(this.maybeEventTrackStopped(r,null,"audioTrack"),this.maybeEventTrackStopped(r,null,"videoTrack"),this.maybeEventTrackStopped(r,null,"screenVideoTrack"),this.maybeEventTrackStopped(r,null,"screenAudioTrack"),this.maybeEventTrackStoppedForCustomTracks(r,null)),delete this._participants[e.participant.session_id];try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}}break;case"participant-counts-updated":if(!W(this._participantCounts,e.participantCounts)){this._participantCounts=e.participantCounts;try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}}break;case"access-state-updated":var i={access:e.access};if(e.awaitingAccess&&(i.awaitingAccess=e.awaitingAccess),!W(this._accessState,i)){this._accessState=i;try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}}break;case"meeting-session-updated":if(e.meetingSession)try{delete e.callFrameId,this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}break;case"error":this._iframe&&!e.preserveIframe&&(this._iframe.src=""),this.updateMeetingState(ue),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(e.errorMsg),this._loadedCallback=null),this._joinedCallback&&(this._joinedCallback(null,e.errorMsg),this._joinedCallback=null);try{e.preserveIframe;var a=n(e,["preserveIframe"]);this.emit(e.action,a)}catch(t){console.log("could not emit",e,t)}break;case"left-meeting":this._leftCallback&&(this._leftCallback(),this._leftCallback=null);try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}break;case"input-event":var o=this._participants[e.session_id];o||(o=e.session_id===this._participants.local.session_id?this._participants.local:{});try{this.emit(e.event.type,{action:e.event.type,event:e.event,participant:Bo({},o)})}catch(t){console.log("could not emit",e,t)}break;case"selected-devices-updated":if(e.devices)try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}break;case"network-quality-change":var s=e.threshold,c=e.quality;if(s!==this._network.threshold||c!==this._network.quality){this._network.quality=c,this._network.threshold=s;try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}}break;case"active-speaker-change":var u=e.activeSpeaker;if(this._activeSpeaker.peerId!==u.peerId){this._activeSpeaker.peerId=u.peerId;try{this.emit(e.action,{action:e.action,activeSpeaker:this._activeSpeaker})}catch(t){console.log("could not emit",e,t)}}break;case"show-local-video-changed":if(this._callObjectMode)return;var l=e.show;this._showLocalVideo=l;try{this.emit(e.action,{action:e.action,show:l})}catch(t){console.log("could not emit",e,t)}break;case"active-speaker-mode-change":var d=e.enabled;if(this._activeSpeakerMode!==d){this._activeSpeakerMode=d;try{this.emit(e.action,{action:e.action,enabled:this._activeSpeakerMode})}catch(t){console.log("could not emit",e,t)}}break;case"waiting-participant-added":case"waiting-participant-updated":case"waiting-participant-removed":this._waitingParticipants=e.allWaitingParticipants;try{this.emit(e.action,{action:e.action,participant:e.participant})}catch(t){console.log("could not emit",e,t)}break;case"receive-settings-updated":if(!W(this._receiveSettings,e.receiveSettings)){this._receiveSettings=e.receiveSettings;try{this.emit(e.action,{action:e.action,receiveSettings:e.receiveSettings})}catch(t){console.log("could not emit",e,t)}}break;case"input-settings-updated":if(!W(this._inputSettings,e.inputSettings)){this._inputSettings=e.inputSettings;try{this.emit(e.action,{action:e.action,inputSettings:e.inputSettings})}catch(t){console.log("could not emit",e,t)}}break;case"remote-media-player-started":var p=e.session_id;this._rmpPlayerState[p]=e.playerState,this.emitDailyJSEvent(e);break;case"remote-media-player-stopped":delete this._rmpPlayerState[e.session_id],this.emitDailyJSEvent(e);break;case"remote-media-player-updated":var h=e.session_id,f=this._rmpPlayerState[h];f&&this.compareEqualForRMPUpdateEvent(f,e.remoteMediaPlayerState)||(this._rmpPlayerState[h]=e.remoteMediaPlayerState,this.emitDailyJSEvent(e));break;case"custom-button-click":this.emitDailyJSEvent(e);break;case"recording-started":case"recording-stopped":case"recording-stats":case"recording-error":case"recording-upload-completed":case"transcription-started":case"transcription-stopped":case"transcription-error":case"started-camera":case"camera-error":case"app-message":case"local-screen-share-started":case"local-screen-share-stopped":case"network-connection":case"recording-data":case"live-streaming-started":case"live-streaming-stopped":case"live-streaming-error":case"nonfatal-error":case"lang-updated":try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(e,t){var r="record";if(e&&!t.local&&!1===t[r]&&e[r]!==t[r])try{this.emit("recording-stopped",{action:"recording-stopped"})}catch(e){console.log("could not emit",e)}}},{key:"maybeEventRecordingStarted",value:function(e,t){var r="record";if(e&&!t.local&&!0===t[r]&&e[r]!==t[r])try{this.emit("recording-started",{action:"recording-started"})}catch(e){console.log("could not emit",e)}}},{key:"maybeEventTrackStopped",value:function(e,t,r){if(e&&(e[r]&&"ended"===e[r].readyState||e[r]&&(!t||!t[r])||e[r]&&e[r].id!==t[r].id))try{this.emit("track-stopped",{action:"track-stopped",track:e[r],participant:t})}catch(e){console.log("could not emit",e)}}},{key:"maybeEventCustomTrackStopped",value:function(e,t,r,n){if(e&&(!n||!n.remoteMediaPlayerState||n.remoteMediaPlayerState.state!=It&&n.remoteMediaPlayerState.state!=Lt)&&(e&&"ended"===e.readyState||e&&!t||e&&e.id!==t.id))try{this.emit("track-stopped",{action:"track-stopped",track:e,participant:r})}catch(e){console.log("maybeEventCustomTrackStopped: could not emit",e)}}},{key:"maybeEventCustomTrackStarted",value:function(e,t,r){if(t&&!e||t&&"ended"===e.readyState||t&&t.id!==e.id)try{this.emit("track-started",{action:"track-started",track:t,participant:r})}catch(e){console.log("maybeEventCustomTrackStarted: could not emit",e)}}},{key:"maybeEventTrackStarted",value:function(e,t,r){if(t[r]&&(!e||!e[r])||t[r]&&"ended"===e[r].readyState||t[r]&&t[r].id!==e[r].id)try{this.emit("track-started",{action:"track-started",track:t[r],participant:t})}catch(e){console.log("could not emit",e)}}},{key:"maybeEventTrackStoppedForCustomTracks",value:function(e,t){if(e)for(var r in e.tracks)Fo(r)||this.maybeEventCustomTrackStopped(e.tracks[r].track,t&&t.tracks[r]?t.tracks[r].track:null,e,t)}},{key:"maybeEventTrackStartedForCustomTracks",value:function(e,t){if(t)for(var r in t.tracks)Fo(r)||this.maybeEventCustomTrackStarted(e&&e.tracks[r]?e.tracks[r].track:null,t.tracks[r].track,t)}},{key:"compareEqualForRMPUpdateEvent",value:function(e,t){return e.state===t.state}},{key:"emitDailyJSEvent",value:function(e){try{this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(e,t){return!!W(e,t)&&((!e.videoTrack||!t.videoTrack||e.videoTrack.id===t.videoTrack.id&&e.videoTrack.muted===t.videoTrack.muted&&e.videoTrack.enabled===t.videoTrack.enabled)&&(!e.audioTrack||!t.audioTrack||e.audioTrack.id===t.audioTrack.id&&e.audioTrack.muted===t.audioTrack.muted&&e.audioTrack.enabled===t.audioTrack.enabled))}},{key:"nativeUtils",value:function(){return Vt()?"undefined"==typeof DailyNativeUtils?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(e){this.updateMeetingState(this._meetingState,e)}},{key:"updateMeetingState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._isPreparingToJoin;if(e!==this._meetingState||t!==this._isPreparingToJoin){var r=this._meetingState,n=this._isPreparingToJoin;this._meetingState=e,this._isPreparingToJoin=t;var i=this.isMeetingPendingOrOngoing(r,n),a=this.isMeetingPendingOrOngoing(this._meetingState,this._isPreparingToJoin);i!==a&&(this.updateKeepDeviceAwake(a),this.updateDeviceAudioMode(a),this.updateShowAndroidOngoingMeetingNotification(a),this.updateNoOpRecordingEnsuringBackgroundContinuity(a))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=Jo,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:me},this._receiveSettings={},this._inputSettings={},this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(e){Vt()&&this.nativeUtils().setKeepDeviceAwake(e,this._callFrameId)}},{key:"updateDeviceAudioMode",value:function(e){if(Vt()&&!this.disableReactNativeAutoDeviceManagement("audio")){var t=e?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(t)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(e){if(Vt()&&this.nativeUtils().setShowOngoingMeetingNotification){var t,r,n,i;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var a=this.properties.reactNativeConfig.androidInCallNotification;t=a.title,r=a.subtitle,n=a.iconName,i=a.disableForCustomOverride}i&&(e=!1),this.nativeUtils().setShowOngoingMeetingNotification(e,t,r,n,this._callFrameId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(e){Vt()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(e)}},{key:"isMeetingPendingOrOngoing",value:function(e,t){return[oe,se].includes(e)||t}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){if(Vt()){var e=store.getState();for(var t in e.streams){var r=e.streams[t];r&&r.pendingTrack&&"audio"===r.pendingTrack.kind&&(r.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(e){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[e]}},{key:"absoluteUrl",value:function(e){if(void 0!==e){var t=document.createElement("a");return t.href=e,t.href}}},{key:"sayHello",value:function(){var e="hello, world.";return console.log(e),e}}]),i}());export{ge as DAILY_ACCESS_LEVEL_FULL,ye as DAILY_ACCESS_LEVEL_LOBBY,be as DAILY_ACCESS_LEVEL_NONE,me as DAILY_ACCESS_UNKNOWN,Pe as DAILY_CAMERA_ERROR_CAM_AND_MIC_IN_USE,je as DAILY_CAMERA_ERROR_CAM_IN_USE,Oe as DAILY_CAMERA_ERROR_MIC_IN_USE,Ge as DAILY_EVENT_ACCESS_STATE_UPDATED,vt as DAILY_EVENT_ACTIVE_SPEAKER_CHANGE,mt as DAILY_EVENT_ACTIVE_SPEAKER_MODE_CHANGE,ct as DAILY_EVENT_APP_MSG,xe as DAILY_EVENT_CAMERA_ERROR,Ot as DAILY_EVENT_ERROR,wt as DAILY_EVENT_EXIT_FULLSCREEN,bt as DAILY_EVENT_FULLSCREEN,Ee as DAILY_EVENT_IFRAME_LAUNCH_CONFIG,Ae as DAILY_EVENT_IFRAME_READY_FOR_LAUNCH_CONFIG,ut as DAILY_EVENT_INPUT_EVENT,Tt as DAILY_EVENT_INPUT_SETTINGS_UPDATED,Re as DAILY_EVENT_JOINED_MEETING,Ne as DAILY_EVENT_JOINING_MEETING,St as DAILY_EVENT_LANG_UPDATED,Ve as DAILY_EVENT_LEFT_MEETING,Mt as DAILY_EVENT_LIVE_STREAMING_ERROR,_t as DAILY_EVENT_LIVE_STREAMING_STARTED,kt as DAILY_EVENT_LIVE_STREAMING_STOPPED,Be as DAILY_EVENT_LOADED,Ie as DAILY_EVENT_LOADING,Le as DAILY_EVENT_LOAD_ATTEMPT_FAILED,ht as DAILY_EVENT_LOCAL_SCREEN_SHARE_STARTED,ft as DAILY_EVENT_LOCAL_SCREEN_SHARE_STOPPED,He as DAILY_EVENT_MEETING_SESSION_UPDATED,yt as DAILY_EVENT_NETWORK_CONNECTION,gt as DAILY_EVENT_NETWORK_QUALITY_CHANGE,jt as DAILY_EVENT_NONFATAL_ERROR,We as DAILY_EVENT_PARTICIPANT_COUNTS_UPDATED,Je as DAILY_EVENT_PARTICIPANT_JOINED,qe as DAILY_EVENT_PARTICIPANT_LEFT,ze as DAILY_EVENT_PARTICIPANT_UPDATED,Ct as DAILY_EVENT_RECEIVE_SETTINGS_UPDATED,st as DAILY_EVENT_RECORDING_DATA,at as DAILY_EVENT_RECORDING_ERROR,rt as DAILY_EVENT_RECORDING_STARTED,it as DAILY_EVENT_RECORDING_STATS,nt as DAILY_EVENT_RECORDING_STOPPED,ot as DAILY_EVENT_RECORDING_UPLOAD_COMPLETED,lt as DAILY_EVENT_REMOTE_MEDIA_PLAYER_STARTED,pt as DAILY_EVENT_REMOTE_MEDIA_PLAYER_STOPPED,dt as DAILY_EVENT_REMOTE_MEDIA_PLAYER_UPDATED,De as DAILY_EVENT_STARTED_CAMERA,Fe as DAILY_EVENT_THEME_UPDATED,Ye as DAILY_EVENT_TRACK_STARTED,Ze as DAILY_EVENT_TRACK_STOPPED,tt as DAILY_EVENT_TRANSCRIPTION_ERROR,Xe as DAILY_EVENT_TRANSCRIPTION_STARTED,et as DAILY_EVENT_TRANSCRIPTION_STOPPED,Ke as DAILY_EVENT_WAITING_PARTICIPANT_ADDED,$e as DAILY_EVENT_WAITING_PARTICIPANT_REMOVED,Qe as DAILY_EVENT_WAITING_PARTICIPANT_UPDATED,ke as DAILY_FATAL_ERROR_EJECTED,Ce as DAILY_FATAL_ERROR_EXP_ROOM,Te as DAILY_FATAL_ERROR_EXP_TOKEN,Me as DAILY_FATAL_ERROR_NBF_ROOM,Se as DAILY_FATAL_ERROR_NBF_TOKEN,_e as DAILY_RECEIVE_SETTINGS_ALL_PARTICIPANTS_KEY,we as DAILY_RECEIVE_SETTINGS_BASE_KEY,ue as DAILY_STATE_ERROR,se as DAILY_STATE_JOINED,oe as DAILY_STATE_JOINING,ce as DAILY_STATE_LEFT,ie as DAILY_STATE_NEW,le as DAILY_TRACK_STATE_BLOCKED,fe as DAILY_TRACK_STATE_INTERRUPTED,he as DAILY_TRACK_STATE_LOADING,de as DAILY_TRACK_STATE_OFF,ve as DAILY_TRACK_STATE_PLAYABLE,pe as DAILY_TRACK_STATE_SENDABLE};
