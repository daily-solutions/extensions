var hs=(A,M,L)=>{if(!M.has(A))throw TypeError("Cannot "+L)};var At=(A,M,L)=>{if(M.has(A))throw TypeError("Cannot add the same private member more than once");M instanceof WeakSet?M.add(A):M.set(A,L)};var et=(A,M,L)=>(hs(A,M,"access private method"),L);(function(A,M){typeof exports=="object"&&typeof module<"u"?module.exports=M(require("https://cdn.socket.io/4.3.2/socket.io.esm.min.js")):typeof define=="function"&&define.amd?define(["https://cdn.socket.io/4.3.2/socket.io.esm.min.js"],M):(A=typeof globalThis<"u"?globalThis:A||self,A.core=M(A.socket_io_esm_min_js))})(this,function(A){var je,Lt,Xe,bn;"use strict";var M={exports:{}},L=typeof Reflect=="object"?Reflect:null,Ft=L&&typeof L.apply=="function"?L.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},Pe;L&&typeof L.ownKeys=="function"?Pe=L.ownKeys:Object.getOwnPropertySymbols?Pe=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Pe=function(t){return Object.getOwnPropertyNames(t)};function wn(e){console&&console.warn&&console.warn(e)}var xt=Number.isNaN||function(t){return t!==t};function y(){y.init.call(this)}M.exports=y,M.exports.once=Sn,y.EventEmitter=y,y.prototype._events=void 0,y.prototype._eventsCount=0,y.prototype._maxListeners=void 0;var It=10;function Ee(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(y,"defaultMaxListeners",{enumerable:!0,get:function(){return It},set:function(e){if(typeof e!="number"||e<0||xt(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");It=e}}),y.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},y.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||xt(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Bt(e){return e._maxListeners===void 0?y.defaultMaxListeners:e._maxListeners}y.prototype.getMaxListeners=function(){return Bt(this)},y.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=a[t];if(c===void 0)return!1;if(typeof c=="function")Ft(c,this,n);else for(var u=c.length,d=Vt(c,u),r=0;r<u;++r)Ft(d[r],this,n);return!0};function Dt(e,t,n,r){var i,a,o;if(Ee(n),a=e._events,a===void 0?(a=e._events=Object.create(null),e._eventsCount=0):(a.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),o===void 0)o=a[t]=n,++e._eventsCount;else if(typeof o=="function"?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=Bt(e),i>0&&o.length>i&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,wn(s)}return e}y.prototype.addListener=function(t,n){return Dt(this,t,n,!1)},y.prototype.on=y.prototype.addListener,y.prototype.prependListener=function(t,n){return Dt(this,t,n,!0)};function _n(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Nt(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=_n.bind(r);return i.listener=n,r.wrapFn=i,i}y.prototype.once=function(t,n){return Ee(n),this.on(t,Nt(this,t,n)),this},y.prototype.prependOnceListener=function(t,n){return Ee(n),this.prependListener(t,Nt(this,t,n)),this},y.prototype.removeListener=function(t,n){var r,i,a,o,s;if(Ee(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(a=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){s=r[o].listener,a=o;break}if(a<0)return this;a===0?r.shift():kn(r,a),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,s||n)}return this},y.prototype.off=y.prototype.removeListener,y.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var a=Object.keys(r),o;for(i=0;i<a.length;++i)o=a[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function Rt(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?Mn(i):Vt(i,i.length)}y.prototype.listeners=function(t){return Rt(this,t,!0)},y.prototype.rawListeners=function(t){return Rt(this,t,!1)},y.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Ut.call(e,t)},y.prototype.listenerCount=Ut;function Ut(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}y.prototype.eventNames=function(){return this._eventsCount>0?Pe(this._events):[]};function Vt(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function kn(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Mn(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function Sn(e,t){return new Promise(function(n,r){function i(o){e.removeListener(t,a),r(o)}function a(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}Wt(e,t,a,{once:!0}),t!=="error"&&Cn(e,i,{once:!0})})}function Cn(e,t,n){typeof e.on=="function"&&Wt(e,"error",t,n)}function Wt(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(a){r.once&&e.removeEventListener(t,i),n(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Tn=function(e){if(Array.isArray(e))return e},On=function(e,t){if(typeof Symbol<"u"&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(c){i=!0,a=c}finally{try{r||s.return==null||s.return()}finally{if(i)throw a}}return n}},qt=function(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},jn=function(e,t){if(e){if(typeof e=="string")return qt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qt(e,t):void 0}},Pn=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},tt=function(e,t){return Tn(e)||On(e,t)||jn(e,t)||Pn()},En=function(e,t){if(e==null)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i},An=function(e,t){if(e==null)return{};var n,r,i=En(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i};function zt(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}var h=function(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(c){zt(a,r,i,o,s,"next",c)}function s(c){zt(a,r,i,o,s,"throw",c)}o(void 0)})}},B=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},D=function(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var N=function(e,t,n){return t&&Jt(e.prototype,t),n&&Jt(e,n),e},Ae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function K(e,t){return e(t={exports:{}},t.exports),t.exports}var rt=K(function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf||function(i,a){return i.__proto__=a,i},t(n,r)}e.exports=t}),Le=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rt(e,t)},O=K(function(e){function t(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e.exports=t=function(r){return typeof r}:e.exports=t=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t(n)}e.exports=t}),Fe=function(e,t){return!t||O(t)!=="object"&&typeof t!="function"?D(e):t},W=K(function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},t(n)}e.exports=t}),R=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},Ln=typeof Map=="function",Fn=typeof Set=="function",xn=typeof WeakSet=="function",Ht=Object.keys,Gt=function(e,t){return e&&typeof e=="object"&&t.add(e)},Kt=function(e,t,n,r){for(var i,a=0;a<e.length;a++)if(n((i=e[a])[0],t[0],r)&&n(i[1],t[1],r))return!0;return!1},nt=function(e,t,n,r){for(var i=0;i<e.length;i++)if(n(e[i],t,r))return!0;return!1},he=function(e,t){return e===t||e!=e&&t!=t},$t=function(e){return e.constructor===Object},Qt=function(e){return typeof e.then=="function"},Zt=function(e){return!(!e.$$typeof||!e._store)},Xt=function(e){return function(t){var n=e||t;return function(r,i,a){a===void 0&&(a=xn?new WeakSet:Object.create({_values:[],add:function(c){this._values.push(c)},has:function(c){return!!~this._values.indexOf(c)}}));var o=a.has(r),s=a.has(i);return o||s?o&&s:(Gt(r,a),Gt(i,a),n(r,i,a))}}},Yt=function(e){var t=[];return e.forEach(function(n,r){return t.push([r,n])}),t},er=function(e){var t=[];return e.forEach(function(n){return t.push(n)}),t},In=function(e,t,n,r){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t[i],r))return!1;return!0},Bn=function(e,t,n,r){if(e.size!==t.size)return!1;for(var i=Yt(e),a=Yt(t),o=0;o<i.length;o++)if(!Kt(a,i[o],n,r)||!Kt(i,a[o],n,r))return!1;return!0},tr=function(e,t,n,r){var i,a=Ht(e),o=Ht(t);if(a.length!==o.length)return!1;for(var s=0;s<a.length;s++)if(i=a[s],!nt(o,i,he)||(i!=="_owner"||!Zt(e)||!Zt(t))&&!n(e[i],t[i],r))return!1;return!0},Dn=function(e,t){return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.unicode===t.unicode&&e.sticky===t.sticky&&e.lastIndex===t.lastIndex},Nn=function(e,t,n,r){if(e.size!==t.size)return!1;for(var i=er(e),a=er(t),o=0;o<i.length;o++)if(!nt(a,i[o],n,r)||!nt(i,a[o],n,r))return!1;return!0},rr=Array.isArray,xe=function(e){var t=typeof e=="function"?e(n):n;function n(r,i,a){if(he(r,i))return!0;var o=typeof r;if(o!==typeof i||o!=="object"||!r||!i)return!1;if($t(r)&&$t(i))return tr(r,i,t,a);var s=rr(r),c=rr(i);if(s||c)return s===c&&In(r,i,t,a);var u=r instanceof Date,d=i instanceof Date;if(u||d)return u===d&&he(r.getTime(),i.getTime());var f=r instanceof RegExp,p=i instanceof RegExp;if(f||p)return f===p&&Dn(r,i);if(Qt(r)||Qt(i))return r===i;if(Ln){var m=r instanceof Map,k=i instanceof Map;if(m||k)return m===k&&Bn(r,i,t,a)}if(Fn){var C=r instanceof Set,E=i instanceof Set;if(C||E)return C===E&&Nn(r,i,t,a)}return tr(r,i,t,a)}return n},ve=(xe(Xt()),xe(Xt(he)),xe());xe(function(){return he});const Rn={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},nr={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},S={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},P={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},J={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class l{static getFirstMatch(t,n){const r=n.match(t);return r&&r.length>0&&r[1]||""}static getSecondMatch(t,n){const r=n.match(t);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(t,n,r){if(t.test(n))return r}static getWindowsVersionName(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(t){const n=t.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(n.push(0),n[0]===10)switch(n[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(t){const n=t.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(n.push(0),!(n[0]===1&&n[1]<5))return n[0]===1&&n[1]<6?"Cupcake":n[0]===1&&n[1]>=6?"Donut":n[0]===2&&n[1]<2?"Eclair":n[0]===2&&n[1]===2?"Froyo":n[0]===2&&n[1]>2?"Gingerbread":n[0]===3?"Honeycomb":n[0]===4&&n[1]<1?"Ice Cream Sandwich":n[0]===4&&n[1]<4?"Jelly Bean":n[0]===4&&n[1]>=4?"KitKat":n[0]===5?"Lollipop":n[0]===6?"Marshmallow":n[0]===7?"Nougat":n[0]===8?"Oreo":n[0]===9?"Pie":void 0}static getVersionPrecision(t){return t.split(".").length}static compareVersions(t,n,r=!1){const i=l.getVersionPrecision(t),a=l.getVersionPrecision(n);let o=Math.max(i,a),s=0;const c=l.map([t,n],u=>{const d=o-l.getVersionPrecision(u),f=u+new Array(d+1).join(".0");return l.map(f.split("."),p=>new Array(20-p.length).join("0")+p).reverse()});for(r&&(s=o-Math.min(i,a)),o-=1;o>=s;){if(c[0][o]>c[1][o])return 1;if(c[0][o]===c[1][o]){if(o===s)return 0;o-=1}else if(c[0][o]<c[1][o])return-1}}static map(t,n){const r=[];let i;if(Array.prototype.map)return Array.prototype.map.call(t,n);for(i=0;i<t.length;i+=1)r.push(n(t[i]));return r}static find(t,n){let r,i;if(Array.prototype.find)return Array.prototype.find.call(t,n);for(r=0,i=t.length;r<i;r+=1){const a=t[r];if(n(a,r))return a}}static assign(t,...n){const r=t;let i,a;if(Object.assign)return Object.assign(t,...n);for(i=0,a=n.length;i<a;i+=1){const o=n[i];typeof o=="object"&&o!==null&&Object.keys(o).forEach(s=>{r[s]=o[s]})}return t}static getBrowserAlias(t){return Rn[t]}static getBrowserTypeByAlias(t){return nr[t]||""}}const b=/version\/(\d+(\.?_?\d+)+)/i,Un=[{test:[/googlebot/i],describe(e){const t={name:"Googlebot"},n=l.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/opera/i],describe(e){const t={name:"Opera"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe(e){const t={name:"Opera"},n=l.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe(e){const t={name:"Samsung Internet for Android"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe(e){const t={name:"NAVER Whale Browser"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe(e){const t={name:"MZ Browser"},n=l.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/focus/i],describe(e){const t={name:"Focus"},n=l.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/swing/i],describe(e){const t={name:"Swing"},n=l.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/coast/i],describe(e){const t={name:"Opera Coast"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe(e){const t={name:"Yandex Browser"},n=l.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe(e){const t={name:"UC Browser"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe(e){const t={name:"Maxthon"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe(e){const t={name:"Epiphany"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe(e){const t={name:"Puffin"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe(e){const t={name:"Sleipnir"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe(e){const t={name:"K-Meleon"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe(e){const t={name:"WeChat"},n=l.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe(e){const t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=l.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe(e){const t={name:"Internet Explorer"},n=l.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe(e){const t={name:"Microsoft Edge"},n=l.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe(e){const t={name:"Microsoft Edge"},n=l.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe(e){const t={name:"Vivaldi"},n=l.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe(e){const t={name:"SeaMonkey"},n=l.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe(e){const t={name:"Sailfish"},n=l.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe(e){const t={name:"Amazon Silk"},n=l.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe(e){const t={name:"PhantomJS"},n=l.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe(e){const t={name:"SlimerJS"},n=l.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t={name:"BlackBerry"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe(e){const t={name:"WebOS Browser"},n=l.getFirstMatch(b,e)||l.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe(e){const t={name:"Bada"},n=l.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe(e){const t={name:"Tizen"},n=l.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe(e){const t={name:"QupZilla"},n=l.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe(e){const t={name:"Firefox"},n=l.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe(e){const t={name:"Electron"},n=l.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe(e){const t={name:"Chromium"},n=l.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe(e){const t={name:"Chrome"},n=l.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe(e){const t={name:"Google Search"},n=l.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test(e){const t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe(e){const t={name:"Android Browser"},n=l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe(e){const t={name:"PlayStation 4"},n=l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe(e){const t={name:"Safari"},n=l.getFirstMatch(b,e);return n&&(t.version=n),t}},{test:[/.*/i],describe(e){const t=e.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:l.getFirstMatch(t,e),version:l.getSecondMatch(t,e)}}}];var Vn=[{test:[/Roku\/DVP/],describe(e){const t=l.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:P.Roku,version:t}}},{test:[/windows phone/i],describe(e){const t=l.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:P.WindowsPhone,version:t}}},{test:[/windows /i],describe(e){const t=l.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=l.getWindowsVersionName(t);return{name:P.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe(e){const t=l.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return{name:P.iOS,version:t}}},{test:[/macintosh/i],describe(e){const t=l.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=l.getMacOSVersionName(t),r={name:P.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe(e){const t=l.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:P.iOS,version:t}}},{test(e){const t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe(e){const t=l.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=l.getAndroidVersionName(t),r={name:P.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe(e){const t=l.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:P.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t=l.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||l.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||l.getFirstMatch(/\bbb(\d+)/i,e);return{name:P.BlackBerry,version:t}}},{test:[/bada/i],describe(e){const t=l.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:P.Bada,version:t}}},{test:[/tizen/i],describe(e){const t=l.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:P.Tizen,version:t}}},{test:[/linux/i],describe:()=>({name:P.Linux})},{test:[/CrOS/],describe:()=>({name:P.ChromeOS})},{test:[/PlayStation 4/],describe(e){const t=l.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:P.PlayStation4,version:t}}}],Wn=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(e){const t=l.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:S.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:S.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:S.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:()=>({type:S.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:S.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:S.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:S.tablet})},{test(e){const t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe(e){const t=l.getFirstMatch(/(ipod|iphone)/i,e);return{type:S.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:S.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:S.mobile})},{test:e=>e.getBrowserName(!0)==="blackberry",describe:()=>({type:S.mobile,vendor:"BlackBerry"})},{test:e=>e.getBrowserName(!0)==="bada",describe:()=>({type:S.mobile})},{test:e=>e.getBrowserName()==="windows phone",describe:()=>({type:S.mobile,vendor:"Microsoft"})},{test(e){const t=Number(String(e.getOSVersion()).split(".")[0]);return e.getOSName(!0)==="android"&&t>=3},describe:()=>({type:S.tablet})},{test:e=>e.getOSName(!0)==="android",describe:()=>({type:S.mobile})},{test:e=>e.getOSName(!0)==="macos",describe:()=>({type:S.desktop,vendor:"Apple"})},{test:e=>e.getOSName(!0)==="windows",describe:()=>({type:S.desktop})},{test:e=>e.getOSName(!0)==="linux",describe:()=>({type:S.desktop})},{test:e=>e.getOSName(!0)==="playstation 4",describe:()=>({type:S.tv})},{test:e=>e.getOSName(!0)==="roku",describe:()=>({type:S.tv})}],qn=[{test:e=>e.getBrowserName(!0)==="microsoft edge",describe(e){if(/\sedg\//i.test(e))return{name:J.Blink};const t=l.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:J.EdgeHTML,version:t}}},{test:[/trident/i],describe(e){const t={name:J.Trident},n=l.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:e=>e.test(/presto/i),describe(e){const t={name:J.Presto},n=l.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test(e){const t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe(e){const t={name:J.Gecko},n=l.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:J.Blink})},{test:[/(apple)?webkit/i],describe(e){const t={name:J.WebKit},n=l.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];class ir{constructor(t,n=!1){if(t==null||t==="")throw new Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},n!==!0&&this.parse()}getUA(){return this._ua}test(t){return t.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const t=l.find(Un,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const t=l.find(Vn,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os}getOSName(t){const{name:n}=this.getOS();return t?String(n).toLowerCase()||"":n||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(t=!1){const{type:n}=this.getPlatform();return t?String(n).toLowerCase()||"":n||""}parsePlatform(){this.parsedResult.platform={};const t=l.find(Wn,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const t=l.find(qn,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return l.assign({},this.parsedResult)}satisfies(t){const n={};let r=0;const i={};let a=0;if(Object.keys(t).forEach(o=>{const s=t[o];typeof s=="string"?(i[o]=s,a+=1):typeof s=="object"&&(n[o]=s,r+=1)}),r>0){const o=Object.keys(n),s=l.find(o,u=>this.isOS(u));if(s){const u=this.satisfies(n[s]);if(u!==void 0)return u}const c=l.find(o,u=>this.isPlatform(u));if(c){const u=this.satisfies(n[c]);if(u!==void 0)return u}}if(a>0){const o=Object.keys(i),s=l.find(o,c=>this.isBrowser(c,!0));if(s!==void 0)return this.compareVersion(i[s])}}isBrowser(t,n=!1){const r=this.getBrowserName().toLowerCase();let i=t.toLowerCase();const a=l.getBrowserTypeByAlias(i);return n&&a&&(i=a.toLowerCase()),i===r}compareVersion(t){let n=[0],r=t,i=!1;const a=this.getBrowserVersion();if(typeof a=="string")return t[0]===">"||t[0]==="<"?(r=t.substr(1),t[1]==="="?(i=!0,r=t.substr(2)):n=[],t[0]===">"?n.push(1):n.push(-1)):t[0]==="="?r=t.substr(1):t[0]==="~"&&(i=!0,r=t.substr(1)),n.indexOf(l.compareVersions(a,r,i))>-1}isOS(t){return this.getOSName(!0)===String(t).toLowerCase()}isPlatform(t){return this.getPlatformType(!0)===String(t).toLowerCase()}isEngine(t){return this.getEngineName(!0)===String(t).toLowerCase()}is(t){return this.isBrowser(t)||this.isOS(t)||this.isPlatform(t)}some(t=[]){return t.some(n=>this.is(n))}}var ar="new",it="loading",me="joining-meeting",j="joined-meeting",$="left-meeting",Q="error",at="unknown",zn="base",Jn="*",or="available-devices-updated",re="fullscreen",ne="exited-fullscreen",Ie="daily-custom-track",Be={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image"},ot={PLAY:"play",PAUSE:"pause"},Hn="playing",Gn="paused",sr=10,st=["jpg","png","jpeg"],Kn="add-endpoints",$n="remove-endpoints";function U(){return!_()&&typeof window<"u"&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function _(){return typeof navigator<"u"&&navigator.product&&navigator.product==="ReactNative"}function cr(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function Qn(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&function(e,t){if(!e||!t)return!0;switch(e){case"Chrome":return t.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&!(t.major===13&&t.minor===0&&t.point===0);case"Firefox":return t.major>=67}return!0}(De(),function(){switch(De()){case"Chrome":return fr();case"Safari":return hr();case"Firefox":return vr();case"Edge":return function(){var e=0,t=0;if(typeof window<"u"){var n=U(),r=n.match(/Edge\/(\d+).(\d+)/);if(r)try{e=parseInt(r[1]),t=parseInt(r[2])}catch{}}return{major:e,minor:t}}()}}())}function ur(){if(_()||!document)return!1;var e=document.createElement("iframe");return!!e.requestFullscreen||!!e.webkitRequestFullscreen}var Zn=["Chrome","Firefox"];function Xn(){return!_()&&!function(){var e=U();if(e.match(/Mobi/)||e.match(/Android/)||U().match(/DailyAnd\//))return!0}()&&Zn.includes(De())}function lr(){return!!_()||dr()}function dr(){return cr()&&!function(){var e,t=De();if(!U())return!0;switch(t){case"Chrome":return(e=fr()).major&&e.major>0&&e.major<61;case"Firefox":return(e=vr()).major<78;case"Safari":return(e=hr()).major<12;default:return!0}}()}function De(){if(typeof window<"u"){var e=U();return pr()?"Safari":e.indexOf("Edge")>-1?"Edge":e.match(/Chrome\//)?"Chrome":e.indexOf("Safari")>-1?"Safari":e.indexOf("Firefox")>-1?"Firefox":e.indexOf("MSIE")>-1||e.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function fr(){var e=0,t=0,n=0,r=0,i=!1;if(typeof window<"u"){var a=U(),o=a.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(o)try{e=parseInt(o[1]),t=parseInt(o[2]),n=parseInt(o[3]),r=parseInt(o[4]),i=a.indexOf("OPR/")>-1}catch{}}return{major:e,minor:t,build:n,patch:r,opera:i}}function pr(){return!!U().match(/iPad|iPhone|iPod/i)&&cr()}function hr(){var e=0,t=0,n=0;if(typeof window<"u"){var r=U().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(r)try{e=parseInt(r[1]),t=parseInt(r[2]),n=parseInt(r[4])}catch{}else pr()&&(e=14,t=0,n=3)}return{major:e,minor:t,point:n}}function vr(){var e=0,t=0;if(typeof window<"u"){var n=U().match(/Firefox\/(\d+).(\d+)/);if(n)try{e=parseInt(n[1]),t=parseInt(n[2])}catch{}}return{major:e,minor:t}}function Ne(){return Date.now()+Math.random().toString()}function ge(){throw new Error("Method must be implemented in subclass")}function ie(e){if(window._dailyConfig&&window._dailyConfig.callObjectBundleUrlOverride)return window._dailyConfig.callObjectBundleUrlOverride;var t=e?new URL(e).origin:null;function n(i){return"".concat(i,"/static/call-machine-object").concat(lr()?"":"-nosfu","-bundle.js")}function r(){var i=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).isStaging;return n("https://c".concat(i!==void 0&&i?".staging":"",".daily.co"))}return t?t.match(/https:\/\/[^.]+\.daily\.co/)?r():t.match(/https:\/\/preview-[^.]+\.staging\.daily\.co/)?n(t):t.match(/https:\/\/[^.]+\.staging\.daily\.co/)?r({isStaging:!0}):n(t):r()}function ct(e){try{new URL(e)}catch{return!1}return!0}var mr=function(){function e(){B(this,e)}return N(e,[{key:"addListenerForMessagesFromCallMachine",value:function(t,n,r){ge()}},{key:"addListenerForMessagesFromDailyJs",value:function(t,n,r){ge()}},{key:"sendMessageToCallMachine",value:function(t,n,r,i){ge()}},{key:"sendMessageToDailyJs",value:function(t,n,r){ge()}},{key:"removeListener",value:function(t){ge()}}]),e}();function gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gr(Object(n),!0).forEach(function(r){R(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gr(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Yn(e){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var n,r=W(e);if(t){var i=W(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fe(this,n)}}var ei=function(e){Le(n,mr);var t=Yn(n);function n(){var r;return B(this,n),(r=t.call(this))._wrappedListeners={},r._messageCallbacks={},r}return N(n,[{key:"addListenerForMessagesFromCallMachine",value:function(r,i,a){var o=this,s=function(c){if(c.data&&c.data.what==="iframe-call-message"&&(!c.data.callFrameId||c.data.callFrameId===i)&&(!c.data.from||c.data.from!=="module")){var u=ut({},c.data);if(delete u.from,u.callbackStamp&&o._messageCallbacks[u.callbackStamp]){var d=u.callbackStamp;o._messageCallbacks[d].call(a,u),delete o._messageCallbacks[d]}delete u.what,delete u.callbackStamp,r.call(a,u)}};this._wrappedListeners[r]=s,window.addEventListener("message",s)}},{key:"addListenerForMessagesFromDailyJs",value:function(r,i,a){var o=function(s){if(!(!s.data||s.data.what!=="iframe-call-message"||!s.data.action||s.data.from&&s.data.from!=="module"||s.data.callFrameId&&i&&s.data.callFrameId!==i)){var c=s.data;r.call(a,c)}};this._wrappedListeners[r]=o,window.addEventListener("message",o)}},{key:"sendMessageToCallMachine",value:function(r,i,a,o){var s=ut({},r);if(s.what="iframe-call-message",s.from="module",s.callFrameId=o,i){var c=Ne();this._messageCallbacks[c]=i,s.callbackStamp=c}(a?a.contentWindow:window).postMessage(s,"*")}},{key:"sendMessageToDailyJs",value:function(r,i,a){r.what="iframe-call-message",r.callFrameId=a,r.from="embedded",(i?window:window.parent).postMessage(r,"*")}},{key:"removeListener",value:function(r){var i=this._wrappedListeners[r];i&&(window.removeEventListener("message",i),delete this._wrappedListeners[r])}},{key:"forwardPackagedMessageToCallMachine",value:function(r,i,a){var o=ut({},r);o.callFrameId=a,(i?i.contentWindow:window).postMessage(o,"*")}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(r,i){var a=function(o){if(o.data&&o.data.what==="iframe-call-message"&&(!o.data.callFrameId||o.data.callFrameId===i)&&(!o.data.from||o.data.from!=="module")){var s=o.data;r(s)}};return this._wrappedListeners[r]=a,window.addEventListener("message",a),r}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(r){var i=this._wrappedListeners[r];i&&(window.removeEventListener("message",i),delete this._wrappedListeners[r])}}]),n}();function ti(e){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var n,r=W(e);if(t){var i=W(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fe(this,n)}}var ri=function(e){Le(n,mr);var t=ti(n);function n(){var r;return B(this,n),r=t.call(this),global.callMachineToDailyJsEmitter=global.callMachineToDailyJsEmitter||new M.exports.EventEmitter,global.dailyJsToCallMachineEmitter=global.dailyJsToCallMachineEmitter||new M.exports.EventEmitter,r._wrappedListeners={},r._messageCallbacks={},r}return N(n,[{key:"addListenerForMessagesFromCallMachine",value:function(r,i,a){this._addListener(r,global.callMachineToDailyJsEmitter,a,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(r,i,a){this._addListener(r,global.dailyJsToCallMachineEmitter,a,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(r,i){this._sendMessage(r,global.dailyJsToCallMachineEmitter,"sending message to call machine",i)}},{key:"sendMessageToDailyJs",value:function(r){this._sendMessage(r,global.callMachineToDailyJsEmitter,"sending message to daily-js")}},{key:"removeListener",value:function(r){var i=this._wrappedListeners[r];i&&(global.callMachineToDailyJsEmitter.removeListener("message",i),global.dailyJsToCallMachineEmitter.removeListener("message",i),delete this._wrappedListeners[r])}},{key:"_addListener",value:function(r,i,a,o){var s=this,c=function(u){if(u.callbackStamp&&s._messageCallbacks[u.callbackStamp]){var d=u.callbackStamp;s._messageCallbacks[d].call(a,u),delete s._messageCallbacks[d]}r.call(a,u)};this._wrappedListeners[r]=c,i.addListener("message",c)}},{key:"_sendMessage",value:function(r,i,a,o){if(o){var s=Ne();this._messageCallbacks[s]=o,r.callbackStamp=s}i.emit("message",r)}}]),n}(),ni=function(e){return Function.toString.call(e).indexOf("[native code]")!==-1},ii=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}},ai=K(function(e){function t(n,r,i){return ii()?e.exports=t=Reflect.construct:e.exports=t=function(a,o,s){var c=[null];c.push.apply(c,o);var u=new(Function.bind.apply(a,c));return s&&rt(u,s.prototype),u},t.apply(null,arguments)}e.exports=t}),oi=K(function(e){function t(n){var r=typeof Map=="function"?new Map:void 0;return e.exports=t=function(i){if(i===null||!ni(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(r!==void 0){if(r.has(i))return r.get(i);r.set(i,a)}function a(){return ai(i,arguments,W(this).constructor)}return a.prototype=Object.create(i.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),rt(a,i)},t(n)}e.exports=t});function si(e){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var n,r=W(e);if(t){var i=W(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fe(this,n)}}var ci=function(){function e(){B(this,e),this._currentLoad=null}return N(e,[{key:"load",value:function(t,n,r,i,a){if(this.loaded)return window._dailyCallObjectSetup(n),void i(!0);(function(o,s){window._dailyConfig||(window._dailyConfig={}),window._dailyConfig.callFrameId=o,window._dailyConfig.avoidEval=s})(n,r),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new li(t,function(){i(!1)},a),this._currentLoad.start()}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel()}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}]),e}(),ui=3,li=function(){function e(t,n,r){B(this,e),this._attemptsRemaining=ui,this._currentAttempt=null,this._meetingOrBaseUrl=t,this._successCallback=n,this._failureCallback=r}return N(e,[{key:"start",value:function(){var t=this;this._currentAttempt||(this._currentAttempt=new yr(this._meetingOrBaseUrl,this._successCallback,function n(r){t._currentAttempt.cancelled||(t._attemptsRemaining--,t._failureCallback(r,t._attemptsRemaining>0),t._attemptsRemaining<=0||setTimeout(function(){t._currentAttempt.cancelled||(t._currentAttempt=new yr(t._meetingOrBaseUrl,t._successCallback,n),t._currentAttempt.start())},3e3))}),this._currentAttempt.start())}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}]),e}(),lt=function(e){Le(n,e);var t=si(n);function n(){return B(this,n),t.apply(this,arguments)}return n}(oi(Error)),yr=function(){function e(t,n,r){B(this,e),this._loadAttemptImpl=_()||!_dailyConfig.avoidEval?new di(t,n,r):new fi(t,n,r)}return N(e,[{key:"start",value:function(){var t=h(function*(){return this._loadAttemptImpl.start()});return function(){return t.apply(this,arguments)}}()},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]),e}(),di=function(){function e(t,n,r){B(this,e),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache=typeof iOSCallObjectBundleCache<"u"&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._meetingOrBaseUrl=t,this._successCallback=n,this._failureCallback=r}return N(e,[{key:"start",value:function(){var t=h(function*(){var n;try{n=ie(this._meetingOrBaseUrl)}catch(r){return void this._failureCallback("Failed to get call object bundle for URL ".concat(this._meetingOrBaseUrl,": ").concat(r))}!(yield this._tryLoadFromIOSCache(n))&&this._loadFromNetwork(n)});return function(){return t.apply(this,arguments)}}()},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:function(){var t=h(function*(n){if(!this._iosCache)return!1;try{var r=yield this._iosCache.get(n);return!!this.cancelled||!!r&&(r.code?(Function('"use strict";'+r.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=r.refetchHeaders,!1))}catch{return!1}});return function(n){return t.apply(this,arguments)}}()},{key:"_loadFromNetwork",value:function(){var t=h(function*(n){var r=this;this._networkTimeout=setTimeout(function(){r._networkTimedOut=!0,r._failureCallback("Timed out (>".concat(2e4," ms) when loading call object bundle ").concat(n))},2e4);try{var i=this._refetchHeaders?{headers:this._refetchHeaders}:{},a=yield fetch(n,i);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new lt;var o=yield this._getBundleCodeFromResponse(n,a);if(this.cancelled)throw new lt;Function('"use strict";'+o)(),this._iosCache&&this._iosCache.set(n,o,a.headers),this.succeeded=!0,this._successCallback()}catch(s){if(clearTimeout(this._networkTimeout),s instanceof lt||this.cancelled||this._networkTimedOut)return;this._failureCallback("Failed to load call object bundle ".concat(n,": ").concat(s))}});return function(n){return t.apply(this,arguments)}}()},{key:"_getBundleCodeFromResponse",value:function(){var t=h(function*(n,r){if(r.ok)return yield r.text();if(this._iosCache&&r.status===304)return(yield this._iosCache.renew(n,r.headers)).code;throw new Error("Received ".concat(r.status," response"))});return function(n,r){return t.apply(this,arguments)}}()}]),e}(),fi=function(){function e(t,n,r){B(this,e),this.cancelled=!1,this.succeeded=!1,this._meetingOrBaseUrl=t,this._successCallback=n,this._failureCallback=r,this._attemptId=Ne(),this._networkTimeout=null,this._scriptElement=null}return N(e,[{key:"start",value:function(){var t=h(function*(){var n;window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);try{n=ie(this._meetingOrBaseUrl)}catch(r){return void this._failureCallback("Failed to get call object bundle for URL ".concat(this._meetingOrBaseUrl,": ").concat(r))}(typeof document>"u"?"undefined":O(document))==="object"?this._startLoading(n):this._failureCallback("Call object bundle must be loaded in a DOM/web context")});return function(){return t.apply(this,arguments)}}()},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(t){var n=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout(function(){n._stopLoading(),n._failureCallback("Timed out (>".concat(2e4," ms) when loading call object bundle ").concat(t))},2e4);var r=document.getElementsByTagName("head")[0],i=document.createElement("script");this._scriptElement=i,i.onload=h(function*(){n._stopLoading(),n.succeeded=!0,n._successCallback()}),i.onerror=function(){var a=h(function*(o){n._stopLoading(),n._failureCallback("Failed to load call object bundle ".concat(o.target.src))});return function(o){return a.apply(this,arguments)}}(),i.src=t,r.appendChild(i)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}]),e}(),br=function(e,t){for(var n=-1,r=e==null?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a},pi=function(e){return function(t,n,r){for(var i=-1,a=Object(t),o=r(t),s=o.length;s--;){var c=o[e?s:++i];if(n(a[c],c,a)===!1)break}return t}}(),hi=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},wr=typeof Ae=="object"&&Ae&&Ae.Object===Object&&Ae,vi=typeof self=="object"&&self&&self.Object===Object&&self,q=wr||vi||Function("return this")(),H=q.Symbol,_r=Object.prototype,mi=_r.hasOwnProperty,gi=_r.toString,ye=H?H.toStringTag:void 0,yi=function(e){var t=mi.call(e,ye),n=e[ye];try{e[ye]=void 0;var r=!0}catch{}var i=gi.call(e);return r&&(t?e[ye]=n:delete e[ye]),i},bi=Object.prototype.toString,wi=function(e){return bi.call(e)},_i="[object Null]",ki="[object Undefined]",kr=H?H.toStringTag:void 0,ae=function(e){return e==null?e===void 0?ki:_i:kr&&kr in Object(e)?yi(e):wi(e)},oe=function(e){return e!=null&&typeof e=="object"},Mi="[object Arguments]",Mr=function(e){return oe(e)&&ae(e)==Mi},Sr=Object.prototype,Si=Sr.hasOwnProperty,Ci=Sr.propertyIsEnumerable,Cr=Mr(function(){return arguments}())?Mr:function(e){return oe(e)&&Si.call(e,"callee")&&!Ci.call(e,"callee")},F=Array.isArray,Ti=function(){return!1},dt=K(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?q.Buffer:void 0,a=(i?i.isBuffer:void 0)||Ti;e.exports=a}),Oi=9007199254740991,ji=/^(?:0|[1-9]\d*)$/,Tr=function(e,t){var n=typeof e;return!!(t=t==null?Oi:t)&&(n=="number"||n!="symbol"&&ji.test(e))&&e>-1&&e%1==0&&e<t},Pi=9007199254740991,ft=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Pi},w={};w["[object Float32Array]"]=w["[object Float64Array]"]=w["[object Int8Array]"]=w["[object Int16Array]"]=w["[object Int32Array]"]=w["[object Uint8Array]"]=w["[object Uint8ClampedArray]"]=w["[object Uint16Array]"]=w["[object Uint32Array]"]=!0,w["[object Arguments]"]=w["[object Array]"]=w["[object ArrayBuffer]"]=w["[object Boolean]"]=w["[object DataView]"]=w["[object Date]"]=w["[object Error]"]=w["[object Function]"]=w["[object Map]"]=w["[object Number]"]=w["[object Object]"]=w["[object RegExp]"]=w["[object Set]"]=w["[object String]"]=w["[object WeakMap]"]=!1;var Ei=function(e){return oe(e)&&ft(e.length)&&!!w[ae(e)]},Or=function(e){return function(t){return e(t)}},jr=K(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n&&wr.process,a=function(){try{var o=r&&r.require&&r.require("util").types;return o||i&&i.binding&&i.binding("util")}catch{}}();e.exports=a}),Pr=jr&&jr.isTypedArray,Er=Pr?Or(Pr):Ei,Ai=Object.prototype.hasOwnProperty,Li=function(e,t){var n=F(e),r=!n&&Cr(e),i=!n&&!r&&dt(e),a=!n&&!r&&!i&&Er(e),o=n||r||i||a,s=o?hi(e.length,String):[],c=s.length;for(var u in e)!t&&!Ai.call(e,u)||o&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Tr(u,c))||s.push(u);return s},Fi=Object.prototype,xi=function(e){var t=e&&e.constructor;return e===(typeof t=="function"&&t.prototype||Fi)},Ii=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),Bi=Object.prototype.hasOwnProperty,Di=function(e){if(!xi(e))return Ii(e);var t=[];for(var n in Object(e))Bi.call(e,n)&&n!="constructor"&&t.push(n);return t},pt=function(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")},Ni="[object AsyncFunction]",Ri="[object Function]",Ui="[object GeneratorFunction]",Vi="[object Proxy]",Ar=function(e){if(!pt(e))return!1;var t=ae(e);return t==Ri||t==Ui||t==Ni||t==Vi},ht=function(e){return e!=null&&ft(e.length)&&!Ar(e)},vt=function(e){return ht(e)?Li(e):Di(e)},Lr=function(e,t){return function(n,r){if(n==null)return n;if(!ht(n))return e(n,r);for(var i=n.length,a=t?i:-1,o=Object(n);(t?a--:++a<i)&&r(o[a],a,o)!==!1;);return n}}(function(e,t){return e&&pi(e,t,vt)}),Wi=function(e,t){var n=[];return Lr(e,function(r,i,a){t(r,i,a)&&n.push(r)}),n},qi=function(){this.__data__=[],this.size=0},Fr=function(e,t){return e===t||e!=e&&t!=t},Re=function(e,t){for(var n=e.length;n--;)if(Fr(e[n][0],t))return n;return-1},zi=Array.prototype.splice,Ji=function(e){var t=this.__data__,n=Re(t,e);return!(n<0||(n==t.length-1?t.pop():zi.call(t,n,1),--this.size,0))},Hi=function(e){var t=this.__data__,n=Re(t,e);return n<0?void 0:t[n][1]},Gi=function(e){return Re(this.__data__,e)>-1},Ki=function(e,t){var n=this.__data__,r=Re(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function se(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}se.prototype.clear=qi,se.prototype.delete=Ji,se.prototype.get=Hi,se.prototype.has=Gi,se.prototype.set=Ki;var Ue=se,$i=function(){this.__data__=new Ue,this.size=0},Qi=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Zi=function(e){return this.__data__.get(e)},xr,Xi=function(e){return this.__data__.has(e)},mt=q["__core-js_shared__"],Ir=(xr=/[^.]+$/.exec(mt&&mt.keys&&mt.keys.IE_PROTO||""))?"Symbol(src)_1."+xr:"",Yi=function(e){return!!Ir&&Ir in e},ea=Function.prototype.toString,Z=function(e){if(e!=null){try{return ea.call(e)}catch{}try{return e+""}catch{}}return""},ta=/^\[object .+?Constructor\]$/,ra=Function.prototype,na=Object.prototype,ia=ra.toString,aa=na.hasOwnProperty,oa=RegExp("^"+ia.call(aa).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),sa=function(e){return!(!pt(e)||Yi(e))&&(Ar(e)?oa:ta).test(Z(e))},ca=function(e,t){return e==null?void 0:e[t]},ce=function(e,t){var n=ca(e,t);return sa(n)?n:void 0},be=ce(q,"Map"),we=ce(Object,"create"),ua=function(){this.__data__=we?we(null):{},this.size=0},la=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},da="__lodash_hash_undefined__",fa=Object.prototype.hasOwnProperty,pa=function(e){var t=this.__data__;if(we){var n=t[e];return n===da?void 0:n}return fa.call(t,e)?t[e]:void 0},ha=Object.prototype.hasOwnProperty,va=function(e){var t=this.__data__;return we?t[e]!==void 0:ha.call(t,e)},ma="__lodash_hash_undefined__",ga=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=we&&t===void 0?ma:t,this};function ue(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ue.prototype.clear=ua,ue.prototype.delete=la,ue.prototype.get=pa,ue.prototype.has=va,ue.prototype.set=ga;var Br=ue,ya=function(){this.size=0,this.__data__={hash:new Br,map:new(be||Ue),string:new Br}},ba=function(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null},Ve=function(e,t){var n=e.__data__;return ba(t)?n[typeof t=="string"?"string":"hash"]:n.map},wa=function(e){var t=Ve(this,e).delete(e);return this.size-=t?1:0,t},_a=function(e){return Ve(this,e).get(e)},ka=function(e){return Ve(this,e).has(e)},Ma=function(e,t){var n=Ve(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function le(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}le.prototype.clear=ya,le.prototype.delete=wa,le.prototype.get=_a,le.prototype.has=ka,le.prototype.set=Ma;var We=le,Sa=200,Ca=function(e,t){var n=this.__data__;if(n instanceof Ue){var r=n.__data__;if(!be||r.length<Sa-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new We(r)}return n.set(e,t),this.size=n.size,this};function de(e){var t=this.__data__=new Ue(e);this.size=t.size}de.prototype.clear=$i,de.prototype.delete=Qi,de.prototype.get=Zi,de.prototype.has=Xi,de.prototype.set=Ca;var qe=de,Ta="__lodash_hash_undefined__",Oa=function(e){return this.__data__.set(e,Ta),this},ja=function(e){return this.__data__.has(e)};function ze(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new We;++t<n;)this.add(e[t])}ze.prototype.add=ze.prototype.push=Oa,ze.prototype.has=ja;var Pa=ze,Ea=function(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},Aa=function(e,t){return e.has(t)},La=1,Fa=2,Dr=function(e,t,n,r,i,a){var o=n&La,s=e.length,c=t.length;if(s!=c&&!(o&&c>s))return!1;var u=a.get(e);if(u&&a.get(t))return u==t;var d=-1,f=!0,p=n&Fa?new Pa:void 0;for(a.set(e,t),a.set(t,e);++d<s;){var m=e[d],k=t[d];if(r)var C=o?r(k,m,d,t,e,a):r(m,k,d,e,t,a);if(C!==void 0){if(C)continue;f=!1;break}if(p){if(!Ea(t,function(E,v){if(!Aa(p,v)&&(m===E||i(m,E,n,r,a)))return p.push(v)})){f=!1;break}}else if(m!==k&&!i(m,k,n,r,a)){f=!1;break}}return a.delete(e),a.delete(t),f},Nr=q.Uint8Array,xa=function(e){var t=-1,n=Array(e.size);return e.forEach(function(r,i){n[++t]=[i,r]}),n},Ia=function(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n},Ba=1,Da=2,Na="[object Boolean]",Ra="[object Date]",Ua="[object Error]",Va="[object Map]",Wa="[object Number]",qa="[object RegExp]",za="[object Set]",Ja="[object String]",Ha="[object Symbol]",Ga="[object ArrayBuffer]",Ka="[object DataView]",Rr=H?H.prototype:void 0,gt=Rr?Rr.valueOf:void 0,$a=function(e,t,n,r,i,a,o){switch(n){case Ka:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ga:return!(e.byteLength!=t.byteLength||!a(new Nr(e),new Nr(t)));case Na:case Ra:case Wa:return Fr(+e,+t);case Ua:return e.name==t.name&&e.message==t.message;case qa:case Ja:return e==t+"";case Va:var s=xa;case za:var c=r&Ba;if(s||(s=Ia),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;r|=Da,o.set(e,t);var d=Dr(s(e),s(t),r,i,a,o);return o.delete(e),d;case Ha:if(gt)return gt.call(e)==gt.call(t)}return!1},Qa=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},Za=function(e,t,n){var r=t(e);return F(e)?r:Qa(r,n(e))},Xa=function(){return[]},Ya=Object.prototype.propertyIsEnumerable,Ur=Object.getOwnPropertySymbols,eo=Ur?function(e){return e==null?[]:(e=Object(e),br(Ur(e),function(t){return Ya.call(e,t)}))}:Xa,Vr=function(e){return Za(e,vt,eo)},to=1,ro=Object.prototype.hasOwnProperty,no=function(e,t,n,r,i,a){var o=n&to,s=Vr(e),c=s.length;if(c!=Vr(t).length&&!o)return!1;for(var u=c;u--;){var d=s[u];if(!(o?d in t:ro.call(t,d)))return!1}var f=a.get(e);if(f&&a.get(t))return f==t;var p=!0;a.set(e,t),a.set(t,e);for(var m=o;++u<c;){var k=e[d=s[u]],C=t[d];if(r)var E=o?r(C,k,d,t,e,a):r(k,C,d,e,t,a);if(!(E===void 0?k===C||i(k,C,n,r,a):E)){p=!1;break}m||(m=d=="constructor")}if(p&&!m){var v=e.constructor,Ye=t.constructor;v!=Ye&&"constructor"in e&&"constructor"in t&&!(typeof v=="function"&&v instanceof v&&typeof Ye=="function"&&Ye instanceof Ye)&&(p=!1)}return a.delete(e),a.delete(t),p},yt=ce(q,"DataView"),bt=ce(q,"Promise"),wt=ce(q,"Set"),_t=ce(q,"WeakMap"),io=Z(yt),ao=Z(be),oo=Z(bt),so=Z(wt),co=Z(_t),X=ae;(yt&&X(new yt(new ArrayBuffer(1)))!="[object DataView]"||be&&X(new be)!="[object Map]"||bt&&X(bt.resolve())!="[object Promise]"||wt&&X(new wt)!="[object Set]"||_t&&X(new _t)!="[object WeakMap]")&&(X=function(e){var t=ae(e),n=t=="[object Object]"?e.constructor:void 0,r=n?Z(n):"";if(r)switch(r){case io:return"[object DataView]";case ao:return"[object Map]";case oo:return"[object Promise]";case so:return"[object Set]";case co:return"[object WeakMap]"}return t});var Wr=X,uo=1,qr="[object Arguments]",zr="[object Array]",Je="[object Object]",Jr=Object.prototype.hasOwnProperty,lo=function(e,t,n,r,i,a){var o=F(e),s=F(t),c=o?zr:Wr(e),u=s?zr:Wr(t),d=(c=c==qr?Je:c)==Je,f=(u=u==qr?Je:u)==Je,p=c==u;if(p&&dt(e)){if(!dt(t))return!1;o=!0,d=!1}if(p&&!d)return a||(a=new qe),o||Er(e)?Dr(e,t,n,r,i,a):$a(e,t,c,n,r,i,a);if(!(n&uo)){var m=d&&Jr.call(e,"__wrapped__"),k=f&&Jr.call(t,"__wrapped__");if(m||k){var C=m?e.value():e,E=k?t.value():t;return a||(a=new qe),i(C,E,n,r,a)}}return!!p&&(a||(a=new qe),no(e,t,n,r,i,a))},Hr=function e(t,n,r,i,a){return t===n||(t==null||n==null||!oe(t)&&!oe(n)?t!=t&&n!=n:lo(t,n,r,i,e,a))},fo=1,po=2,ho=function(e,t,n,r){var i=n.length,a=i,o=!r;if(e==null)return!a;for(e=Object(e);i--;){var s=n[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){var c=(s=n[i])[0],u=e[c],d=s[1];if(o&&s[2]){if(u===void 0&&!(c in e))return!1}else{var f=new qe;if(r)var p=r(u,d,c,e,t,f);if(!(p===void 0?Hr(d,u,fo|po,r,f):p))return!1}}return!0},Gr=function(e){return e==e&&!pt(e)},vo=function(e){for(var t=vt(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Gr(i)]}return t},Kr=function(e,t){return function(n){return n!=null&&n[e]===t&&(t!==void 0||e in Object(n))}},mo=function(e){var t=vo(e);return t.length==1&&t[0][2]?Kr(t[0][0],t[0][1]):function(n){return n===e||ho(n,e,t)}},go="[object Symbol]",_e=function(e){return typeof e=="symbol"||oe(e)&&ae(e)==go},yo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bo=/^\w*$/,kt=function(e,t){if(F(e))return!1;var n=typeof e;return!(n!="number"&&n!="symbol"&&n!="boolean"&&e!=null&&!_e(e))||bo.test(e)||!yo.test(e)||t!=null&&e in Object(t)},wo="Expected a function";function Mt(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(wo);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(Mt.Cache||We),n}Mt.Cache=We;var _o=Mt,ko=500,Mo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,So=/\\(\\)?/g,Co=function(e){var t=_o(e,function(r){return n.size===ko&&n.clear(),r}),n=t.cache;return t}(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Mo,function(n,r,i,a){t.push(i?a.replace(So,"$1"):r||n)}),t}),St=function(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},To=1/0,$r=H?H.prototype:void 0,Qr=$r?$r.toString:void 0,Oo=function e(t){if(typeof t=="string")return t;if(F(t))return St(t,e)+"";if(_e(t))return Qr?Qr.call(t):"";var n=t+"";return n=="0"&&1/t==-To?"-0":n},jo=function(e){return e==null?"":Oo(e)},Zr=function(e,t){return F(e)?e:kt(e,t)?[e]:Co(jo(e))},Po=1/0,He=function(e){if(typeof e=="string"||_e(e))return e;var t=e+"";return t=="0"&&1/e==-Po?"-0":t},Xr=function(e,t){for(var n=0,r=(t=Zr(t,e)).length;e!=null&&n<r;)e=e[He(t[n++])];return n&&n==r?e:void 0},Eo=function(e,t,n){var r=e==null?void 0:Xr(e,t);return r===void 0?n:r},Ao=function(e,t){return e!=null&&t in Object(e)},Lo=function(e,t,n){for(var r=-1,i=(t=Zr(t,e)).length,a=!1;++r<i;){var o=He(t[r]);if(!(a=e!=null&&n(e,o)))break;e=e[o]}return a||++r!=i?a:!!(i=e==null?0:e.length)&&ft(i)&&Tr(o,i)&&(F(e)||Cr(e))},Fo=function(e,t){return e!=null&&Lo(e,t,Ao)},xo=1,Io=2,Bo=function(e,t){return kt(e)&&Gr(t)?Kr(He(e),t):function(n){var r=Eo(n,e);return r===void 0&&r===t?Fo(n,e):Hr(t,r,xo|Io)}},Yr=function(e){return e},Do=function(e){return function(t){return t==null?void 0:t[e]}},No=function(e){return function(t){return Xr(t,e)}},Ro=function(e){return kt(e)?Do(He(e)):No(e)},en=function(e){return typeof e=="function"?e:e==null?Yr:typeof e=="object"?F(e)?Bo(e[0],e[1]):mo(e):Ro(e)},tn=function(e,t){return(F(e)?br:Wi)(e,en(t))},Uo=function(e,t){var n=-1,r=ht(e)?Array(e.length):[];return Lr(e,function(i,a,o){r[++n]=t(i,a,o)}),r},Vo=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e},Wo=function(e,t){if(e!==t){var n=e!==void 0,r=e===null,i=e==e,a=_e(e),o=t!==void 0,s=t===null,c=t==t,u=_e(t);if(!s&&!u&&!a&&e>t||a&&o&&c&&!s&&!u||r&&o&&c||!n&&c||!i)return 1;if(!r&&!a&&!u&&e<t||u&&n&&i&&!r&&!a||s&&n&&i||!o&&i||!c)return-1}return 0},qo=function(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;++r<o;){var c=Wo(i[r],a[r]);if(c)return r>=s?c:c*(n[r]=="desc"?-1:1)}return e.index-t.index},zo=function(e,t,n){var r=-1;t=St(t.length?t:[Yr],Or(en));var i=Uo(e,function(a,o,s){return{criteria:St(t,function(c){return c(a)}),index:++r,value:a}});return Vo(i,function(a,o){return qo(a,o,n)})},rn=function(e,t,n,r){return e==null?[]:(F(t)||(t=t==null?[]:[t]),F(n=r?void 0:n)||(n=n==null?[]:[n]),zo(e,t,n))},Ge=function(e,t,n){return Ho(e.local,t,n)===!0},Jo=function(e,t,n){return e.local.streams&&e.local.streams[t]&&e.local.streams[t].stream&&e.local.streams[t].stream["get".concat(n==="video"?"Video":"Audio","Tracks")]()[0]},ke=function(e,t,n,r){var i=Go(e,t,n,r);return i&&i.pendingTrack},Ho=function(e,t,n){if(!e)return!1;var r=function(a){switch(a){case"avatar":return!0;case"staged":return a;default:return!!a}},i=e.public.subscribedTracks;return i&&i[t]?["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(n)===-1&&i[t].custom?[!0,"staged"].includes(i[t].custom)?r(i[t].custom):r(i[t].custom[n]):r(i[t][n]):!i||r(i.ALL)},Go=function(e,t,n,r){var i=rn(tn(e.streams,function(a){return a.participantId===t&&a.type===n&&a.pendingTrack&&a.pendingTrack.kind===r}),"starttime","desc");return i&&i[0]},Ko=function(e,t){var n=e.local.public.customTracks;if(n&&n[t])return n[t].track},$o=function(e,t,n,r){var i="soup-"+n,a=rn(tn(e.streams,function(o){return o.participantId===t&&o.streamId===i&&o.pendingTrack&&o.pendingTrack.kind===r}),"starttime","desc");return a&&a[0]&&a[0].pendingTrack};function nn(e){for(var t=store.getState(),n=0,r=["cam","screen"];n<r.length;n++)for(var i=r[n],a=0,o=["video","audio"];a<o.length;a++){var s=o[a],c=i==="cam"?s:"screen".concat(s.charAt(0).toUpperCase()+s.slice(1)),u=e.tracks[c];if(u){var d=e.local?Jo(t,i,s):ke(t,e.session_id,i,s);u.state==="playable"&&(u.track=d),u.persistentTrack=d}}}function an(e){try{var t=store.getState();for(var n in e.tracks)if(!Ct(n)){var r=e.tracks[n].kind;if(r){var i=e.tracks[n];if(i){var a=e.local?Ko(t,n,r):$o(t,e.session_id,n,r);i.state==="playable"&&(e.tracks[n].track=a),i.persistentTrack=a}}else console.error("unknown type for custom track")}}catch(o){console.error(o)}}function Ct(e){return["video","audio","screenVideo","screenAudio"].includes(e)}function on(e,t){var n=store.getState();if(e.local){if(e.audio)try{e.audioTrack=n.local.streams.cam.stream.getAudioTracks()[0],e.audioTrack||(e.audio=!1)}catch{}if(e.video)try{e.videoTrack=n.local.streams.cam.stream.getVideoTracks()[0],e.videoTrack||(e.video=!1)}catch{}if(e.screen)try{e.screenVideoTrack=n.local.streams.screen.stream.getVideoTracks()[0],e.screenAudioTrack=n.local.streams.screen.stream.getAudioTracks()[0],e.screenVideoTrack||e.screenAudioTrack||(e.screen=!1)}catch{}}else{var r=!0;try{var i=n.participants[e.session_id];i&&i.public&&i.public.rtcType&&i.public.rtcType.impl==="peer-to-peer"&&i.private&&!["connected","completed"].includes(i.private.peeringState)&&(r=!1)}catch(u){console.error(u)}if(!r)return e.audio=!1,e.audioTrack=!1,e.video=!1,e.videoTrack=!1,e.screen=!1,void(e.screenTrack=!1);try{if(n.streams,e.audio&&Ge(n,e.session_id,"cam-audio")){var a=ke(n,e.session_id,"cam","audio");a&&(t&&t.audioTrack&&t.audioTrack.id===a.id?e.audioTrack=a:a.muted||(e.audioTrack=a)),e.audioTrack||(e.audio=!1)}if(e.video&&Ge(n,e.session_id,"cam-video")){var o=ke(n,e.session_id,"cam","video");o&&(t&&t.videoTrack&&t.videoTrack.id===o.id?e.videoTrack=o:o.muted||(e.videoTrack=o)),e.videoTrack||(e.video=!1)}if(e.screen&&Ge(n,e.session_id,"screen-audio")){var s=ke(n,e.session_id,"screen","audio");s&&(t&&t.screenAudioTrack&&t.screenAudioTrack.id===s.id?e.screenAudioTrack=s:s.muted||(e.screenAudioTrack=s))}if(e.screen&&Ge(n,e.session_id,"screen-video")){var c=ke(n,e.session_id,"screen","video");c&&(t&&t.screenVideoTrack&&t.screenVideoTrack.id===c.id?e.screenVideoTrack=c:c.muted||(e.screenVideoTrack=c))}e.screenVideoTrack||e.screenAudioTrack||(e.screen=!1)}catch(u){console.error("unexpected error matching up tracks",u)}}}function sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sn(Object(n),!0).forEach(function(r){R(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Qo(e){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var n,r=W(e);if(t){var i=W(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fe(this,n)}}var cn="video",Zo="voice",Xo=3,un={present:0,hidden:0},Tt={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},ln=["state","simulcastEncodings"],dn={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},Ke={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string"}},Y={customTrayButtons:{validate:vn,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(Ke))},url:{validate:function(e){return typeof e=="string"},help:"url should be a string"},baseUrl:{validate:function(e){return typeof e=="string"},help:"baseUrl should be a string"},token:{validate:function(e){return typeof e=="string"},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(e){return window._dailyConfig||(window._dailyConfig={}),window._dailyConfig.experimentalGetUserMediaConstraintsModify=e.experimentalGetUserMediaConstraintsModify,window._dailyConfig.userMediaVideoConstraints=e.userMediaVideoConstraints,window._dailyConfig.userMediaAudioConstraints=e.userMediaAudioConstraints,window._dailyConfig.callObjectBundleUrlOverride=e.callObjectBundleUrlOverride,!0}},reactNativeConfig:{validate:function(e){return function t(n,r){if(r===void 0)return!1;switch(O(r)){case"string":return O(n)===r;case"object":if(O(n)!=="object")return!1;for(var i in n)if(!t(n[i],r[i]))return!1;return!0;default:return!1}}(e,dn)},help:"reactNativeConfig should look like ".concat(JSON.stringify(dn),", all fields optional")},lang:{validate:function(e){return["de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","ru","sv","tr","user"].includes(e)},help:"language not supported. Options are: de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, ru, sv, tr, user"},userName:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(e,t){return t._preloadCache.videoDeviceId=e,!0}},audioSource:{validate:function(e,t){return t._preloadCache.audioDeviceId=e,!0}},subscribeToTracksAutomatically:{validate:function(e,t){return t._preloadCache.subscribeToTracksAutomatically=e,!0}},theme:{validate:function(e){var t=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],n=function(r){for(var i=0,a=Object.keys(r);i<a.length;i++){var o=a[i];if(!t.includes(o))return console.error('unsupported color "'.concat(o,'". Valid colors: ').concat(t.join(", "))),!1;if(!r[o].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(o,' theme color should be provided in valid hex color format. Received: "').concat(r[o],'"')),!1}return!0};return O(e)==="object"&&("light"in e&&"dark"in e||"colors"in e)?"light"in e&&"dark"in e?"colors"in e.light?"colors"in e.dark?n(e.light.colors)&&n(e.dark.colors):(console.error('Dark theme is missing "colors" property.',e),!1):(console.error('Light theme is missing "colors" property.',e),!1):n(e.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',e),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(e){if("grid"in e){var t=e.grid;if("maxTilesPerPage"in t){if(!Number.isInteger(t.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(t.maxTilesPerPage,".")),!1;if(t.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in t){if(!Number.isInteger(t.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(t.minTilesPerPage,".")),!1;if(t.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in t&&t.minTilesPerPage>t.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(e){return fn(e,{allowAllParticipantsKey:!1})},help:hn({allowAllParticipantsKey:!1})},inputSettings:{validate:function(e){return pn(e)},help:Ot()},layout:{validate:function(e){return e==="custom-v1"||e==="browser"||e==="none"},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"}},$e={styles:{validate:function(e){for(var t in e)if(t!=="cam"&&t!=="screen")return!1;if(e.cam){for(var t in e.cam)if(t!=="div"&&t!=="video")return!1}if(e.screen){for(var t in e.screen)if(t!=="div"&&t!=="video")return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(e,t,n){if(t._preloadCache.subscribeToTracksAutomatically)return!1;var r=[!0,!1,"staged"];if(r.includes(e)||!_()&&e==="avatar")return!0;var i=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"];return function a(o){var s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];for(var c in o)if(c==="custom"){if(!r.includes(o[c])&&!a(o[c],!0))return!1}else{var u=!s&&!i.includes(c),d=!r.includes(o[c]);if(u||d)return!1}return!0}(e)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(_()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,eject:!0};function Me(e){var t={};for(var n in e)e[n]instanceof MediaStreamTrack?t[n]=Ie:(n==="dailyConfig"&&(e[n].modifyLocalSdpHook&&(window._dailyConfig&&(window._dailyConfig.modifyLocalSdpHook=e[n].modifyLocalSdpHook),delete e[n].modifyLocalSdpHook),e[n].modifyRemoteSdpHook&&(window._dailyConfig&&(window._dailyConfig.modifyRemoteSdpHook=e[n].modifyRemoteSdpHook),delete e[n].modifyRemoteSdpHook)),t[n]=e[n]);return t}function g(){if(_())throw new Error("This daily-js method is not currently supported in React Native")}function Se(){if(!_())throw new Error("This daily-js method is only supported in React Native")}function fn(e,t){for(var n=t.allowAllParticipantsKey,r=function(f){var p=["local"];return n||p.push("*"),f&&!p.includes(f)},i=function(f){return!!(f.layer===void 0||Number.isInteger(f.layer)&&f.layer>=0||f.layer==="inherit")},a=function(f){return!!f&&!(f.video&&!i(f.video))&&!(f.screenVideo&&!i(f.screenVideo))},o=0,s=Object.entries(e);o<s.length;o++){var c=tt(s[o],2),u=c[0],d=c[1];if(!r(u)||!a(d))return!1}return!0}function pn(e){return O(e)==="object"&&!(!e.video||O(e.video)!=="object")&&!!function(t){var n=["type","config","publish"];return!t||O(t)!=="object"||Object.keys(t).length===0||t.type&&!function(r){return typeof r!="string"?!1:Object.values(Be).includes(r)?!0:(console.error("inputSettings video processor type invalid"),!1)}(t.type)||t.publish!==void 0&&typeof t.publish!="boolean"||(typeof t.publish=="boolean"&&console.warn("inputSettings.video.processor: publish key has been deprecated; it will be ignored"),t.config&&(O(t.config)!=="object"||!function(r,i){var a=Object.keys(i);if(a.length===0)return!0;var o="invalid object in inputSettings -> video -> processor -> config";switch(r){case Be.BGBLUR:return a.length>1||a[0]!=="strength"?(console.error(o),!1):!(typeof i.strength!="number"||i.strength<=0||i.strength>1||isNaN(i.strength))||(console.error("".concat(o,"; expected: {0 < strength <= 1}, got: ").concat(i.strength)),!1);case Be.BGIMAGE:return!(i.source!==void 0&&!function(s){if(s.source==="default")return s.type="default",!0;if(ct(s.source))return s.type="url",!!function(d){var f=new URL(d),p=f.pathname;if(f.protocol==="data:")try{var m=p.substring(p.indexOf(":")+1,p.indexOf(";")),k=m.split("/")[1];return st.includes(k)}catch(E){return console.error("failed to deduce blob content type",E),!1}var C=p.split(".").at(-1).toLowerCase().trim();return st.includes(C)}(s.source)||(console.error("invalid image type; supported types: [".concat(st.join(", "),"]")),!1);return c=s.source,u=Number(c),isNaN(u)||!Number.isInteger(u)||u<=0||u>sr?(console.error("invalid image selection; must be an int, > 0, <= ".concat(sr)),!1):(s.type="daily-preselect",!0);var c,u}(i));default:return!0}}(t.type,t.config)))?!1:(Object.keys(t).filter(function(r){return!n.includes(r)}).forEach(function(r){console.warn("invalid key inputSettings -> video -> processor : ".concat(r)),delete t[r]}),!0)}(e.video.processor)}function Ot(){var e=Object.values(Be).join(" | ");return"inputSettings must be of the form: { video: { processor: [ ".concat(e," ] }, config?: {} }")}function hn(e){var t=e.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat(zn).concat(t?' | "'.concat(Jn,'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function vn(e){if(e&&O(e)!=="object"||Array.isArray(e))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(Ke),".")),!1;if(e)for(var t=0,n=Object.entries(e);t<n.length;t++)for(var r=tt(n[t],1)[0],i=0,a=Object.entries(e[r]);i<a.length;i++){var o=tt(a[i],2),s=o[0],c=o[1];if(s==="iconPath"&&!ct(c)||s==="iconPathDarkMode"&&!ct(c))return console.error("customTrayButton ".concat(s," should be a url.")),!1;var u=Ke.id[s];if(!u)return console.error("customTrayButton does not support key ".concat(s)),!1;if(O(c)!==u)return console.error("customTrayButton ".concat(s," should be a ").concat(u,".")),!1}return!0}function mn(e){if(O(e)!=="object")throw new Error('RemoteMediaPlayerSettings: must be "object" type');if(!e.state||!Object.values(ot).includes(e.state))throw new Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(ot))}function gn(e,t,n){return!(typeof e!="number"||e<t||e>n)}const Yo=function(e){Le(n,M.exports);var t=Qo(n);function n(r){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(B(this,n),i=t.call(this),R(D(i),"startListeningForDeviceChanges",function(){navigator.mediaDevices.ondevicechange!==void 0||_()?navigator.mediaDevices.addEventListener("devicechange",i.deviceChangeListener):i.startPollingForDeviceChanges()}),R(D(i),"stopListeningForDeviceChanges",function(){navigator.mediaDevices.ondevicechange!==void 0||_()?navigator.mediaDevices.removeEventListener("devicechange",i.deviceChangeListener):i.stopPollingForDeviceChanges()}),R(D(i),"deviceChangeListener",h(function*(){var s=yield i.enumerateDevices();i.handleDeviceChange(s.devices)})),R(D(i),"handleDeviceChange",function(s){i.emit(or,{action:or,availableDevices:s})}),R(D(i),"startPollingForDeviceChanges",function(){i._deviceChangeInterval||(i._deviceChangeInterval=setInterval(h(function*(){var s=yield i.enumerateDevices(),c=JSON.stringify(s);i._lastDevicesJSON&&c!==i._lastDevicesJSON&&i.handleDeviceChange(s.devices),i._lastDevicesJSON=c}),3e3))}),R(D(i),"stopPollingForDeviceChanges",function(){i._deviceChangeInterval&&(clearInterval(i._deviceChangeInterval),i._deviceChangeInterval=null,i._lastDevicesJSON=null)}),R(D(i),"handleNativeAppActiveStateChange",function(s){i.disableReactNativeAutoDeviceManagement("video")||(s?i.camUnmutedBeforeLosingNativeActiveState&&i.setLocalVideo(!0):(i.camUnmutedBeforeLosingNativeActiveState=i.localVideo(),i.camUnmutedBeforeLosingNativeActiveState&&i.setLocalVideo(!1)))}),R(D(i),"handleNativeAudioFocusChange",function(s){i.disableReactNativeAutoDeviceManagement("audio")||(i._hasNativeAudioFocus=s,i.toggleParticipantAudioBasedOnNativeAudioFocus(),i._hasNativeAudioFocus?i.micUnmutedBeforeLosingNativeAudioFocus&&i.setLocalAudio(!0):(i.micUnmutedBeforeLosingNativeAudioFocus=i.localAudio(),i.setLocalAudio(!1)))}),a.dailyJsVersion=n.version(),i._iframe=r,i._callObjectMode=a.layout==="none"&&!i._iframe,i._preloadCache={subscribeToTracksAutomatically:!0,audioDeviceId:null,videoDeviceId:null,outputDeviceId:null},i._callObjectMode&&(window._dailyPreloadCache=i._preloadCache),a.showLocalVideo!==void 0?i._callObjectMode?console.error("showLocalVideo is not available in call object mode"):i._showLocalVideo=!!a.showLocalVideo:i._showLocalVideo=!0,a.showParticipantsBar!==void 0?i._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):i._showParticipantsBar=!!a.showParticipantsBar:i._showParticipantsBar=!0,a.customTrayButtons!==void 0?i._callObjectMode?console.error("customTrayButtons is not available in call object mode"):i._customTrayButtons=a.customTrayButtons:i._customTrayButtons={},a.activeSpeakerMode!==void 0?i._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):i._activeSpeakerMode=!!a.activeSpeakerMode:i._activeSpeakerMode=!1,a.receiveSettings?i._callObjectMode?i._receiveSettings=a.receiveSettings:console.error("receiveSettings is only available in call object mode"):i._receiveSettings={},i._inputSettings={},a.inputSettings&&(i._inputSettings=a.inputSettings),i.validateProperties(a),i.properties=T({},a),i._callObjectLoader=i._callObjectMode?new ci:null,i._meetingState=ar,i._isPreparingToJoin=!1,i._accessState={access:at},i._nativeInCallAudioMode=cn,i._participants={},i._participantCounts=un,i._rmpPlayerState={},i._waitingParticipants={},i._inputEventsOn={},i._network={threshold:"good",quality:100},i._activeSpeaker={},i._callFrameId=Ne(),i._messageChannel=_()?new ri:new ei,i._iframe&&(i._iframe.requestFullscreen?i._iframe.addEventListener("fullscreenchange",function(s){document.fullscreenElement===i._iframe?(i.emit(re,{action:re}),i.sendMessageToCallMachine({action:re})):(i.emit(ne,{action:ne}),i.sendMessageToCallMachine({action:ne}))}):i._iframe.webkitRequestFullscreen&&i._iframe.addEventListener("webkitfullscreenchange",function(s){document.webkitFullscreenElement===i._iframe?(i.emit(re,{action:re}),i.sendMessageToCallMachine({action:re})):(i.emit(ne,{action:ne}),i.sendMessageToCallMachine({action:ne}))})),_()){var o=i.nativeUtils();o.addAudioFocusChangeListener&&o.removeAudioFocusChangeListener&&o.addAppActiveStateChangeListener&&o.removeAppActiveStateChangeListener||console.warn("expected (add|remove)(AudioFocus|AppActiveState)ChangeListener to be available in React Native"),i._hasNativeAudioFocus=!0,o.addAudioFocusChangeListener(i.handleNativeAudioFocusChange),o.addAppActiveStateChangeListener(i.handleNativeAppActiveStateChange)}return i._callObjectMode&&i.startListeningForDeviceChanges(),i._messageChannel.addListenerForMessagesFromCallMachine(i.handleMessageFromCallMachine,i._callFrameId,D(i)),i}return N(n,null,[{key:"supportedBrowser",value:function(){if(_())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!1,supportsSfu:!0,supportsVideoProcessing:!1};var r=class{static getParser(i,a=!1){if(typeof i!="string")throw new Error("UserAgent should be a string");return new ir(i,a)}static parse(i){return new ir(i).getResult()}static get BROWSER_MAP(){return nr}static get ENGINE_MAP(){return J}static get OS_MAP(){return P}static get PLATFORMS_MAP(){return S}}.getParser(U());return{supported:!!dr(),mobile:r.getPlatformType()==="mobile",name:r.getBrowserName(),version:r.getBrowserVersion(),supportsFullscreen:!!ur(),supportsScreenShare:!!Qn(),supportsSfu:!!lr(),supportsVideoProcessing:Xn()}}},{key:"version",value:function(){return"0.29.0-alpha.1"}},{key:"createCallObject",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r.layout="none",new n(null,r)}},{key:"wrap",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(g(),!r||!r.contentWindow||typeof r.src!="string")throw new Error("DailyIframe::Wrap needs an iframe-like first argument");return i.layout||(i.customLayout?i.layout="custom-v1":i.layout="browser"),new n(r,i)}},{key:"createFrame",value:function(r,i){var a,o;g(),r&&i?(a=r,o=i):r&&r.append?(a=r,o={}):(a=document.body,o=r||{});var s=o.iframeStyle;s||(s=a===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var c=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?c.allow="microphone, camera":c.allow="microphone; camera; autoplay; display-capture",c.style.visibility="hidden",a.appendChild(c),c.style.visibility=null,Object.keys(s).forEach(function(u){return c.style[u]=s[u]}),o.layout||(o.customLayout?o.layout="custom-v1":o.layout="browser");try{return new n(c,o)}catch(u){throw a.removeChild(c),u}}},{key:"createTransparentFrame",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g();var i=document.createElement("iframe");return i.allow="microphone; camera; autoplay",i.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
      pointer-events: none;
    `,document.body.appendChild(i),r.layout||(r.layout="custom-v1"),n.wrap(i,r)}}]),N(n,[{key:"destroy",value:function(){var r=h(function*(){try{[j,it].includes(this._meetingState)&&(yield this.leave())}catch{}var i=this._iframe;if(i){var a=i.parentElement;a&&a.removeChild(i)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),_()){var o=this.nativeUtils();o.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),o.removeAppActiveStateChangeListener(this.handleNativeAppActiveStateChange)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars()});return function(){return r.apply(this,arguments)}}()},{key:"loadCss",value:function(r){var i=r.bodyClass,a=r.cssFile,o=r.cssText;return g(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(a),bodyClass:i,cssText:o}),this}},{key:"iframe",value:function(){return g(),this._iframe}},{key:"meetingState",value:function(){return this._meetingState}},{key:"accessState",value:function(){if(!this._callObjectMode)throw new Error("accessState() currently only supported in call object mode");return this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){if(!this._callObjectMode)throw new Error("waitingParticipants() currently only supported in call object mode");return this._waitingParticipants}},{key:"validateParticipantProperties",value:function(r,i){for(var a in i){if(!$e[a])throw new Error("unrecognized updateParticipant property ".concat(a));if($e[a].validate&&!$e[a].validate(i[a],this,this._participants[r]))throw new Error($e[a].help)}}},{key:"updateParticipant",value:function(r,i){return this._participants.local&&this._participants.local.session_id===r&&(r="local"),r&&i&&this._participants[r]&&(this.validateParticipantProperties(r,i),this.sendMessageToCallMachine({action:"update-participant",id:r,properties:i})),this}},{key:"updateParticipants",value:function(r){var i=this._participants.local&&this._participants.local.session_id;for(var a in r)a===i&&(a="local"),a&&r[a]&&(this._participants[a]||a==="*")?this.validateParticipantProperties(a,r[a]):(console.warn("unrecognized participant in updateParticipants: ".concat(a)),delete r[a]);return this.sendMessageToCallMachine({action:"update-participants",participants:r}),this}},{key:"updateWaitingParticipant",value:function(){var r=h(function*(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this._callObjectMode)throw new Error("updateWaitingParticipant() currently only supported in call object mode");if(this._meetingState!==j)throw new Error("updateWaitingParticipant() only supported for joined meetings");if(typeof a!="string"||O(o)!=="object")throw new Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise(function(s,c){i.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:a,updates:o},function(u){u.error&&c(u.error),u.id||c(new Error("unknown error in updateWaitingParticipant()")),s({id:u.id})})})});return function(){return r.apply(this,arguments)}}()},{key:"updateWaitingParticipants",value:function(){var r=h(function*(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._callObjectMode)throw new Error("updateWaitingParticipants() currently only supported in call object mode");if(this._meetingState!==j)throw new Error("updateWaitingParticipants() only supported for joined meetings");if(O(a)!=="object")throw new Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise(function(o,s){i.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:a},function(c){c.error&&s(c.error),c.ids||s(new Error("unknown error in updateWaitingParticipants()")),o({ids:c.ids})})})});return function(){return r.apply(this,arguments)}}()},{key:"requestAccess",value:function(){var r=h(function*(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=a.access,s=o===void 0?{level:"full"}:o,c=a.name,u=c===void 0?"":c;if(!this._callObjectMode)throw new Error("requestAccess() currently only supported in call object mode");if(this._meetingState!==j)throw new Error("requestAccess() only supported for joined meetings");return new Promise(function(d,f){i.sendMessageToCallMachine({action:"daily-method-request-access",access:s,name:u},function(p){p.error&&f(p.error),p.access||f(new Error("unknown error in requestAccess()")),d({access:p.access,granted:p.granted})})})});return function(){return r.apply(this,arguments)}}()},{key:"localAudio",value:function(){return this._participants.local?this._participants.local.audio:null}},{key:"localVideo",value:function(){return this._participants.local?this._participants.local.video:null}},{key:"setLocalAudio",value:function(r){return this.sendMessageToCallMachine({action:"local-audio",state:r}),this}},{key:"setLocalVideo",value:function(r){return this.sendMessageToCallMachine({action:"local-video",state:r}),this}},{key:"getReceiveSettings",value:function(){var r=h(function*(i){var a=this,o=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).showInheritedValues,s=o!==void 0&&o;if(!this._callObjectMode)throw new Error("getReceiveSettings() only supported in call object mode");switch(O(i)){case"string":return new Promise(function(c){a.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:i,showInheritedValues:s},function(u){c(u.receiveSettings)})});case"undefined":return this._receiveSettings;default:throw new Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}});return function(i){return r.apply(this,arguments)}}()},{key:"updateReceiveSettings",value:function(){var r=h(function*(i){var a=this;if(!this._callObjectMode)throw new Error("updateReceiveSettings() only supported in call object mode");if(!fn(i,{allowAllParticipantsKey:!0}))throw new Error(hn({allowAllParticipantsKey:!0}));if(this._meetingState!==j)throw new Error("updateReceiveSettings() is only allowed when joined. To specify receive settings earlier, use the receiveSettings config property.");return new Promise(function(o){a.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:i},function(s){o({receiveSettings:s.receiveSettings})})})});return function(i){return r.apply(this,arguments)}}()},{key:"getInputSettings",value:function(){var r=this;return new Promise(function(i){i(r._inputSettings)})}},{key:"updateInputSettings",value:function(){var r=h(function*(i){var a=this;return new Promise(function(o,s){if(!pn(i))return console.error(Ot()),void s(Ot());a.sendMessageToCallMachine({action:"update-input-settings",inputSettings:i},function(c){c.error?s(c.error):o({inputSettings:c.inputSettings})})})});return function(i){return r.apply(this,arguments)}}()},{key:"setBandwidth",value:function(r){var i=r.kbs,a=r.trackConstraints;return g(),this.sendMessageToCallMachine({action:"set-bandwidth",kbs:i,trackConstraints:a}),this}},{key:"getDailyLang",value:function(){var r=this;return g(),new Promise(function(){var i=h(function*(a){r.sendMessageToCallMachine({action:"get-daily-lang"},function(o){delete o.action,delete o.callbackStamp,a(o)})});return function(a){return i.apply(this,arguments)}}())}},{key:"setDailyLang",value:function(r){return g(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:r}),this}},{key:"getMeetingSession",value:function(){var r=h(function*(){var i=this;if(this._meetingState!==j)throw new Error("getMeetingSession() is only allowed when joined");return new Promise(function(){var a=h(function*(o){i.sendMessageToCallMachine({action:"get-meeting-session"},function(s){delete s.action,delete s.callbackStamp,delete s.callFrameId,o(s)})});return function(o){return a.apply(this,arguments)}}())});return function(){return r.apply(this,arguments)}}()},{key:"setUserName",value:function(r,i){var a=this;return this.properties.userName=r,new Promise(function(){var o=h(function*(s){a.sendMessageToCallMachine({action:"set-user-name",name:r!=null?r:"",thisMeetingOnly:_()||!!i&&!!i.thisMeetingOnly},function(c){delete c.action,delete c.callbackStamp,s(c)})});return function(s){return o.apply(this,arguments)}}())}},{key:"startCamera",value:function(){var r=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._callObjectMode)throw new Error("startCamera() currently only supported in call object mode");if([me,j].includes(this._meetingState))throw new Error("startCamera() not supported after joining a meeting: did you mean to use setLocalAudio() and/or setLocalVideo() instead?");return new Promise(function(){var a=h(function*(o,s){if(r.needsLoad())try{yield r.load(i)}catch(c){s(c)}else r.validateProperties(i);r.sendMessageToCallMachine({action:"start-camera",properties:Me(r.properties),preloadCache:Me(r._preloadCache)},function(c){delete c.action,delete c.callbackStamp,o(c)})});return function(o,s){return a.apply(this,arguments)}}())}},{key:"setCamera",value:function(r){var i=this;if(Se(),this.needsLoad())throw new Error("Before you can invoke setCamera, first you need to invoke one of these methods: join, startCamera, or preAuth");return new Promise(function(a,o){i.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:r},function(s){a({device:s.device})})})}},{key:"setAudioDevice",value:function(){var r=h(function*(i){return Se(),this.nativeUtils().setAudioDevice(i),{deviceId:yield this.nativeUtils().getAudioDevice()}});return function(i){return r.apply(this,arguments)}}()},{key:"cycleCamera",value:function(){var r=this;return new Promise(function(i,a){r.sendMessageToCallMachine({action:"cycle-camera"},function(o){i({device:o.device})})})}},{key:"cycleMic",value:function(){var r=this;return g(),new Promise(function(i,a){r.sendMessageToCallMachine({action:"cycle-mic"},function(o){i({device:o.device})})})}},{key:"getCameraFacingMode",value:function(){var r=this;return Se(),new Promise(function(i,a){r.sendMessageToCallMachine({action:"get-camera-facing-mode"},function(o){i(o.facingMode)})})}},{key:"setInputDevices",value:function(r){var i=r.audioDeviceId,a=r.videoDeviceId,o=r.audioSource,s=r.videoSource;return console.warn("setInputDevices() is deprecated: instead use setInputDevicesAsync(), which returns a Promise"),this.setInputDevicesAsync({audioDeviceId:i,videoDeviceId:a,audioSource:o,videoSource:s}),this}},{key:"setInputDevicesAsync",value:function(){var r=h(function*(i){var a=this,o=i.audioDeviceId,s=i.videoDeviceId,c=i.audioSource,u=i.videoSource;return g(),c!==void 0&&(o=c),u!==void 0&&(s=u),o&&(this._preloadCache.audioDeviceId=o),s&&(this._preloadCache.videoDeviceId=s),this._callObjectMode&&this.needsLoad()?{camera:{deviceId:this._preloadCache.videoDeviceId},mic:{deviceId:this._preloadCache.audioDeviceId},speaker:{deviceId:this._preloadCache.outputDeviceId}}:(o instanceof MediaStreamTrack&&(o=Ie),s instanceof MediaStreamTrack&&(s=Ie),new Promise(function(d){a.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:o,videoDeviceId:s},function(f){delete f.action,delete f.callbackStamp,f.returnPreloadCache?d({camera:{deviceId:a._preloadCache.videoDeviceId},mic:{deviceId:a._preloadCache.audioDeviceId},speaker:{deviceId:a._preloadCache.outputDeviceId}}):d(f)})}))});return function(i){return r.apply(this,arguments)}}()},{key:"setOutputDevice",value:function(r){var i=r.outputDeviceId;return console.warn("setOutputDevice() is deprecated: instead use setOutputDeviceAsync(), which returns a Promise"),this.setOutputDeviceAsync({outputDeviceId:i}),this}},{key:"setOutputDeviceAsync",value:function(){var r=h(function*(i){var a=this,o=i.outputDeviceId;return g(),o&&(this._preloadCache.outputDeviceId=o),this._callObjectMode&&this.needsLoad()?{camera:{deviceId:this._preloadCache.videoDeviceId},mic:{deviceId:this._preloadCache.audioDeviceId},speaker:{deviceId:this._preloadCache.outputDeviceId}}:new Promise(function(s){a.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:o},function(c){delete c.action,delete c.callbackStamp,c.returnPreloadCache?s({camera:{deviceId:a._preloadCache.videoDeviceId},mic:{deviceId:a._preloadCache.audioDeviceId},speaker:{deviceId:a._preloadCache.outputDeviceId}}):s(c)})})});return function(i){return r.apply(this,arguments)}}()},{key:"getInputDevices",value:function(){var r=h(function*(){var i=this;return this._callObjectMode&&this.needsLoad()?{camera:{deviceId:this._preloadCache.videoDeviceId},mic:{deviceId:this._preloadCache.audioDeviceId},speaker:{deviceId:this._preloadCache.outputDeviceId}}:new Promise(function(a,o){i.sendMessageToCallMachine({action:"get-input-devices"},function(s){delete s.action,delete s.callbackStamp,s.returnPreloadCache?a({camera:{deviceId:i._preloadCache.videoDeviceId},mic:{deviceId:i._preloadCache.audioDeviceId},speaker:{deviceId:i._preloadCache.outputDeviceId}}):a(s)})})});return function(){return r.apply(this,arguments)}}()},{key:"nativeInCallAudioMode",value:function(){return Se(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(r){if(Se(),[cn,Zo].includes(r)){if(r!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=r,!this.disableReactNativeAutoDeviceManagement("audio")&&this.isMeetingPendingOrOngoing(this._meetingState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",r)}},{key:"preAuth",value:function(){var r=h(function*(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this._callObjectMode)throw new Error("preAuth() currently only supported in call object mode");if([me,j].includes(this._meetingState))throw new Error("preAuth() not supported after joining a meeting");if(this.needsLoad()&&(yield this.load(a)),!a.url)throw new Error("preAuth() requires at least a url to be provided");var o=ie(a.url),s=ie(this.properties.url||this.properties.baseUrl);if(o!==s)throw new Error("url in preAuth() has a different bundle url than the one loaded (".concat(s," -> ").concat(o,")"));return this.validateProperties(a),this.properties=T(T({},this.properties),a),new Promise(function(c,u){i.sendMessageToCallMachine({action:"daily-method-preauth",properties:Me(i.properties)},function(d){return d.error?u(d.error):d.access?(i._didPreAuth=!0,void c({access:d.access})):u(new Error("unknown error in preAuth()"))})})});return function(){return r.apply(this,arguments)}}()},{key:"load",value:function(){var r=h(function*(i){var a=this;if(this.needsLoad()){if(i&&(this.validateProperties(i),this.properties=T(T({},this.properties),i)),!this._callObjectMode&&!this.properties.url)throw new Error("can't load iframe meeting because url property isn't set");this.updateMeetingState(it);try{this.emit("loading",{action:"loading"})}catch(o){console.log("could not emit 'loading'",o)}return this._callObjectMode?new Promise(function(o,s){a._callObjectLoader.cancel(),a._callObjectLoader.load(a.properties.url||a.properties.baseUrl,a._callFrameId,a.properties.dailyConfig&&a.properties.dailyConfig.avoidEval,function(c){a.updateMeetingState("loaded"),c&&a.emit("loaded",{action:"loaded"}),o()},function(c,u){a.emit("load-attempt-failed",{action:"load-attempt-failed",errorMsg:c}),u||(a.updateMeetingState(Q),a.resetMeetingDependentVars(),a.emit("error",{action:"error",errorMsg:c}),s(c))})}):(this._iframe.src=this.assembleMeetingUrl(),new Promise(function(o,s){a._loadedCallback=function(c){if(a._meetingState!==Q){for(var u in a.updateMeetingState("loaded"),(a.properties.cssFile||a.properties.cssText)&&a.loadCss(a.properties),a._inputEventsOn)a.sendMessageToCallMachine({action:"register-input-handler",on:u});o()}else s(c)}}))}});return function(i){return r.apply(this,arguments)}}()},{key:"join",value:function(){var r=h(function*(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(a)}catch(u){return this.updateIsPreparingToJoin(!1),Promise.reject(u)}}else{if(o=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(a.url&&a.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(a.token&&a.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(a.url){if(this._callObjectMode){var s=ie(a.url),c=ie(this.properties.url||this.properties.baseUrl);if(s!==c)return console.error("url in join() has a different bundle url than the one loaded (".concat(c," -> ").concat(s,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.properties.url=a.url}else if(a.url&&a.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(a.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject()}this.validateProperties(a),this.properties=T(T({},this.properties),a)}if(a.showLocalVideo!==void 0&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!a.showLocalVideo),a.showParticipantsBar!==void 0&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!a.showParticipantsBar),this._meetingState===j||this._meetingState===me)return console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1);this.updateMeetingState(me,!1);try{this.emit("joining-meeting",{action:"joining-meeting"})}catch(u){console.log("could not emit 'joining-meeting'",u)}return this.sendMessageToCallMachine({action:"join-meeting",properties:Me(this.properties),preloadCache:Me(this._preloadCache)}),new Promise(function(u,d){i._joinedCallback=function(f,p){if(i._meetingState!==Q){if(i.updateMeetingState(j),f)for(var m in f)i._callObjectMode&&(nn(f[m]),an(f[m]),on(f[m],i._participants[m])),i._participants[m]=T({},f[m]),i.toggleParticipantAudioBasedOnNativeAudioFocus();o&&i.loadCss(i.properties),u(f)}else d(p)}})});return function(){return r.apply(this,arguments)}}()},{key:"leave",value:function(){var r=h(function*(){var i=this;return new Promise(function(a,o){if(i._callObjectLoader&&!i._callObjectLoader.loaded){i._callObjectLoader.cancel(),i.updateMeetingState($),i.resetMeetingDependentVars();try{i.emit($,{action:$})}catch(s){console.log("could not emit 'left-meeting'",s)}a()}else i._meetingState===$||i._meetingState===Q?a():(i._leftCallback=function(){i._meetingState!==Q&&i.updateMeetingState($),i.resetMeetingDependentVars(),a()},i.sendMessageToCallMachine({action:"leave-meeting"}))})});return function(){return r.apply(this,arguments)}}()},{key:"startScreenShare",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g(),r.mediaStream&&(this._preloadCache.screenMediaStream=r.mediaStream,r.mediaStream=Ie),this.sendMessageToCallMachine({action:"local-screen-start",captureOptions:r})}},{key:"stopScreenShare",value:function(){g(),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(T({action:"local-recording-start"},r))}},{key:"updateRecording",value:function(r){var i=r.layout,a=i===void 0?{preset:"default"}:i;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:a})}},{key:"stopRecording",value:function(){this.sendMessageToCallMachine({action:"local-recording-stop"})}},{key:"startLiveStreaming",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(T({action:"daily-method-start-live-streaming"},r))}},{key:"updateLiveStreaming",value:function(r){var i=r.layout,a=i===void 0?{preset:"default"}:i;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:a})}},{key:"addLiveStreamingEndpoints",value:function(r){var i=r.endpoints;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming-endpoints",endpointsOp:Kn,endpoints:i})}},{key:"removeLiveStreamingEndpoints",value:function(r){var i=r.endpoints;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming-endpoints",endpointsOp:$n,endpoints:i})}},{key:"stopLiveStreaming",value:function(){this.sendMessageToCallMachine({action:"daily-method-stop-live-streaming"})}},{key:"startRemoteMediaPlayer",value:function(){var r=h(function*(i){var a=this,o=i.url,s=i.settings,c=s===void 0?{state:ot.PLAY}:s;try{(function(u){if(typeof u!="string")throw new Error('url parameter must be "string" type')})(o),mn(c),function(u){for(var d in u)if(!ln.includes(d))throw new Error("Invalid key ".concat(d,", valid keys are: ").concat(ln));if(u.simulcastEncodings){if(!(u.simulcastEncodings instanceof Array))throw new Error('simulcastEncodings must be "Array"');if(!gn(u.simulcastEncodings.length,0,Xo))throw new Error('"simulcastEncodings" not in range. valid range 1 to 3 layers');u.simulcastEncodings.every(function(f){for(var p in f){if(!Tt.hasOwnProperty(p))throw new Error("Invalid key ".concat(p,", valid keys are:")+Object.keys(Tt));if(typeof f[p]!="number")throw new Error("simulcastEncodings[].".concat(p,' must be "number"'));var m=Tt[p],k=m.min,C=m.max;if(!gn(f[p],k,C))throw new Error("simulcastEncodings[].".concat(p," value not in range. valid range:        ").concat(k," to ").concat(C))}if(!f.hasOwnProperty("maxBitrate"))throw new Error("simulcastEncodings[].maxBitrate is not specified")})}}(c)}catch(u){throw console.error("invalid argument Error: ".concat(u)),console.error(`startRemoteMediaPlayer arguments must be of the form: 
  { url: "playback url", 
  settings?: 
  {state: "play"|"pause", simulcastEncodings?: [{}] } }`),u}return new Promise(function(){var u=h(function*(d,f){a.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:o,settings:c},function(p){p.error?f({error:p.error,errorMsg:p.errorMsg}):d({session_id:p.session_id,remoteMediaPlayerState:{state:p.state,settings:p.settings}})})});return function(d,f){return u.apply(this,arguments)}}())});return function(i){return r.apply(this,arguments)}}()},{key:"stopRemoteMediaPlayer",value:function(){var r=h(function*(i){var a=this;if(typeof i!="string")throw new Error(" remotePlayerID must be of type string");return new Promise(function(){var o=h(function*(s,c){a.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:i},function(u){u.error?c({error:u.error,errorMsg:u.errorMsg}):s()})});return function(s,c){return o.apply(this,arguments)}}())});return function(i){return r.apply(this,arguments)}}()},{key:"updateRemoteMediaPlayer",value:function(){var r=h(function*(i){var a=this,o=i.session_id,s=i.settings;try{mn(s)}catch(c){throw console.error("invalid argument Error: ".concat(c)),console.error(`updateRemoteMediaPlayer arguments must be of the form: 
  session_id: "participant session", 
  { settings?: {state: "play"|"pause"} }`),c}return new Promise(function(){var c=h(function*(u,d){a.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:o,settings:s},function(f){f.error?d({error:f.error,errorMsg:f.errorMsg}):u({session_id:f.session_id,remoteMediaPlayerState:{state:f.state,settings:f.settings}})})});return function(u,d){return c.apply(this,arguments)}}())});return function(i){return r.apply(this,arguments)}}()},{key:"startTranscription",value:function(r){this.sendMessageToCallMachine(T({action:"daily-method-start-transcription"},r))}},{key:"stopTranscription",value:function(){this.sendMessageToCallMachine({action:"daily-method-stop-transcription"})}},{key:"getNetworkStats",value:function(){var r=this;return this._meetingState!==j?{stats:{latest:{}}}:new Promise(function(i,a){r.sendMessageToCallMachine({action:"get-calc-stats"},function(o){i(T({stats:o.stats},r._network))})})}},{key:"getActiveSpeaker",value:function(){return g(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(r){return g(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:r}),this}},{key:"activeSpeakerMode",value:function(){return g(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(r){if(this._meetingState!==j)throw new Error("setSubscribeToTracksAutomatically() is only allowed when joined");return this._preloadCache.subscribeToTracksAutomatically=r,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:r}),this}},{key:"enumerateDevices",value:function(){var r=h(function*(){var i=this;return this._callObjectMode?{devices:(yield navigator.mediaDevices.enumerateDevices()).map(function(a){return JSON.parse(JSON.stringify(a))})}:new Promise(function(a,o){i.sendMessageToCallMachine({action:"enumerate-devices"},function(s){a({devices:s.devices})})})});return function(){return r.apply(this,arguments)}}()},{key:"sendAppMessage",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"*";if(JSON.stringify(r).length>4096)throw new Error("Message data too large. Max size is 4096");return this.sendMessageToCallMachine({action:"app-msg",data:r,to:i}),this}},{key:"addFakeParticipant",value:function(r){return g(),this.sendMessageToCallMachine(T({action:"add-fake-participant"},r)),this}},{key:"setShowNamesMode",value:function(r){return g(),r&&r!=="always"&&r!=="never"?(console.error('setShowNamesMode argument should be "always", "never", or false'),this):(this.sendMessageToCallMachine({action:"set-show-names",mode:r}),this)}},{key:"setShowLocalVideo",value:function(){var r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return g(),typeof r!="boolean"?(console.error("setShowLocalVideo only accepts a boolean value"),this):this._callObjectMode?(console.error("setShowLocalVideo is not available in callObject mode"),this):this._meetingState!==j?(console.error("the meeting must be joined before calling setShowLocalVideo"),this):(this.sendMessageToCallMachine({action:"set-show-local-video",show:r}),this._showLocalVideo=r,this)}},{key:"showLocalVideo",value:function(){return g(),this._callObjectMode?(console.error("showLocalVideo is not available in callObject mode"),this):this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return g(),typeof r!="boolean"?(console.error("setShowParticipantsBar only accepts a boolean value"),this):this._callObjectMode?(console.error("setShowParticipantsBar is not available in callObject mode"),this):this._meetingState!==j?(console.error("the meeting must be joined before calling setShowParticipantsBar"),this):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:r}),this._showParticipantsBar=r,this)}},{key:"showParticipantsBar",value:function(){return g(),this._callObjectMode?(console.error("showParticipantsBar is not available in callObject mode"),this):this._showParticipantsBar}},{key:"customTrayButtons",value:function(){return g(),this._callObjectMode?(console.error("customTrayButtons is not available in callObject mode"),this):this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(r){return g(),this._callObjectMode?(console.error("updateCustomTrayButtons is not available in callObject mode"),this):this._meetingState!==j?(console.error("the meeting must be joined before calling updateCustomTrayButtons"),this):vn(r)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:r}),this._customTrayButtons=r,this):(console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(Ke))),this)}},{key:"theme",value:function(){return this._callObjectMode?(console.error("theme is not available in callObject mode"),this):this.properties.theme}},{key:"setTheme",value:function(r){var i=this;return new Promise(function(a,o){if(i._callObjectMode)o("setTheme is not available in callObject mode");else try{i.validateProperties({theme:r}),i.properties.theme=T({},r),i.sendMessageToCallMachine({action:"set-theme",theme:i.properties.theme});try{i.emit("theme-updated",{action:"theme-updated",theme:i.properties.theme})}catch(s){console.log("could not emit 'theme-updated'",s)}a(i.properties.theme)}catch(s){o(s)}})}},{key:"detectAllFaces",value:function(){var r=this;return g(),new Promise(function(i,a){r.sendMessageToCallMachine({action:"detect-all-faces"},function(o){delete o.action,delete o.callbackStamp,i(o)})})}},{key:"requestFullscreen",value:function(){var r=h(function*(){if(g(),this._iframe&&!document.fullscreenElement&&ur())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(i){console.log("could not make video call fullscreen",i)}});return function(){return r.apply(this,arguments)}}()},{key:"exitFullscreen",value:function(){g(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"room",value:function(){var r=h(function*(){var i=this,a=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).includeRoomConfigDefaults,o=a===void 0||a;return this._accessState.access===at||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise(function(s,c){i.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:o},function(u){delete u.action,delete u.callbackStamp,s(u)})})});return function(){return r.apply(this,arguments)}}()},{key:"geo",value:function(){var r=h(function*(){return new Promise(function(){var i=h(function*(a,o){try{var s=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");a({current:(yield s.json()).geo})}catch(c){console.error("geo lookup failed",c),a({current:""})}});return function(a,o){return i.apply(this,arguments)}}())});return function(){return r.apply(this,arguments)}}()},{key:"setNetworkTopology",value:function(){var r=h(function*(i){var a=this;return g(),new Promise(function(){var o=h(function*(s,c){a.sendMessageToCallMachine({action:"set-network-topology",opts:i},function(u){u.error?c({error:u.error}):s({workerId:u.workerId})})});return function(s,c){return o.apply(this,arguments)}}())});return function(i){return r.apply(this,arguments)}}()},{key:"getNetworkTopology",value:function(){var r=h(function*(){var i=this;return new Promise(function(){var a=h(function*(o,s){i.sendMessageToCallMachine({action:"get-network-topology"},function(c){c.error?s({error:c.error}):o({topology:c.topology})})});return function(o,s){return a.apply(this,arguments)}}())});return function(){return r.apply(this,arguments)}}()},{key:"setPlayNewParticipantSound",value:function(r){if(g(),typeof r!="number"&&r!==!0&&r!==!1)throw new Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(r));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:r})}},{key:"on",value:function(r,i){return this._inputEventsOn[r]={},this.sendMessageToCallMachine({action:"register-input-handler",on:r}),M.exports.prototype.on.call(this,r,i)}},{key:"once",value:function(r,i){return this._inputEventsOn[r]={},this.sendMessageToCallMachine({action:"register-input-handler",on:r}),M.exports.prototype.once.call(this,r,i)}},{key:"off",value:function(r,i){return delete this._inputEventsOn[r],this.sendMessageToCallMachine({action:"register-input-handler",off:r}),M.exports.prototype.off.call(this,r,i)}},{key:"validateProperties",value:function(r){for(var i in r){if(!Y[i])throw new Error("unrecognized property '".concat(i,"'"));if(Y[i].validate&&!Y[i].validate(r[i],this))throw new Error("property '".concat(i,"': ").concat(Y[i].help))}}},{key:"assembleMeetingUrl",value:function(){var r=T(T({},this.properties),{},{emb:this._callFrameId,embHref:encodeURIComponent(window.location.href)}),i=r.url.match(/\?/)?"&":"?";return r.url+i+Object.keys(Y).filter(function(a){return Y[a].queryString&&r[a]!==void 0}).map(function(a){return"".concat(Y[a].queryString,"=").concat(r[a])}).join("&")}},{key:"needsLoad",value:function(){return[ar,it,$,Q].includes(this._meetingState)}},{key:"sendMessageToCallMachine",value:function(r,i){this._messageChannel.sendMessageToCallMachine(r,i,this._iframe,this._callFrameId)}},{key:"forwardPackagedMessageToCallMachine",value:function(r){this._messageChannel.forwardPackagedMessageToCallMachine(r,this._iframe,this._callFrameId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(r){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(r,this._callFrameId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(r){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(r)}},{key:"handleMessageFromCallMachine",value:function(r){switch(r.action){case"iframe-ready-for-launch-config":this.sendMessageToCallMachine(T({action:"iframe-launch-config"},this.properties));break;case"loaded":this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null);try{this.emit(r.action,r)}catch(v){console.log("could not emit",r,v)}break;case"joined-meeting":this._joinedCallback&&(this._joinedCallback(r.participants),this._joinedCallback=null);try{this.emit(r.action,r)}catch(v){console.log("could not emit",r,v)}break;case"participant-joined":case"participant-updated":if(this._meetingState===$)return;if(r.participant&&r.participant.session_id){var i=r.participant.local?"local":r.participant.session_id;this._callObjectMode&&(nn(r.participant),an(r.participant),on(r.participant,this._participants[i]));try{this.maybeEventTrackStopped(this._participants[i],r.participant,"audioTrack"),this.maybeEventTrackStopped(this._participants[i],r.participant,"videoTrack"),this.maybeEventTrackStopped(this._participants[i],r.participant,"screenVideoTrack"),this.maybeEventTrackStopped(this._participants[i],r.participant,"screenAudioTrack"),this.maybeEventTrackStarted(this._participants[i],r.participant,"audioTrack"),this.maybeEventTrackStarted(this._participants[i],r.participant,"videoTrack"),this.maybeEventTrackStarted(this._participants[i],r.participant,"screenVideoTrack"),this.maybeEventTrackStarted(this._participants[i],r.participant,"screenAudioTrack"),this.maybeEventTrackStoppedForCustomTracks(this._participants[i],r.participant),this.maybeEventTrackStartedForCustomTracks(this._participants[i],r.participant),this.maybeEventRecordingStopped(this._participants[i],r.participant),this.maybeEventRecordingStarted(this._participants[i],r.participant)}catch(v){console.error("track events error",v)}if(!this.compareEqualForParticipantUpdateEvent(r.participant,this._participants[i])){this._participants[i]=T({},r.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus();try{this.emit(r.action,r)}catch(v){console.log("could not emit",r,v)}}}break;case"participant-left":if(r.participant&&r.participant.session_id){var a=this._participants[r.participant.session_id];a&&(this.maybeEventTrackStopped(a,null,"audioTrack"),this.maybeEventTrackStopped(a,null,"videoTrack"),this.maybeEventTrackStopped(a,null,"screenVideoTrack"),this.maybeEventTrackStopped(a,null,"screenAudioTrack"),this.maybeEventTrackStoppedForCustomTracks(a,null)),delete this._participants[r.participant.session_id];try{this.emit(r.action,r)}catch(v){console.log("could not emit",r,v)}}break;case"participant-counts-updated":if(!ve(this._participantCounts,r.participantCounts)){this._participantCounts=r.participantCounts;try{this.emit(r.action,r)}catch(v){console.log("could not emit",r,v)}}break;case"access-state-updated":var o={access:r.access};if(r.awaitingAccess&&(o.awaitingAccess=r.awaitingAccess),!ve(this._accessState,o)){this._accessState=o;try{this.emit(r.action,r)}catch(v){console.log("could not emit",r,v)}}break;case"meeting-session-updated":if(r.meetingSession)try{delete r.callFrameId,this.emit(r.action,r)}catch(v){console.log("could not emit",r,v)}break;case"error":this._iframe&&!r.preserveIframe&&(this._iframe.src=""),this.updateMeetingState(Q),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(r.errorMsg),this._loadedCallback=null),this._joinedCallback&&(this._joinedCallback(null,r.errorMsg),this._joinedCallback=null);try{r.preserveIframe;var s=An(r,["preserveIframe"]);this.emit(r.action,s)}catch(v){console.log("could not emit",r,v)}break;case"left-meeting":this._leftCallback&&(this._leftCallback(),this._leftCallback=null);try{this.emit(r.action,r)}catch(v){console.log("could not emit",r,v)}break;case"input-event":var c=this._participants[r.session_id];c||(c=r.session_id===this._participants.local.session_id?this._participants.local:{});try{this.emit(r.event.type,{action:r.event.type,event:r.event,participant:T({},c)})}catch(v){console.log("could not emit",r,v)}break;case"network-quality-change":var u=r.threshold,d=r.quality;if(u!==this._network.threshold||d!==this._network.quality){this._network.quality=d,this._network.threshold=u;try{this.emit(r.action,r)}catch(v){console.log("could not emit",r,v)}}break;case"active-speaker-change":var f=r.activeSpeaker;if(this._activeSpeaker.peerId!==f.peerId){this._activeSpeaker.peerId=f.peerId;try{this.emit(r.action,{action:r.action,activeSpeaker:this._activeSpeaker})}catch(v){console.log("could not emit",r,v)}}break;case"show-local-video-changed":if(this._callObjectMode)return;var p=r.show;this._showLocalVideo=p;try{this.emit(r.action,{action:r.action,show:p})}catch(v){console.log("could not emit",r,v)}break;case"active-speaker-mode-change":var m=r.enabled;if(this._activeSpeakerMode!==m){this._activeSpeakerMode=m;try{this.emit(r.action,{action:r.action,enabled:this._activeSpeakerMode})}catch(v){console.log("could not emit",r,v)}}break;case"waiting-participant-added":case"waiting-participant-updated":case"waiting-participant-removed":this._waitingParticipants=r.allWaitingParticipants;try{this.emit(r.action,{action:r.action,participant:r.participant})}catch(v){console.log("could not emit",r,v)}break;case"receive-settings-updated":if(!ve(this._receiveSettings,r.receiveSettings)){this._receiveSettings=r.receiveSettings;try{this.emit(r.action,{action:r.action,receiveSettings:r.receiveSettings})}catch(v){console.log("could not emit",r,v)}}break;case"input-settings-updated":if(!ve(this._inputSettings,r.inputSettings)){this._inputSettings=r.inputSettings;try{this.emit(r.action,{action:r.action,inputSettings:r.inputSettings})}catch(v){console.log("could not emit",r,v)}}break;case"remote-media-player-started":var k=r.session_id;this._rmpPlayerState[k]=r.playerState,this.emitDailyJSEvent(r);break;case"remote-media-player-stopped":delete this._rmpPlayerState[r.session_id],this.emitDailyJSEvent(r);break;case"remote-media-player-updated":var C=r.session_id,E=this._rmpPlayerState[C];E&&this.compareEqualForRMPUpdateEvent(E,r.remoteMediaPlayerState)||(this._rmpPlayerState[C]=r.remoteMediaPlayerState,this.emitDailyJSEvent(r));break;case"custom-button-click":this.emitDailyJSEvent(r);break;case"recording-started":case"recording-stopped":case"recording-stats":case"recording-error":case"recording-upload-completed":case"transcription-started":case"transcription-stopped":case"transcription-error":case"started-camera":case"camera-error":case"app-message":case"local-screen-share-started":case"local-screen-share-stopped":case"network-connection":case"recording-data":case"live-streaming-started":case"live-streaming-stopped":case"live-streaming-error":case"nonfatal-error":case"lang-updated":try{this.emit(r.action,r)}catch(v){console.log("could not emit",r,v)}break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(r,i){var a="record";if(r&&!i.local&&i[a]===!1&&r[a]!==i[a])try{this.emit("recording-stopped",{action:"recording-stopped"})}catch(o){console.log("could not emit",o)}}},{key:"maybeEventRecordingStarted",value:function(r,i){var a="record";if(r&&!i.local&&i[a]===!0&&r[a]!==i[a])try{this.emit("recording-started",{action:"recording-started"})}catch(o){console.log("could not emit",o)}}},{key:"maybeEventTrackStopped",value:function(r,i,a){if(r&&(r[a]&&r[a].readyState==="ended"||r[a]&&(!i||!i[a])||r[a]&&r[a].id!==i[a].id))try{this.emit("track-stopped",{action:"track-stopped",track:r[a],participant:i})}catch(o){console.log("could not emit",o)}}},{key:"maybeEventCustomTrackStopped",value:function(r,i,a,o){if(r&&(!o||!o.remoteMediaPlayerState||o.remoteMediaPlayerState.state!=Hn&&o.remoteMediaPlayerState.state!=Gn)&&(r&&r.readyState==="ended"||r&&!i||r&&r.id!==i.id))try{this.emit("track-stopped",{action:"track-stopped",track:r,participant:a})}catch(s){console.log("maybeEventCustomTrackStopped: could not emit",s)}}},{key:"maybeEventCustomTrackStarted",value:function(r,i,a){if(i&&!r||i&&r.readyState==="ended"||i&&i.id!==r.id)try{this.emit("track-started",{action:"track-started",track:i,participant:a})}catch(o){console.log("maybeEventCustomTrackStarted: could not emit",o)}}},{key:"maybeEventTrackStarted",value:function(r,i,a){if(i[a]&&(!r||!r[a])||i[a]&&r[a].readyState==="ended"||i[a]&&i[a].id!==r[a].id)try{this.emit("track-started",{action:"track-started",track:i[a],participant:i})}catch(o){console.log("could not emit",o)}}},{key:"maybeEventTrackStoppedForCustomTracks",value:function(r,i){if(r)for(var a in r.tracks)Ct(a)||this.maybeEventCustomTrackStopped(r.tracks[a].track,i&&i.tracks[a]?i.tracks[a].track:null,r,i)}},{key:"maybeEventTrackStartedForCustomTracks",value:function(r,i){if(i)for(var a in i.tracks)Ct(a)||this.maybeEventCustomTrackStarted(r&&r.tracks[a]?r.tracks[a].track:null,i.tracks[a].track,i)}},{key:"compareEqualForRMPUpdateEvent",value:function(r,i){return r.state===i.state}},{key:"emitDailyJSEvent",value:function(r){try{this.emit(r.action,r)}catch(i){console.log("could not emit",r,i)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(r,i){return!!ve(r,i)&&(!r.videoTrack||!i.videoTrack||r.videoTrack.id===i.videoTrack.id&&r.videoTrack.muted===i.videoTrack.muted&&r.videoTrack.enabled===i.videoTrack.enabled)&&(!r.audioTrack||!i.audioTrack||r.audioTrack.id===i.audioTrack.id&&r.audioTrack.muted===i.audioTrack.muted&&r.audioTrack.enabled===i.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return _()?typeof DailyNativeUtils>"u"?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(r){this.updateMeetingState(this._meetingState,r)}},{key:"updateMeetingState",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._isPreparingToJoin;if(r!==this._meetingState||i!==this._isPreparingToJoin){var a=this._meetingState,o=this._isPreparingToJoin;this._meetingState=r,this._isPreparingToJoin=i;var s=this.isMeetingPendingOrOngoing(a,o),c=this.isMeetingPendingOrOngoing(this._meetingState,this._isPreparingToJoin);s!==c&&(this.updateKeepDeviceAwake(c),this.updateDeviceAudioMode(c),this.updateShowAndroidOngoingMeetingNotification(c),this.updateNoOpRecordingEnsuringBackgroundContinuity(c))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=un,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:at},this._receiveSettings={},this._inputSettings={},this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(r){_()&&this.nativeUtils().setKeepDeviceAwake(r,this._callFrameId)}},{key:"updateDeviceAudioMode",value:function(r){if(_()&&!this.disableReactNativeAutoDeviceManagement("audio")){var i=r?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(i)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(r){if(_()&&this.nativeUtils().setShowOngoingMeetingNotification){var i,a,o,s;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var c=this.properties.reactNativeConfig.androidInCallNotification;i=c.title,a=c.subtitle,o=c.iconName,s=c.disableForCustomOverride}s&&(r=!1),this.nativeUtils().setShowOngoingMeetingNotification(r,i,a,o,this._callFrameId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(r){_()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(r)}},{key:"isMeetingPendingOrOngoing",value:function(r,i){return[me,j].includes(r)||i}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){if(_()){var r=store.getState();for(var i in r.streams){var a=r.streams[i];a&&a.pendingTrack&&a.pendingTrack.kind==="audio"&&(a.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(r){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[r]}},{key:"absoluteUrl",value:function(r){if(r!==void 0){var i=document.createElement("a");return i.href=r,i.href}}},{key:"sayHello",value:function(){var r="hello, world.";return console.log(r),r}}]),n}();let Qe={},fe=[];const es="update-call-state",z={onCallStateUpdate:function(e,t){fe[e]||(fe[e]=[]),fe[e].push(t)},updateCallState:function(e,t,n=!0,r=r){console.log("i got a updatecallstate",t,r),ts(e,t),n&&rs(e,t,r)},state:Qe};function ts(e="",t){Qe[e]||(Qe[e]={}),Object.assign(Qe[e],t),fe[e]||(fe[e]=[]);const n=fe[e];for(let r=0;r<n.length;r++)n[r](t)}function rs(e,t,n){const r={};r[e]=t,n.sendAppMessage({message:es,state:r})}let ee,x,te,pe,Ze,jt=!1,Pt=!1,yn;function ns(e){Ze=e}const Ce={afterCreateFrame:ns,create:function({leftNode:e,rightNode:t,button:n}){x=document.createElement("div"),te=document.createElement("div");const r=document.createElement("style");return r.innerHTML=`body {
        margin: 0px;
        padding: 0px;
      }
      #flexpanel {
        display: flex;
        border: 0px;
        position: absolute;
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
      }
      .leftContainer {
        flex: 0;
        display: none;
      }
      .leftContainer.flexpanelOpen {
        display: flex;
        flex: 80 80 auto;
      }
      .rightContainer {
        flex: 100;
      }
      .rightContainer.flexpanelOpen {
        flex: 20 20 auto;
      }

      #grabber {
        width: 20px;
        padding: 0;
        cursor: ew-resize;
        flex: 0 0 auto;
        display: none;
      }
      #grabber.flexpanelOpen {
        display: flex;
        width: 10px;
      }

      #grabber.flexpanelOpen::before {
        content: "";
        display: block;
        width: 4px;
        height: 40px;
        background: #afafaf;
        border-radius: 2px;
        margin: auto;
      }`,document.head.appendChild(r),ee=document.createElement("div"),ee.setAttribute("id","flexpanel"),ee.appendChild(x),pe=document.createElement("div"),pe.setAttribute("id","grabber"),x.classList.add("leftContainer"),te.classList.add("rightContainer"),t.parentNode.insertBefore(ee,t),ee.appendChild(x),ee.appendChild(pe),ee.appendChild(te),x.appendChild(e),te.appendChild(t),document.addEventListener("mousedown",function(i){if(i.target===pe){const a=document.querySelector("iframe.rightContainer, .rightContainer iframe"),o=document.querySelector("iframe.leftContainer, .leftContainer iframe");jt=!0,o&&(o.style.pointerEvents="none"),a&&(a.style.pointerEvents="none")}}),document.addEventListener("mousemove",function(i){if(!jt)return!1;const a=x.offsetLeft,o=i.clientX-a,s=60;x.style.width=Math.max(s,o-8)+"px",x.style.flexGrow=0}),document.addEventListener("mouseup",function(i){jt=!1;const a=document.querySelector("iframe.rightContainer, .rightContainer iframe"),o=document.querySelector("iframe.leftContainer, .leftContainer iframe");o&&(o.style.pointerEvents="auto"),a&&(a.style.pointerEvents="auto")}),{left:x,right:te}},open:function(){te.classList.add("flexpanelOpen"),x.classList.add("flexpanelOpen"),pe.classList.add("flexpanelOpen"),yn=Ze.activeSpeakerMode(),Ze.setActiveSpeakerMode(!1),Pt=!0},close:function(){te.classList.remove("flexpanelOpen"),x.classList.remove("flexpanelOpen"),pe.classList.remove("flexpanelOpen"),Ze.setActiveSpeakerMode(yn),Pt=!1},toggle:function(){Pt===!0?this.close():this.open()}};let Te,Oe,G,V=!1;const I={url:"about:blank",buttons:{selectUrl:{iconPath:"https://www.svgrepo.com/show/107601/globe.svg",label:"Iframe",tooltip:"Open Iframe"}},showUrl:!1};let Et;const is=Et={beforeCreateFrame:as,afterCreateFrame:os,configure:function(e){Object.assign(I,e)},open:function(e){I.url=e,V=!0,z.updateCallState("iframe",{url:e,open:V},!0,G)},close:function(){I.url="about:blank",V=!1,z.updateCallState("iframe",{url:I.url,open:V},!0,G)},show:function(){V=!0,z.updateCallState("iframe",{open:V},!0,G)},hide:function(){V=!1,z.updateCallState("iframe",{open:V},!0,G)},setUrl:function(e){I.url=e,z.updateCallState("iframe",{url:I.url},!0,G)}};function as(e,t){t.customTrayButtons||(t.customTrayButtons={}),Object.assign(t.customTrayButtons,I.buttons);let n=document.createElement("div");return n.style=`
  position: relative;
  width: 100%;
  height: 100%;
  `,Oe=document.createElement("div"),Oe.style=`
  padding: 4px;
  `,Oe.innerHTML="Location goes here",Te=document.createElement("iframe"),Te.style=`
  border: 0px;
  position: relative;
  width: 100%;
  height: 100%;
  `,I.showUrl===!0&&n.appendChild(Oe),n.appendChild(Te),Te.src=I.url,Ce.create({leftNode:n,rightNode:e}),[e,t]}async function os(e){G=e,z.onCallStateUpdate("iframe",t=>{"url"in t&&us(t.url),"open"in t&&(t.open===!0?ls():ds())}),G.on("custom-button-click",t=>{switch(t.button_id){case"selectUrl":ss();break;case"close":Et.close();break}}),Ce.afterCreateFrame(e)}function ss(){var e;((e=z.state.iframe)==null?void 0:e.open)===!0?z.updateCallState("iframe",{open:!1},!0,G):cs()}function cs(){let e=prompt("Enter a URL",I.url);e&&Et.open(e)}function us(e){I.url=e,Oe.innerHTML=e,Te.src=e}function ls(){Ce.open(),V=!0}function ds(){Ce.close(),V=!1}class fs{constructor({hostname:t="",key:n=""}={}){At(this,je);At(this,Xe);this.hostname=t,this.key=n.replace(/^\/+/,""),this.updateHandlers=[],this.state={}}connect(){this.socket=A.io(this.hostname+"/"+this.key),this.socket.on("state",t=>{et(this,je,Lt).call(this,t)})}onStateUpdate(t){this.updateHandlers.push(t)}updateState(t,n=!0){et(this,je,Lt).call(this,t),n&&et(this,Xe,bn).call(this,t)}state(){return this.state}}je=new WeakSet,Lt=function(t){Object.assign(this.state,t);for(var n=0;n<this.updateHandlers.length;n++)this.updateHandlers[n](t)},Xe=new WeakSet,bn=function(t){this.socket.emit("update",t)};function ps(e,t){var a;const{dailyConfig:n={}}=t,r=Array.isArray(n.extensions)?n.extensions:[];(a=t.dailyConfig)==null||delete a.extensions,console.log("extensions: ",r),r.forEach(o=>{const s="extension"in o?o.extension:o;"config"in o&&s.configure&&s.configure(o.config),s.beforeCreateFrame&&([e,t]=s.beforeCreateFrame(e,t))});const i=Yo.createFrame(e,t);return r.forEach(o=>{const s="extension"in o?o.extension:o;s.afterCreateFrame&&s.afterCreateFrame(i)}),i}return{createFrame:ps,callstate:z,flexpanel:Ce,iframe:is,socketiostate:fs}});
